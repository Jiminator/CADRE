job is starting on gpua061.delta.ncsa.illinois.edu
alpha = 0.0
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.0, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:48.0, f1:35.7, auc:49.1 | trn acc:47.3, f1:33.5, auc:47.7 | loss:3.655
Epoch 0 finished in 4.87 seconds
[1,348] | tst acc:58.6, f1:37.7, auc:57.4 | trn acc:53.8, f1:39.2, auc:52.6 | loss:1.975
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:67.5, f1:37.6, auc:60.1 | trn acc:62.8, f1:37.8, auc:57.5 | loss:0.556
Epoch 3 finished in 4.17 seconds
[4,368] | tst acc:63.7, f1:31.3, auc:58.2 | trn acc:65.4, f1:35.8, auc:58.0 | loss:0.091
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:69.4, f1:38.5, auc:63.8 | trn acc:66.1, f1:35.2, auc:59.6 | loss:0.079
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:70.1, f1:38.4, auc:63.8 | trn acc:66.7, f1:35.1, auc:60.8 | loss:0.072
Epoch 7 finished in 4.17 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:68.2, f1:34.2, auc:63.8 | trn acc:67.1, f1:34.2, auc:61.1 | loss:0.066
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:70.3, f1:37.5, auc:66.1 | trn acc:67.6, f1:33.1, auc:61.5 | loss:0.060
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.94 seconds
[12,80] | tst acc:72.2, f1:36.1, auc:65.5 | trn acc:68.1, f1:32.0, auc:62.2 | loss:0.053
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:71.3, f1:31.5, auc:61.7 | trn acc:68.6, f1:30.6, auc:62.3 | loss:0.047
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:71.5, f1:32.3, auc:66.9 | trn acc:68.8, f1:28.8, auc:62.7 | loss:0.041
Epoch 15 finished in 4.15 seconds
[16,448] | tst acc:70.9, f1:28.3, auc:62.4 | trn acc:69.1, f1:27.0, auc:62.9 | loss:0.035
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.94 seconds
[18,120] | tst acc:70.7, f1:18.8, auc:63.1 | trn acc:69.4, f1:24.8, auc:63.0 | loss:0.030
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:71.1, f1:24.4, auc:66.8 | trn acc:69.2, f1:22.6, auc:63.1 | loss:0.025
Epoch 19 finished in 4.15 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:71.1, f1:19.0, auc:62.7 | trn acc:69.6, f1:20.1, auc:63.0 | loss:0.021
Epoch 21 finished in 4.15 seconds
[22,488] | tst acc:69.2, f1:16.2, auc:62.9 | trn acc:69.5, f1:17.8, auc:62.5 | loss:0.017
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.94 seconds
[24,160] | tst acc:72.2, f1:14.4, auc:63.8 | trn acc:69.1, f1:15.4, auc:62.6 | loss:0.014
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:70.7, f1:11.5, auc:63.7 | trn acc:69.4, f1:13.1, auc:62.1 | loss:0.011
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:70.5, f1:11.5, auc:62.8 | trn acc:69.1, f1:10.9, auc:61.8 | loss:0.009
Epoch 27 finished in 4.15 seconds
[28,528] | tst acc:71.1, f1:9.3, auc:60.2 | trn acc:68.9, f1:9.2, auc:61.2 | loss:0.007
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.94 seconds
[30,200] | tst acc:71.3, f1:9.4, auc:61.2 | trn acc:68.7, f1:7.6, auc:60.8 | loss:0.006
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:70.3, f1:5.4, auc:63.5 | trn acc:68.9, f1:6.4, auc:60.7 | loss:0.005
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:71.5, f1:10.7, auc:60.5 | trn acc:68.4, f1:5.2, auc:60.4 | loss:0.004
Epoch 33 finished in 4.15 seconds
[34,568] | tst acc:70.3, f1:2.8, auc:60.3 | trn acc:69.0, f1:4.6, auc:60.2 | loss:0.003
Epoch 34 finished in 4.19 seconds
Epoch 35 finished in 3.94 seconds
[36,240] | tst acc:70.5, f1:1.4, auc:61.9 | trn acc:68.9, f1:3.8, auc:60.2 | loss:0.003
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:70.7, f1:2.8, auc:60.8 | trn acc:68.3, f1:3.2, auc:60.0 | loss:0.002
Epoch 37 finished in 4.15 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:70.3, f1:1.4, auc:57.9 | trn acc:68.5, f1:2.6, auc:59.7 | loss:0.002
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:69.9, f1:0.0, auc:63.1 | trn acc:68.7, f1:2.5, auc:59.9 | loss:0.002
Epoch 40 finished in 4.19 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:70.3, f1:1.4, auc:63.7 | trn acc:68.4, f1:2.1, auc:59.9 | loss:0.002
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:70.9, f1:4.2, auc:57.6 | trn acc:68.5, f1:1.8, auc:60.1 | loss:0.002
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:70.7, f1:2.8, auc:60.2 | trn acc:68.9, f1:1.4, auc:60.1 | loss:0.002
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:70.5, f1:1.4, auc:59.3 | trn acc:68.1, f1:1.2, auc:60.2 | loss:0.002
Epoch 46 finished in 4.19 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:70.5, f1:1.4, auc:60.0 | trn acc:68.6, f1:1.0, auc:60.2 | loss:0.002
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:70.3, f1:1.4, auc:57.5 | trn acc:68.3, f1:0.9, auc:60.2 | loss:0.002
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:70.5, f1:1.4, auc:56.0 | trn acc:68.5, f1:0.8, auc:60.5 | loss:0.001
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:70.3, f1:1.4, auc:58.9 | trn acc:68.5, f1:0.6, auc:60.8 | loss:0.001
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:70.3, f1:0.0, auc:59.5 | trn acc:68.6, f1:0.5, auc:61.0 | loss:0.001
Epoch 54 finished in 4.19 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:70.3, f1:0.0, auc:62.0 | trn acc:68.3, f1:0.3, auc:61.1 | loss:0.001
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:70.3, f1:0.0, auc:61.3 | trn acc:68.4, f1:0.4, auc:61.5 | loss:0.001
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:70.5, f1:1.4, auc:61.8 | trn acc:68.6, f1:0.3, auc:61.6 | loss:0.001
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:70.3, f1:0.0, auc:63.8 | trn acc:68.1, f1:0.2, auc:61.7 | loss:0.001
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:70.3, f1:0.0, auc:62.0 | trn acc:68.5, f1:0.2, auc:61.8 | loss:0.001
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:70.3, f1:0.0, auc:58.6 | trn acc:68.7, f1:0.1, auc:62.0 | loss:0.001
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:70.3, f1:0.0, auc:62.0 | trn acc:68.2, f1:0.2, auc:62.1 | loss:0.001
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:70.3, f1:0.0, auc:62.4 | trn acc:68.5, f1:0.2, auc:62.1 | loss:0.001
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:70.3, f1:0.0, auc:63.5 | trn acc:68.3, f1:0.1, auc:62.2 | loss:0.001
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:70.3, f1:0.0, auc:65.8 | trn acc:68.3, f1:0.1, auc:62.4 | loss:0.001
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:70.3, f1:0.0, auc:64.3 | trn acc:68.5, f1:0.1, auc:62.3 | loss:0.001
Average epoch runtime: 4.06 seconds
Total training time: 292.22 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.0, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.8, f1:46.0, auc:51.3 | trn acc:47.8, f1:39.5, auc:49.0 | loss:3.302
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:53.7, f1:41.1, auc:53.9 | trn acc:53.7, f1:39.0, auc:52.5 | loss:1.993
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:59.6, f1:35.0, auc:55.7 | trn acc:62.8, f1:37.3, auc:57.4 | loss:0.588
Epoch 3 finished in 4.17 seconds
[4,368] | tst acc:59.6, f1:35.8, auc:60.6 | trn acc:65.4, f1:35.2, auc:58.1 | loss:0.087
Epoch 4 finished in 4.23 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:61.1, f1:35.8, auc:63.9 | trn acc:66.3, f1:34.4, auc:59.5 | loss:0.077
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:56.8, f1:26.3, auc:56.8 | trn acc:66.8, f1:34.3, auc:60.7 | loss:0.069
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:60.7, f1:35.6, auc:60.5 | trn acc:67.2, f1:33.5, auc:61.2 | loss:0.065
Epoch 9 finished in 4.18 seconds
[10,408] | tst acc:61.8, f1:31.4, auc:61.1 | trn acc:67.9, f1:32.4, auc:61.8 | loss:0.058
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:60.7, f1:26.3, auc:63.1 | trn acc:68.6, f1:31.2, auc:62.4 | loss:0.051
Epoch 12 finished in 4.23 seconds
[13,428] | tst acc:62.5, f1:27.2, auc:60.0 | trn acc:68.7, f1:29.6, auc:62.4 | loss:0.046
Epoch 13 finished in 4.17 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:62.1, f1:30.8, auc:61.5 | trn acc:68.7, f1:27.9, auc:62.6 | loss:0.039
Epoch 15 finished in 4.18 seconds
[16,448] | tst acc:61.1, f1:27.5, auc:57.2 | trn acc:69.3, f1:26.3, auc:63.0 | loss:0.034
Epoch 16 finished in 4.22 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:60.4, f1:18.7, auc:59.0 | trn acc:69.7, f1:24.0, auc:63.2 | loss:0.029
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:60.7, f1:20.0, auc:56.2 | trn acc:69.2, f1:21.8, auc:62.8 | loss:0.024
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:61.8, f1:19.3, auc:62.7 | trn acc:69.9, f1:19.6, auc:63.0 | loss:0.020
Epoch 21 finished in 4.17 seconds
[22,488] | tst acc:60.7, f1:13.8, auc:61.3 | trn acc:69.2, f1:17.0, auc:62.5 | loss:0.016
Epoch 22 finished in 4.22 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:59.6, f1:10.9, auc:61.4 | trn acc:69.5, f1:14.9, auc:62.5 | loss:0.013
Epoch 24 finished in 4.22 seconds
[25,508] | tst acc:60.0, f1:12.3, auc:65.6 | trn acc:68.9, f1:12.7, auc:62.1 | loss:0.011
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:58.2, f1:9.2, auc:59.6 | trn acc:69.5, f1:10.8, auc:62.0 | loss:0.009
Epoch 27 finished in 4.18 seconds
[28,528] | tst acc:60.0, f1:10.9, auc:63.6 | trn acc:69.1, f1:9.2, auc:61.2 | loss:0.007
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:59.6, f1:6.5, auc:55.3 | trn acc:69.3, f1:7.4, auc:60.8 | loss:0.006
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:58.6, f1:4.8, auc:58.9 | trn acc:68.5, f1:6.3, auc:60.6 | loss:0.004
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:60.4, f1:9.6, auc:58.9 | trn acc:69.0, f1:5.1, auc:60.4 | loss:0.004
Epoch 33 finished in 4.18 seconds
[34,568] | tst acc:58.2, f1:0.0, auc:56.7 | trn acc:68.4, f1:4.4, auc:60.2 | loss:0.003
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:58.2, f1:1.7, auc:59.0 | trn acc:69.4, f1:3.8, auc:60.0 | loss:0.003
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:58.9, f1:3.3, auc:61.1 | trn acc:68.5, f1:3.2, auc:59.8 | loss:0.002
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:58.9, f1:3.3, auc:60.3 | trn acc:69.0, f1:2.7, auc:59.7 | loss:0.002
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:57.9, f1:0.0, auc:59.6 | trn acc:68.5, f1:2.4, auc:59.4 | loss:0.002
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.96 seconds
[42,280] | tst acc:58.9, f1:3.3, auc:63.7 | trn acc:69.2, f1:2.1, auc:60.0 | loss:0.002
Epoch 42 finished in 4.22 seconds
[43,628] | tst acc:57.9, f1:0.0, auc:54.7 | trn acc:68.0, f1:1.7, auc:59.8 | loss:0.002
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:58.6, f1:1.7, auc:55.0 | trn acc:68.7, f1:1.3, auc:60.0 | loss:0.002
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:58.6, f1:1.7, auc:61.6 | trn acc:68.5, f1:1.1, auc:59.8 | loss:0.002
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:58.6, f1:1.7, auc:59.5 | trn acc:68.5, f1:1.0, auc:59.9 | loss:0.002
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:57.9, f1:0.0, auc:57.4 | trn acc:68.5, f1:0.7, auc:60.2 | loss:0.002
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.00 seconds
[51,340] | tst acc:58.2, f1:0.0, auc:53.9 | trn acc:68.7, f1:0.7, auc:60.6 | loss:0.001
Epoch 51 finished in 4.17 seconds
Epoch 52 finished in 4.00 seconds
[53,12] | tst acc:58.2, f1:0.0, auc:50.0 | trn acc:68.5, f1:0.5, auc:60.6 | loss:0.001
Epoch 53 finished in 4.17 seconds
[54,360] | tst acc:58.2, f1:0.0, auc:57.6 | trn acc:68.5, f1:0.5, auc:60.8 | loss:0.001
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:58.2, f1:0.0, auc:57.5 | trn acc:68.4, f1:0.4, auc:60.9 | loss:0.001
Epoch 56 finished in 4.22 seconds
[57,380] | tst acc:58.2, f1:0.0, auc:59.1 | trn acc:68.5, f1:0.3, auc:61.3 | loss:0.001
Epoch 57 finished in 4.17 seconds
Epoch 58 finished in 4.01 seconds
[59,52] | tst acc:58.2, f1:0.0, auc:63.5 | trn acc:68.6, f1:0.3, auc:61.5 | loss:0.001
Epoch 59 finished in 4.17 seconds
[60,400] | tst acc:58.2, f1:0.0, auc:63.0 | trn acc:68.5, f1:0.2, auc:61.6 | loss:0.001
Epoch 60 finished in 4.22 seconds
Epoch 61 finished in 3.96 seconds
[62,72] | tst acc:58.2, f1:0.0, auc:64.2 | trn acc:68.6, f1:0.2, auc:61.7 | loss:0.001
Epoch 62 finished in 4.22 seconds
[63,420] | tst acc:58.2, f1:0.0, auc:60.6 | trn acc:68.6, f1:0.2, auc:61.7 | loss:0.001
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 4.00 seconds
[65,92] | tst acc:58.2, f1:0.0, auc:60.1 | trn acc:68.6, f1:0.2, auc:62.0 | loss:0.001
Epoch 65 finished in 4.17 seconds
[66,440] | tst acc:58.2, f1:0.0, auc:59.8 | trn acc:68.3, f1:0.2, auc:62.1 | loss:0.001
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.96 seconds
[68,112] | tst acc:58.2, f1:0.0, auc:61.4 | trn acc:68.4, f1:0.1, auc:61.8 | loss:0.001
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:58.2, f1:0.0, auc:61.5 | trn acc:68.9, f1:0.1, auc:62.4 | loss:0.001
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:58.2, f1:0.0, auc:63.2 | trn acc:68.2, f1:0.1, auc:62.2 | loss:0.001
Average epoch runtime: 4.07 seconds
Total training time: 292.82 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.0, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:50.9, f1:38.3, auc:51.3 | trn acc:49.3, f1:48.3, auc:50.3 | loss:2.622
Epoch 0 finished in 4.17 seconds
[1,348] | tst acc:63.1, f1:41.8, auc:58.4 | trn acc:53.6, f1:39.0, auc:52.4 | loss:1.983
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:65.6, f1:31.5, auc:52.8 | trn acc:62.8, f1:36.9, auc:57.3 | loss:0.587
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:73.0, f1:46.5, auc:65.3 | trn acc:65.6, f1:35.4, auc:57.6 | loss:0.088
Epoch 4 finished in 4.23 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:70.2, f1:36.8, auc:63.8 | trn acc:66.2, f1:34.9, auc:59.5 | loss:0.074
Epoch 6 finished in 4.22 seconds
[7,388] | tst acc:68.4, f1:28.7, auc:61.3 | trn acc:66.5, f1:34.4, auc:60.3 | loss:0.069
Epoch 7 finished in 4.17 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:69.2, f1:35.3, auc:62.6 | trn acc:67.5, f1:33.7, auc:60.8 | loss:0.065
Epoch 9 finished in 4.17 seconds
[10,408] | tst acc:70.5, f1:34.1, auc:65.4 | trn acc:67.9, f1:32.7, auc:61.5 | loss:0.058
Epoch 10 finished in 4.23 seconds
Epoch 11 finished in 3.97 seconds
[12,80] | tst acc:72.5, f1:33.3, auc:63.3 | trn acc:68.1, f1:31.5, auc:61.8 | loss:0.051
Epoch 12 finished in 4.22 seconds
[13,428] | tst acc:72.3, f1:33.1, auc:66.8 | trn acc:68.5, f1:29.9, auc:61.9 | loss:0.046
Epoch 13 finished in 4.17 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:73.0, f1:30.3, auc:66.6 | trn acc:69.0, f1:28.5, auc:62.4 | loss:0.040
Epoch 15 finished in 4.17 seconds
[16,448] | tst acc:68.4, f1:19.5, auc:57.2 | trn acc:69.4, f1:26.6, auc:62.5 | loss:0.034
Epoch 16 finished in 4.23 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:73.5, f1:24.6, auc:64.6 | trn acc:69.6, f1:24.4, auc:62.8 | loss:0.029
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:71.8, f1:19.0, auc:61.3 | trn acc:69.2, f1:22.2, auc:62.4 | loss:0.024
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:71.8, f1:15.3, auc:61.0 | trn acc:69.4, f1:19.9, auc:62.4 | loss:0.020
Epoch 21 finished in 4.18 seconds
[22,488] | tst acc:72.0, f1:17.9, auc:58.4 | trn acc:69.5, f1:17.5, auc:62.4 | loss:0.017
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:72.5, f1:10.0, auc:57.7 | trn acc:69.4, f1:15.0, auc:62.0 | loss:0.014
Epoch 24 finished in 4.22 seconds
[25,508] | tst acc:73.8, f1:16.3, auc:60.7 | trn acc:69.2, f1:12.8, auc:61.6 | loss:0.011
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:72.0, f1:8.3, auc:61.0 | trn acc:69.1, f1:10.8, auc:61.6 | loss:0.008
Epoch 27 finished in 4.18 seconds
[28,528] | tst acc:73.3, f1:10.3, auc:64.2 | trn acc:69.2, f1:9.1, auc:60.9 | loss:0.007
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:72.8, f1:10.1, auc:60.0 | trn acc:68.9, f1:7.5, auc:60.6 | loss:0.006
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:72.0, f1:5.2, auc:59.2 | trn acc:68.6, f1:6.4, auc:60.5 | loss:0.005
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:72.3, f1:8.4, auc:58.3 | trn acc:69.0, f1:5.2, auc:60.2 | loss:0.004
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:72.5, f1:3.6, auc:59.4 | trn acc:69.1, f1:4.5, auc:60.0 | loss:0.003
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.97 seconds
[36,240] | tst acc:72.0, f1:1.8, auc:59.8 | trn acc:68.4, f1:3.7, auc:59.9 | loss:0.003
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:72.3, f1:1.8, auc:56.6 | trn acc:68.4, f1:3.2, auc:59.9 | loss:0.002
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:71.2, f1:0.0, auc:55.0 | trn acc:68.9, f1:2.8, auc:59.7 | loss:0.002
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:72.3, f1:1.8, auc:58.9 | trn acc:68.5, f1:2.5, auc:59.7 | loss:0.002
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.96 seconds
[42,280] | tst acc:72.8, f1:5.3, auc:62.8 | trn acc:68.9, f1:2.1, auc:59.9 | loss:0.002
Epoch 42 finished in 4.23 seconds
[43,628] | tst acc:71.8, f1:0.0, auc:56.5 | trn acc:68.6, f1:1.7, auc:59.8 | loss:0.002
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:72.0, f1:1.8, auc:59.9 | trn acc:68.8, f1:1.4, auc:60.1 | loss:0.002
Epoch 45 finished in 4.18 seconds
[46,648] | tst acc:72.0, f1:1.8, auc:57.8 | trn acc:68.3, f1:1.1, auc:59.8 | loss:0.002
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:72.3, f1:1.8, auc:59.3 | trn acc:68.5, f1:1.0, auc:60.0 | loss:0.002
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:71.8, f1:0.0, auc:65.8 | trn acc:68.6, f1:0.8, auc:60.1 | loss:0.002
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.01 seconds
[51,340] | tst acc:72.3, f1:1.8, auc:57.1 | trn acc:68.6, f1:0.7, auc:60.5 | loss:0.001
Epoch 51 finished in 4.17 seconds
Epoch 52 finished in 4.01 seconds
[53,12] | tst acc:72.0, f1:0.0, auc:54.1 | trn acc:68.5, f1:0.5, auc:60.5 | loss:0.001
Epoch 53 finished in 4.17 seconds
[54,360] | tst acc:72.0, f1:0.0, auc:55.1 | trn acc:68.5, f1:0.4, auc:60.7 | loss:0.001
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:72.0, f1:0.0, auc:61.7 | trn acc:68.6, f1:0.4, auc:61.0 | loss:0.001
Epoch 56 finished in 4.22 seconds
[57,380] | tst acc:72.0, f1:0.0, auc:60.5 | trn acc:68.4, f1:0.3, auc:61.1 | loss:0.001
Epoch 57 finished in 4.18 seconds
Epoch 58 finished in 4.01 seconds
[59,52] | tst acc:72.0, f1:0.0, auc:62.0 | trn acc:68.4, f1:0.2, auc:61.3 | loss:0.001
Epoch 59 finished in 4.18 seconds
[60,400] | tst acc:72.0, f1:0.0, auc:57.1 | trn acc:68.7, f1:0.2, auc:61.5 | loss:0.001
Epoch 60 finished in 4.22 seconds
Epoch 61 finished in 3.96 seconds
[62,72] | tst acc:72.0, f1:0.0, auc:60.7 | trn acc:68.3, f1:0.2, auc:61.5 | loss:0.001
Epoch 62 finished in 4.22 seconds
[63,420] | tst acc:72.0, f1:0.0, auc:61.1 | trn acc:68.6, f1:0.1, auc:61.6 | loss:0.001
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 4.01 seconds
[65,92] | tst acc:72.0, f1:0.0, auc:60.1 | trn acc:68.2, f1:0.1, auc:61.9 | loss:0.001
Epoch 65 finished in 4.17 seconds
[66,440] | tst acc:72.0, f1:0.0, auc:59.4 | trn acc:68.5, f1:0.1, auc:62.1 | loss:0.001
Epoch 66 finished in 4.22 seconds
Epoch 67 finished in 3.96 seconds
[68,112] | tst acc:72.0, f1:0.0, auc:59.7 | trn acc:68.4, f1:0.1, auc:62.0 | loss:0.001
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:72.0, f1:0.0, auc:65.4 | trn acc:68.4, f1:0.1, auc:62.1 | loss:0.001
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:72.0, f1:0.0, auc:59.7 | trn acc:68.9, f1:0.1, auc:62.4 | loss:0.001
Average epoch runtime: 4.07 seconds
Total training time: 293.05 GPU seconds
alpha = 0.1
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.1, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.1000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.8, f1:45.2, auc:50.2 | trn acc:49.0, f1:43.8, auc:49.8 | loss:2.866
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:57.1, f1:45.5, auc:56.8 | trn acc:53.3, f1:38.2, auc:52.3 | loss:1.994
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 3.99 seconds
[3,20] | tst acc:61.8, f1:44.6, auc:54.0 | trn acc:62.2, f1:38.8, auc:57.5 | loss:0.646
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:58.8, f1:39.5, auc:56.3 | trn acc:64.7, f1:38.2, auc:59.2 | loss:0.107
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:64.3, f1:46.0, auc:61.3 | trn acc:65.2, f1:38.3, auc:60.7 | loss:0.094
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:64.3, f1:42.6, auc:60.5 | trn acc:66.0, f1:38.1, auc:62.1 | loss:0.088
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:62.8, f1:42.8, auc:59.6 | trn acc:66.7, f1:37.9, auc:62.3 | loss:0.086
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:65.6, f1:46.2, auc:61.4 | trn acc:67.3, f1:37.6, auc:63.2 | loss:0.081
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:66.7, f1:43.5, auc:62.6 | trn acc:67.7, f1:37.7, auc:63.9 | loss:0.077
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:65.4, f1:42.6, auc:63.7 | trn acc:69.0, f1:37.5, auc:64.6 | loss:0.074
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:65.6, f1:43.5, auc:64.4 | trn acc:68.9, f1:36.8, auc:65.5 | loss:0.069
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:61.5, f1:35.3, auc:59.9 | trn acc:69.6, f1:36.1, auc:66.1 | loss:0.066
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:63.7, f1:34.6, auc:61.0 | trn acc:70.2, f1:35.6, auc:66.6 | loss:0.062
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:63.9, f1:34.7, auc:59.7 | trn acc:70.6, f1:35.0, auc:67.2 | loss:0.058
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:64.5, f1:34.1, auc:64.3 | trn acc:71.1, f1:34.3, auc:68.1 | loss:0.054
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:63.0, f1:28.8, auc:63.2 | trn acc:71.3, f1:33.4, auc:68.5 | loss:0.052
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:65.8, f1:35.0, auc:66.3 | trn acc:71.9, f1:32.6, auc:69.5 | loss:0.049
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:66.5, f1:34.9, auc:67.5 | trn acc:71.9, f1:31.9, auc:70.0 | loss:0.047
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:62.8, f1:25.6, auc:66.6 | trn acc:72.2, f1:30.8, auc:70.8 | loss:0.044
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:64.7, f1:29.8, auc:68.7 | trn acc:72.7, f1:30.4, auc:71.2 | loss:0.043
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:63.9, f1:27.5, auc:66.9 | trn acc:71.9, f1:29.3, auc:71.7 | loss:0.042
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:65.2, f1:29.4, auc:70.0 | trn acc:72.8, f1:28.8, auc:72.4 | loss:0.040
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:65.2, f1:28.8, auc:69.8 | trn acc:72.5, f1:28.2, auc:73.0 | loss:0.039
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:62.0, f1:17.6, auc:67.7 | trn acc:72.2, f1:27.3, auc:73.7 | loss:0.038
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:63.2, f1:21.1, auc:71.1 | trn acc:72.9, f1:27.1, auc:74.5 | loss:0.037
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:63.5, f1:24.0, auc:71.5 | trn acc:72.7, f1:26.7, auc:75.1 | loss:0.036
Epoch 37 finished in 4.15 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:63.5, f1:21.2, auc:72.8 | trn acc:72.8, f1:26.5, auc:75.8 | loss:0.035
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:63.9, f1:23.5, auc:73.6 | trn acc:72.7, f1:25.7, auc:76.0 | loss:0.035
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:64.1, f1:25.0, auc:76.0 | trn acc:72.6, f1:25.1, auc:76.6 | loss:0.034
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:62.2, f1:17.7, auc:72.3 | trn acc:72.7, f1:24.5, auc:77.3 | loss:0.034
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:62.4, f1:17.8, auc:74.9 | trn acc:72.6, f1:24.0, auc:77.8 | loss:0.033
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:63.7, f1:22.7, auc:74.5 | trn acc:72.5, f1:24.1, auc:78.3 | loss:0.032
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:63.0, f1:20.3, auc:77.8 | trn acc:72.5, f1:23.5, auc:78.7 | loss:0.032
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:64.5, f1:25.9, auc:78.2 | trn acc:72.5, f1:22.7, auc:79.3 | loss:0.032
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 4.00 seconds
[51,340] | tst acc:61.8, f1:14.4, auc:76.7 | trn acc:72.5, f1:22.3, auc:79.7 | loss:0.031
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:61.1, f1:13.3, auc:77.3 | trn acc:72.3, f1:22.0, auc:79.9 | loss:0.031
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:62.6, f1:17.8, auc:79.3 | trn acc:72.6, f1:21.9, auc:80.4 | loss:0.030
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:62.0, f1:15.2, auc:81.1 | trn acc:72.0, f1:20.8, auc:80.6 | loss:0.030
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:62.8, f1:19.4, auc:82.0 | trn acc:72.0, f1:20.1, auc:80.8 | loss:0.030
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:62.4, f1:17.0, auc:80.5 | trn acc:72.3, f1:19.8, auc:81.4 | loss:0.030
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:62.4, f1:17.8, auc:81.3 | trn acc:72.1, f1:19.7, auc:81.4 | loss:0.030
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:61.8, f1:14.4, auc:80.5 | trn acc:72.2, f1:19.2, auc:81.5 | loss:0.029
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:62.2, f1:16.9, auc:84.3 | trn acc:71.9, f1:19.1, auc:81.8 | loss:0.029
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:61.8, f1:14.4, auc:83.7 | trn acc:72.1, f1:18.9, auc:81.7 | loss:0.029
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:60.9, f1:10.7, auc:85.2 | trn acc:72.0, f1:18.8, auc:81.9 | loss:0.029
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:61.8, f1:14.4, auc:84.0 | trn acc:72.0, f1:18.7, auc:82.0 | loss:0.029
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:62.0, f1:15.2, auc:84.0 | trn acc:71.6, f1:18.4, auc:82.0 | loss:0.029
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:61.8, f1:14.4, auc:84.4 | trn acc:72.3, f1:18.7, auc:82.0 | loss:0.029
Average epoch runtime: 4.05 seconds
Total training time: 291.78 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.1, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.1000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:50.4, f1:31.9, auc:49.0 | trn acc:48.4, f1:47.3, auc:48.5 | loss:2.667
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:56.5, f1:33.2, auc:54.3 | trn acc:53.5, f1:39.0, auc:52.5 | loss:1.991
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:64.0, f1:28.6, auc:53.0 | trn acc:62.0, f1:39.5, auc:57.6 | loss:0.618
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:65.7, f1:34.0, auc:57.0 | trn acc:64.4, f1:38.9, auc:58.4 | loss:0.112
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:66.8, f1:31.0, auc:62.1 | trn acc:65.1, f1:38.7, auc:60.3 | loss:0.096
Epoch 6 finished in 4.20 seconds
[7,388] | tst acc:69.8, f1:35.5, auc:61.1 | trn acc:65.8, f1:39.2, auc:61.7 | loss:0.091
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:66.8, f1:33.3, auc:62.2 | trn acc:66.2, f1:38.6, auc:62.1 | loss:0.087
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:67.9, f1:32.6, auc:63.5 | trn acc:67.1, f1:38.7, auc:63.3 | loss:0.083
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:73.1, f1:32.2, auc:61.1 | trn acc:67.7, f1:38.2, auc:63.7 | loss:0.079
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:74.0, f1:41.2, auc:66.7 | trn acc:68.4, f1:37.9, auc:64.7 | loss:0.075
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 4.00 seconds
[15,100] | tst acc:72.9, f1:35.5, auc:69.9 | trn acc:68.6, f1:37.3, auc:65.1 | loss:0.071
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:72.9, f1:32.9, auc:61.9 | trn acc:69.6, f1:37.0, auc:66.0 | loss:0.067
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:74.5, f1:34.3, auc:66.3 | trn acc:69.9, f1:36.3, auc:66.5 | loss:0.062
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:72.3, f1:27.5, auc:61.5 | trn acc:70.3, f1:35.6, auc:67.0 | loss:0.059
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 4.00 seconds
[21,140] | tst acc:74.5, f1:31.3, auc:69.3 | trn acc:70.9, f1:35.2, auc:68.2 | loss:0.055
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:74.8, f1:29.5, auc:67.9 | trn acc:71.2, f1:34.0, auc:68.5 | loss:0.053
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:75.6, f1:31.2, auc:66.2 | trn acc:71.5, f1:33.5, auc:69.5 | loss:0.050
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:76.7, f1:34.4, auc:71.9 | trn acc:71.7, f1:32.6, auc:70.0 | loss:0.047
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:77.0, f1:31.4, auc:69.1 | trn acc:71.8, f1:31.7, auc:70.9 | loss:0.045
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:79.5, f1:40.3, auc:74.5 | trn acc:72.3, f1:31.2, auc:71.6 | loss:0.043
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:75.1, f1:19.6, auc:67.4 | trn acc:72.1, f1:30.1, auc:72.0 | loss:0.042
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:75.1, f1:22.4, auc:74.3 | trn acc:72.3, f1:29.6, auc:72.8 | loss:0.041
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:77.6, f1:29.6, auc:74.0 | trn acc:72.4, f1:29.1, auc:73.3 | loss:0.039
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:75.6, f1:8.3, auc:72.2 | trn acc:72.7, f1:28.6, auc:74.2 | loss:0.038
Epoch 34 finished in 4.21 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:77.6, f1:21.4, auc:76.3 | trn acc:72.8, f1:28.1, auc:74.5 | loss:0.037
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:76.5, f1:24.8, auc:71.3 | trn acc:72.3, f1:27.3, auc:75.2 | loss:0.037
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:77.8, f1:23.1, auc:73.7 | trn acc:72.9, f1:27.0, auc:76.0 | loss:0.035
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:76.5, f1:19.0, auc:73.6 | trn acc:72.1, f1:26.2, auc:76.1 | loss:0.035
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:77.0, f1:22.4, auc:77.2 | trn acc:72.5, f1:26.0, auc:77.0 | loss:0.034
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:77.3, f1:21.2, auc:75.0 | trn acc:72.2, f1:25.2, auc:77.4 | loss:0.034
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:78.9, f1:24.0, auc:74.4 | trn acc:72.4, f1:24.9, auc:78.0 | loss:0.033
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:77.3, f1:19.6, auc:79.0 | trn acc:72.4, f1:24.9, auc:78.4 | loss:0.033
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:77.6, f1:21.4, auc:77.0 | trn acc:72.6, f1:24.5, auc:79.1 | loss:0.032
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:77.8, f1:28.6, auc:77.2 | trn acc:72.1, f1:23.7, auc:79.3 | loss:0.032
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 4.00 seconds
[51,340] | tst acc:78.1, f1:20.2, auc:78.0 | trn acc:72.1, f1:23.2, auc:80.0 | loss:0.031
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:75.3, f1:8.2, auc:75.6 | trn acc:72.2, f1:23.1, auc:80.2 | loss:0.031
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:75.6, f1:12.0, auc:76.0 | trn acc:72.2, f1:22.3, auc:80.6 | loss:0.031
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:76.7, f1:16.0, auc:76.4 | trn acc:72.1, f1:21.9, auc:80.8 | loss:0.030
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:76.2, f1:17.3, auc:77.5 | trn acc:71.9, f1:21.4, auc:81.4 | loss:0.030
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:78.4, f1:23.5, auc:76.0 | trn acc:72.0, f1:21.1, auc:81.2 | loss:0.030
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:77.6, f1:19.8, auc:78.1 | trn acc:72.3, f1:21.3, auc:81.8 | loss:0.029
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:77.8, f1:20.0, auc:78.9 | trn acc:71.4, f1:20.0, auc:81.5 | loss:0.030
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:77.6, f1:22.9, auc:77.0 | trn acc:71.9, f1:20.2, auc:81.9 | loss:0.029
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:75.9, f1:12.1, auc:79.0 | trn acc:71.5, f1:19.6, auc:81.8 | loss:0.030
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:77.3, f1:16.3, auc:78.0 | trn acc:72.0, f1:19.9, auc:82.4 | loss:0.029
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.96 seconds
[68,112] | tst acc:77.6, f1:14.7, auc:79.4 | trn acc:71.9, f1:19.8, auc:82.1 | loss:0.029
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:77.0, f1:14.4, auc:76.7 | trn acc:71.7, f1:19.4, auc:82.1 | loss:0.029
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:77.0, f1:16.2, auc:77.6 | trn acc:71.6, f1:19.4, auc:82.4 | loss:0.029
Average epoch runtime: 4.05 seconds
Total training time: 291.89 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.1, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.1000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:53.9, f1:52.2, auc:55.1 | trn acc:49.9, f1:45.0, auc:50.0 | loss:2.882
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:56.2, f1:48.0, auc:58.3 | trn acc:53.4, f1:38.9, auc:52.5 | loss:1.990
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:58.1, f1:41.4, auc:56.8 | trn acc:62.0, f1:38.5, auc:57.0 | loss:0.631
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:55.1, f1:39.7, auc:55.8 | trn acc:64.0, f1:37.9, auc:57.1 | loss:0.110
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:58.4, f1:41.2, auc:63.2 | trn acc:65.2, f1:38.3, auc:59.3 | loss:0.096
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:60.0, f1:42.6, auc:65.7 | trn acc:65.8, f1:38.6, auc:60.8 | loss:0.090
Epoch 7 finished in 4.15 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:58.6, f1:39.3, auc:60.4 | trn acc:66.1, f1:38.2, auc:61.8 | loss:0.086
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:63.3, f1:46.2, auc:63.8 | trn acc:66.4, f1:37.9, auc:62.3 | loss:0.081
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.94 seconds
[12,80] | tst acc:62.8, f1:40.6, auc:66.8 | trn acc:67.7, f1:37.6, auc:63.4 | loss:0.078
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:62.6, f1:43.8, auc:66.1 | trn acc:68.0, f1:37.3, auc:63.9 | loss:0.073
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:59.8, f1:36.9, auc:67.7 | trn acc:68.6, f1:36.6, auc:64.4 | loss:0.070
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:62.1, f1:40.6, auc:65.7 | trn acc:69.5, f1:36.3, auc:65.4 | loss:0.066
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:61.4, f1:35.9, auc:71.7 | trn acc:69.9, f1:35.5, auc:66.2 | loss:0.061
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:58.8, f1:31.4, auc:67.3 | trn acc:70.3, f1:34.8, auc:66.8 | loss:0.058
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:59.1, f1:29.3, auc:73.0 | trn acc:70.9, f1:34.2, auc:67.6 | loss:0.055
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:59.3, f1:29.4, auc:67.9 | trn acc:71.1, f1:33.2, auc:68.2 | loss:0.052
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:60.9, f1:30.3, auc:70.6 | trn acc:71.9, f1:32.5, auc:69.2 | loss:0.049
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:60.7, f1:28.9, auc:73.1 | trn acc:71.7, f1:31.6, auc:69.7 | loss:0.047
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:59.3, f1:23.8, auc:72.9 | trn acc:72.0, f1:30.5, auc:70.6 | loss:0.045
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:59.5, f1:24.6, auc:70.8 | trn acc:72.4, f1:29.9, auc:70.9 | loss:0.043
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:60.0, f1:24.1, auc:73.7 | trn acc:71.8, f1:29.0, auc:71.9 | loss:0.041
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:59.5, f1:22.5, auc:75.1 | trn acc:72.4, f1:28.3, auc:72.4 | loss:0.040
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:59.1, f1:20.9, auc:74.5 | trn acc:72.6, f1:28.0, auc:73.4 | loss:0.039
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:57.4, f1:12.6, auc:74.0 | trn acc:72.4, f1:27.4, auc:73.6 | loss:0.038
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:59.3, f1:20.3, auc:79.4 | trn acc:72.3, f1:26.6, auc:74.6 | loss:0.037
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:60.2, f1:22.8, auc:76.0 | trn acc:72.6, f1:26.4, auc:75.2 | loss:0.036
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 4.00 seconds
[39,260] | tst acc:59.3, f1:21.0, auc:78.7 | trn acc:72.4, f1:25.7, auc:75.8 | loss:0.035
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:59.5, f1:20.4, auc:79.5 | trn acc:72.4, f1:25.3, auc:76.0 | loss:0.035
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:60.0, f1:21.3, auc:79.4 | trn acc:72.9, f1:25.0, auc:77.0 | loss:0.034
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:57.6, f1:14.3, auc:76.8 | trn acc:72.0, f1:24.0, auc:77.0 | loss:0.034
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:58.4, f1:15.3, auc:81.6 | trn acc:72.3, f1:23.7, auc:77.7 | loss:0.033
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:58.4, f1:15.3, auc:79.2 | trn acc:72.5, f1:23.6, auc:78.4 | loss:0.032
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:58.6, f1:17.0, auc:82.4 | trn acc:71.6, f1:22.8, auc:78.6 | loss:0.033
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:59.1, f1:19.4, auc:78.1 | trn acc:72.8, f1:22.6, auc:79.4 | loss:0.031
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:57.4, f1:12.6, auc:82.0 | trn acc:72.1, f1:22.0, auc:79.8 | loss:0.031
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:56.9, f1:10.7, auc:79.3 | trn acc:72.2, f1:21.2, auc:79.9 | loss:0.031
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:57.9, f1:13.5, auc:82.3 | trn acc:71.9, f1:21.3, auc:80.3 | loss:0.031
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:57.6, f1:12.6, auc:80.7 | trn acc:72.3, f1:20.4, auc:80.7 | loss:0.030
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:58.4, f1:15.3, auc:82.1 | trn acc:72.1, f1:20.1, auc:81.1 | loss:0.030
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:58.1, f1:15.2, auc:80.5 | trn acc:71.9, f1:19.8, auc:81.2 | loss:0.030
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:58.8, f1:17.1, auc:83.2 | trn acc:72.0, f1:19.7, auc:81.6 | loss:0.030
Epoch 60 finished in 4.21 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:57.4, f1:11.7, auc:82.9 | trn acc:71.5, f1:18.7, auc:81.6 | loss:0.030
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:58.1, f1:14.4, auc:85.2 | trn acc:72.0, f1:19.0, auc:81.9 | loss:0.029
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:57.9, f1:13.5, auc:82.7 | trn acc:71.9, f1:18.6, auc:81.9 | loss:0.029
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:57.4, f1:11.7, auc:83.7 | trn acc:71.8, f1:18.6, auc:82.2 | loss:0.029
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:57.4, f1:11.7, auc:82.2 | trn acc:72.0, f1:18.8, auc:82.1 | loss:0.029
Epoch 68 finished in 4.21 seconds
[69,460] | tst acc:57.4, f1:11.7, auc:82.9 | trn acc:71.2, f1:18.1, auc:82.1 | loss:0.029
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:57.4, f1:11.7, auc:82.3 | trn acc:72.0, f1:18.4, auc:82.1 | loss:0.029
Average epoch runtime: 4.05 seconds
Total training time: 291.85 GPU seconds
alpha = 0.2
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.2, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.2000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:50.4, f1:25.3, auc:53.3 | trn acc:48.6, f1:45.0, auc:50.3 | loss:2.613
Epoch 0 finished in 4.17 seconds
[1,348] | tst acc:57.5, f1:22.9, auc:54.0 | trn acc:53.0, f1:38.5, auc:52.4 | loss:1.973
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:69.8, f1:37.8, auc:66.6 | trn acc:61.5, f1:40.4, auc:57.7 | loss:0.690
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:68.5, f1:34.1, auc:65.7 | trn acc:63.6, f1:40.7, auc:60.0 | loss:0.116
Epoch 4 finished in 4.22 seconds
Epoch 5 finished in 3.96 seconds
[6,40] | tst acc:73.5, f1:39.5, auc:68.1 | trn acc:64.2, f1:40.6, auc:60.1 | loss:0.107
Epoch 6 finished in 4.22 seconds
[7,388] | tst acc:73.8, f1:35.9, auc:70.9 | trn acc:64.9, f1:40.8, auc:62.0 | loss:0.099
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.02 seconds
[9,60] | tst acc:70.9, f1:33.5, auc:70.7 | trn acc:65.7, f1:40.8, auc:62.8 | loss:0.097
Epoch 9 finished in 4.18 seconds
[10,408] | tst acc:74.5, f1:39.8, auc:71.9 | trn acc:66.3, f1:41.0, auc:63.6 | loss:0.095
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:77.7, f1:38.0, auc:75.2 | trn acc:67.0, f1:41.0, auc:64.4 | loss:0.089
Epoch 12 finished in 4.22 seconds
[13,428] | tst acc:73.8, f1:32.4, auc:69.5 | trn acc:68.1, f1:41.3, auc:65.5 | loss:0.087
Epoch 13 finished in 4.18 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:76.4, f1:40.0, auc:75.3 | trn acc:68.4, f1:41.3, auc:65.8 | loss:0.084
Epoch 15 finished in 4.17 seconds
[16,448] | tst acc:75.9, f1:37.0, auc:71.5 | trn acc:69.4, f1:41.4, auc:67.1 | loss:0.079
Epoch 16 finished in 4.22 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:79.5, f1:39.1, auc:73.3 | trn acc:70.2, f1:41.7, auc:67.8 | loss:0.077
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:81.4, f1:45.0, auc:78.3 | trn acc:70.7, f1:41.3, auc:68.5 | loss:0.075
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:81.9, f1:46.5, auc:79.7 | trn acc:71.4, f1:41.4, auc:69.5 | loss:0.070
Epoch 21 finished in 4.17 seconds
[22,488] | tst acc:78.5, f1:32.8, auc:73.5 | trn acc:71.8, f1:41.3, auc:70.1 | loss:0.068
Epoch 22 finished in 4.22 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:83.2, f1:43.9, auc:77.9 | trn acc:72.7, f1:41.5, auc:71.3 | loss:0.064
Epoch 24 finished in 4.22 seconds
[25,508] | tst acc:83.2, f1:42.9, auc:85.8 | trn acc:73.2, f1:41.5, auc:71.9 | loss:0.061
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:83.5, f1:37.6, auc:77.2 | trn acc:73.7, f1:41.5, auc:73.0 | loss:0.059
Epoch 27 finished in 4.17 seconds
[28,528] | tst acc:82.7, f1:40.0, auc:82.7 | trn acc:74.0, f1:41.4, auc:73.8 | loss:0.057
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:86.1, f1:47.5, auc:82.8 | trn acc:74.5, f1:41.6, auc:74.7 | loss:0.056
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:86.1, f1:48.5, auc:85.2 | trn acc:74.4, f1:41.2, auc:74.8 | loss:0.054
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.02 seconds
[33,220] | tst acc:85.8, f1:47.1, auc:83.9 | trn acc:75.2, f1:41.8, auc:76.4 | loss:0.052
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:84.0, f1:34.4, auc:83.5 | trn acc:75.2, f1:41.4, auc:76.5 | loss:0.052
Epoch 34 finished in 4.21 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:85.3, f1:40.4, auc:86.7 | trn acc:75.2, f1:41.3, auc:77.3 | loss:0.051
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:86.4, f1:48.0, auc:87.1 | trn acc:75.0, f1:41.1, auc:77.8 | loss:0.050
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:84.3, f1:30.2, auc:87.1 | trn acc:75.4, f1:41.2, auc:78.5 | loss:0.049
Epoch 39 finished in 4.18 seconds
[40,608] | tst acc:85.6, f1:40.9, auc:89.0 | trn acc:75.6, f1:41.2, auc:79.0 | loss:0.048
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.97 seconds
[42,280] | tst acc:83.7, f1:34.0, auc:88.8 | trn acc:75.2, f1:40.9, auc:79.4 | loss:0.047
Epoch 42 finished in 4.22 seconds
[43,628] | tst acc:85.6, f1:39.6, auc:87.1 | trn acc:76.0, f1:41.3, auc:80.1 | loss:0.046
Epoch 43 finished in 4.18 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:87.4, f1:46.7, auc:92.7 | trn acc:75.9, f1:40.7, auc:80.4 | loss:0.046
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:85.6, f1:39.6, auc:88.5 | trn acc:75.6, f1:41.1, auc:80.6 | loss:0.046
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.97 seconds
[48,320] | tst acc:86.9, f1:43.2, auc:89.2 | trn acc:76.0, f1:40.9, auc:81.0 | loss:0.045
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:88.2, f1:54.5, auc:91.2 | trn acc:75.6, f1:40.4, auc:81.4 | loss:0.045
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:85.8, f1:37.2, auc:89.9 | trn acc:75.7, f1:40.2, auc:81.7 | loss:0.044
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:86.9, f1:44.4, auc:90.0 | trn acc:75.8, f1:40.2, auc:82.1 | loss:0.044
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:85.6, f1:36.8, auc:89.8 | trn acc:75.7, f1:40.1, auc:82.1 | loss:0.044
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:85.0, f1:31.3, auc:90.1 | trn acc:76.0, f1:40.0, auc:82.6 | loss:0.043
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:87.4, f1:46.7, auc:90.1 | trn acc:75.5, f1:39.7, auc:82.6 | loss:0.043
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:86.6, f1:45.2, auc:90.6 | trn acc:76.0, f1:40.1, auc:83.1 | loss:0.042
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:87.7, f1:46.0, auc:90.7 | trn acc:76.1, f1:39.8, auc:83.2 | loss:0.042
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:86.4, f1:39.5, auc:90.7 | trn acc:75.8, f1:39.1, auc:83.3 | loss:0.042
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:88.2, f1:51.6, auc:91.9 | trn acc:75.6, f1:39.3, auc:83.1 | loss:0.042
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:88.2, f1:48.3, auc:92.3 | trn acc:75.7, f1:39.4, auc:83.5 | loss:0.042
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:86.4, f1:38.1, auc:91.1 | trn acc:75.8, f1:39.5, auc:83.4 | loss:0.042
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:86.9, f1:41.9, auc:90.1 | trn acc:76.1, f1:39.8, auc:83.6 | loss:0.041
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:86.6, f1:45.2, auc:92.0 | trn acc:75.7, f1:39.5, auc:83.8 | loss:0.042
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:87.9, f1:43.9, auc:92.0 | trn acc:75.9, f1:39.3, auc:83.6 | loss:0.042
Average epoch runtime: 4.06 seconds
Total training time: 292.47 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.2, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.2000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:52.3, f1:60.2, auc:51.8 | trn acc:48.4, f1:42.9, auc:49.0 | loss:2.770
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:49.8, f1:53.4, auc:56.6 | trn acc:53.1, f1:38.2, auc:52.5 | loss:1.972
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:48.1, f1:46.6, auc:60.2 | trn acc:61.3, f1:40.0, auc:57.4 | loss:0.685
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:45.6, f1:47.2, auc:56.5 | trn acc:63.7, f1:40.0, auc:59.8 | loss:0.116
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:45.6, f1:43.3, auc:61.0 | trn acc:64.0, f1:40.3, auc:60.0 | loss:0.108
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:48.4, f1:44.6, auc:63.9 | trn acc:65.1, f1:40.7, auc:61.9 | loss:0.103
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:46.0, f1:43.5, auc:57.9 | trn acc:65.3, f1:40.5, auc:62.3 | loss:0.097
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:51.6, f1:50.1, auc:62.7 | trn acc:66.3, f1:40.7, auc:63.5 | loss:0.093
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:48.4, f1:42.0, auc:65.3 | trn acc:66.9, f1:40.8, auc:64.1 | loss:0.091
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:49.3, f1:45.6, auc:68.6 | trn acc:67.6, f1:41.0, auc:64.9 | loss:0.087
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:46.7, f1:41.5, auc:64.2 | trn acc:68.5, f1:41.1, auc:65.9 | loss:0.084
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:46.5, f1:40.8, auc:65.2 | trn acc:69.1, f1:41.2, auc:66.4 | loss:0.079
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:45.1, f1:35.3, auc:68.2 | trn acc:70.2, f1:41.3, auc:67.8 | loss:0.075
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:45.6, f1:37.2, auc:67.5 | trn acc:70.8, f1:41.1, auc:68.4 | loss:0.072
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:46.0, f1:36.7, auc:69.9 | trn acc:71.2, f1:41.1, auc:69.2 | loss:0.070
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:43.7, f1:33.2, auc:67.8 | trn acc:72.2, f1:41.2, auc:70.2 | loss:0.066
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:44.2, f1:32.7, auc:66.6 | trn acc:72.7, f1:41.2, auc:71.2 | loss:0.064
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:43.5, f1:29.7, auc:70.8 | trn acc:73.5, f1:41.7, auc:72.1 | loss:0.062
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:41.6, f1:25.6, auc:71.3 | trn acc:73.8, f1:41.4, auc:73.2 | loss:0.059
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:44.6, f1:31.7, auc:67.8 | trn acc:74.2, f1:41.2, auc:73.8 | loss:0.057
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:42.3, f1:26.3, auc:70.7 | trn acc:74.6, f1:41.4, auc:74.7 | loss:0.055
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:44.2, f1:29.9, auc:71.0 | trn acc:74.7, f1:41.2, auc:75.2 | loss:0.054
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:44.9, f1:31.4, auc:71.9 | trn acc:74.9, f1:41.1, auc:75.9 | loss:0.053
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:40.9, f1:23.1, auc:73.2 | trn acc:75.2, f1:41.3, auc:76.9 | loss:0.051
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:43.5, f1:28.0, auc:73.7 | trn acc:75.2, f1:41.2, auc:77.3 | loss:0.050
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:43.9, f1:29.8, auc:72.5 | trn acc:75.2, f1:41.0, auc:77.8 | loss:0.050
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:41.8, f1:24.3, auc:77.9 | trn acc:75.8, f1:41.2, auc:78.5 | loss:0.048
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:41.8, f1:24.8, auc:80.2 | trn acc:75.7, f1:41.0, auc:79.1 | loss:0.048
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:42.5, f1:26.3, auc:80.5 | trn acc:75.8, f1:41.1, auc:79.6 | loss:0.047
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:41.1, f1:24.1, auc:75.2 | trn acc:75.6, f1:40.9, auc:79.7 | loss:0.047
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:41.1, f1:22.7, auc:77.8 | trn acc:75.9, f1:40.9, auc:80.4 | loss:0.046
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:40.4, f1:21.1, auc:75.6 | trn acc:75.9, f1:40.9, auc:80.5 | loss:0.046
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:40.7, f1:22.1, auc:80.9 | trn acc:75.9, f1:40.2, auc:80.8 | loss:0.045
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:41.8, f1:25.2, auc:79.5 | trn acc:75.7, f1:40.1, auc:81.6 | loss:0.044
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:40.4, f1:21.5, auc:76.9 | trn acc:76.1, f1:40.4, auc:81.8 | loss:0.044
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:39.5, f1:19.3, auc:80.9 | trn acc:75.6, f1:39.8, auc:82.0 | loss:0.044
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:40.0, f1:19.9, auc:81.8 | trn acc:75.6, f1:39.9, auc:82.2 | loss:0.044
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:39.3, f1:18.7, auc:80.5 | trn acc:76.0, f1:39.4, auc:82.6 | loss:0.043
Epoch 56 finished in 4.21 seconds
[57,380] | tst acc:41.8, f1:24.8, auc:80.0 | trn acc:75.6, f1:38.9, auc:82.6 | loss:0.043
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:42.1, f1:24.8, auc:79.1 | trn acc:76.0, f1:39.3, auc:83.1 | loss:0.042
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:40.2, f1:21.0, auc:78.2 | trn acc:76.1, f1:38.9, auc:82.9 | loss:0.042
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:41.1, f1:22.7, auc:81.3 | trn acc:75.7, f1:38.9, auc:83.3 | loss:0.042
Epoch 62 finished in 4.21 seconds
[63,420] | tst acc:42.1, f1:25.3, auc:79.8 | trn acc:75.8, f1:38.5, auc:83.4 | loss:0.042
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:40.0, f1:20.4, auc:78.3 | trn acc:75.8, f1:38.8, auc:83.6 | loss:0.042
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:40.2, f1:20.5, auc:80.1 | trn acc:75.9, f1:39.2, auc:83.5 | loss:0.042
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:40.9, f1:22.2, auc:80.5 | trn acc:75.8, f1:38.8, auc:83.7 | loss:0.041
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:40.4, f1:21.1, auc:81.6 | trn acc:75.8, f1:38.6, auc:83.8 | loss:0.041
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:40.2, f1:20.5, auc:80.2 | trn acc:75.9, f1:38.6, auc:83.6 | loss:0.041
Average epoch runtime: 4.05 seconds
Total training time: 291.83 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.2, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.2000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:47.4, f1:44.3, auc:50.0 | trn acc:49.2, f1:39.7, auc:51.5 | loss:2.871
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:54.5, f1:46.8, auc:54.2 | trn acc:53.1, f1:38.8, auc:52.5 | loss:1.958
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:57.5, f1:42.0, auc:52.0 | trn acc:61.1, f1:40.1, auc:56.9 | loss:0.676
Epoch 3 finished in 4.17 seconds
[4,368] | tst acc:57.2, f1:44.2, auc:54.3 | trn acc:63.3, f1:40.4, auc:59.5 | loss:0.115
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:58.5, f1:44.0, auc:59.5 | trn acc:64.1, f1:40.7, auc:60.0 | loss:0.111
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:57.8, f1:39.6, auc:57.9 | trn acc:64.7, f1:41.4, auc:61.6 | loss:0.101
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 4.00 seconds
[9,60] | tst acc:59.7, f1:41.8, auc:56.7 | trn acc:65.2, f1:40.9, auc:62.1 | loss:0.098
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:60.3, f1:43.2, auc:62.8 | trn acc:66.0, f1:41.3, auc:63.2 | loss:0.094
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:61.5, f1:42.4, auc:64.7 | trn acc:66.8, f1:41.1, auc:64.0 | loss:0.091
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:63.1, f1:49.2, auc:67.3 | trn acc:67.3, f1:41.6, auc:65.0 | loss:0.087
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:61.5, f1:41.3, auc:63.1 | trn acc:68.4, f1:41.4, auc:65.9 | loss:0.084
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:56.0, f1:32.2, auc:57.7 | trn acc:69.0, f1:41.7, auc:66.6 | loss:0.081
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:59.7, f1:34.8, auc:58.9 | trn acc:69.9, f1:41.6, auc:67.8 | loss:0.077
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:58.2, f1:37.0, auc:61.0 | trn acc:70.5, f1:41.5, auc:68.3 | loss:0.074
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:62.2, f1:38.2, auc:66.5 | trn acc:71.4, f1:41.8, auc:69.5 | loss:0.071
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:58.8, f1:35.0, auc:62.3 | trn acc:71.5, f1:41.8, auc:70.1 | loss:0.068
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:61.2, f1:33.7, auc:66.8 | trn acc:72.7, f1:42.1, auc:71.2 | loss:0.064
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:62.8, f1:37.3, auc:69.2 | trn acc:73.0, f1:41.9, auc:72.1 | loss:0.062
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:60.9, f1:30.6, auc:70.6 | trn acc:73.6, f1:42.0, auc:73.1 | loss:0.060
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:61.8, f1:33.3, auc:69.3 | trn acc:74.0, f1:41.8, auc:73.5 | loss:0.058
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:62.8, f1:33.9, auc:65.9 | trn acc:74.3, f1:42.0, auc:74.5 | loss:0.056
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:62.5, f1:30.7, auc:72.7 | trn acc:74.4, f1:41.5, auc:75.0 | loss:0.055
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 4.00 seconds
[33,220] | tst acc:64.0, f1:36.8, auc:71.7 | trn acc:74.8, f1:41.6, auc:76.0 | loss:0.053
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:62.8, f1:29.2, auc:72.9 | trn acc:75.1, f1:41.7, auc:76.7 | loss:0.052
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:65.8, f1:40.0, auc:78.8 | trn acc:74.9, f1:41.7, auc:77.0 | loss:0.051
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:65.2, f1:36.9, auc:73.4 | trn acc:75.5, f1:41.6, auc:77.7 | loss:0.050
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:64.0, f1:33.1, auc:71.0 | trn acc:75.4, f1:41.6, auc:78.3 | loss:0.049
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:64.3, f1:34.1, auc:75.0 | trn acc:75.4, f1:41.5, auc:78.8 | loss:0.048
Epoch 40 finished in 4.21 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:63.1, f1:31.8, auc:76.8 | trn acc:75.3, f1:41.0, auc:78.9 | loss:0.048
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:63.7, f1:33.7, auc:73.8 | trn acc:75.5, f1:41.2, auc:79.6 | loss:0.047
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:62.8, f1:29.2, auc:78.0 | trn acc:75.5, f1:41.0, auc:80.2 | loss:0.046
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:63.4, f1:31.2, auc:78.1 | trn acc:75.7, f1:41.2, auc:80.4 | loss:0.046
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:64.0, f1:33.1, auc:76.8 | trn acc:75.5, f1:41.1, auc:80.7 | loss:0.046
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:63.7, f1:34.4, auc:76.9 | trn acc:75.9, f1:40.8, auc:81.2 | loss:0.045
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:63.1, f1:30.2, auc:75.1 | trn acc:75.8, f1:41.1, auc:81.5 | loss:0.044
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:62.8, f1:30.1, auc:74.2 | trn acc:75.5, f1:40.4, auc:81.8 | loss:0.044
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:64.3, f1:32.6, auc:77.8 | trn acc:75.6, f1:40.2, auc:82.1 | loss:0.044
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:62.8, f1:27.5, auc:76.4 | trn acc:75.7, f1:40.3, auc:82.3 | loss:0.043
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:65.5, f1:37.1, auc:79.1 | trn acc:75.6, f1:40.3, auc:82.6 | loss:0.043
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:64.6, f1:35.0, auc:76.9 | trn acc:75.7, f1:39.9, auc:82.6 | loss:0.043
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:63.1, f1:29.4, auc:77.1 | trn acc:75.8, f1:39.8, auc:83.1 | loss:0.042
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:63.4, f1:31.2, auc:78.9 | trn acc:75.2, f1:39.3, auc:82.9 | loss:0.043
Epoch 62 finished in 4.21 seconds
[63,420] | tst acc:65.8, f1:37.3, auc:81.6 | trn acc:75.9, f1:39.8, auc:83.1 | loss:0.042
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:64.6, f1:34.3, auc:77.3 | trn acc:75.7, f1:39.8, auc:83.6 | loss:0.042
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:62.5, f1:28.2, auc:78.3 | trn acc:75.8, f1:39.7, auc:83.2 | loss:0.042
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:62.8, f1:28.4, auc:79.7 | trn acc:75.4, f1:39.3, auc:83.3 | loss:0.042
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:62.2, f1:28.9, auc:78.0 | trn acc:75.6, f1:39.4, auc:83.5 | loss:0.042
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:61.8, f1:24.4, auc:78.5 | trn acc:75.6, f1:39.5, auc:83.3 | loss:0.042
Average epoch runtime: 4.05 seconds
Total training time: 291.89 GPU seconds
alpha = 0.3
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.3, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.3000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.4, f1:50.2, auc:50.3 | trn acc:46.9, f1:31.6, auc:47.6 | loss:2.888
Epoch 0 finished in 4.17 seconds
[1,348] | tst acc:53.1, f1:50.4, auc:56.4 | trn acc:52.6, f1:39.3, auc:52.5 | loss:1.901
Epoch 1 finished in 4.18 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:56.6, f1:49.3, auc:53.1 | trn acc:60.0, f1:42.0, auc:57.3 | loss:0.706
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:53.4, f1:46.9, auc:53.4 | trn acc:61.9, f1:42.2, auc:59.1 | loss:0.107
Epoch 4 finished in 4.22 seconds
Epoch 5 finished in 3.96 seconds
[6,40] | tst acc:56.9, f1:49.1, auc:54.3 | trn acc:62.3, f1:42.9, auc:59.7 | loss:0.103
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:54.4, f1:45.8, auc:54.2 | trn acc:62.8, f1:43.0, auc:60.3 | loss:0.101
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:55.1, f1:45.6, auc:53.4 | trn acc:63.0, f1:43.0, auc:61.2 | loss:0.097
Epoch 9 finished in 4.17 seconds
[10,408] | tst acc:61.2, f1:54.3, auc:60.4 | trn acc:63.8, f1:43.3, auc:62.1 | loss:0.096
Epoch 10 finished in 4.23 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:59.9, f1:50.0, auc:56.6 | trn acc:64.5, f1:43.8, auc:63.1 | loss:0.093
Epoch 12 finished in 4.22 seconds
[13,428] | tst acc:57.9, f1:49.1, auc:56.6 | trn acc:65.0, f1:43.8, auc:63.8 | loss:0.092
Epoch 13 finished in 4.17 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:56.9, f1:46.6, auc:58.5 | trn acc:66.0, f1:44.2, auc:64.7 | loss:0.089
Epoch 15 finished in 4.17 seconds
[16,448] | tst acc:56.4, f1:44.6, auc:52.5 | trn acc:66.6, f1:45.0, auc:65.6 | loss:0.086
Epoch 16 finished in 4.22 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:57.6, f1:43.1, auc:54.5 | trn acc:67.7, f1:45.3, auc:66.6 | loss:0.085
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:59.4, f1:48.1, auc:61.7 | trn acc:68.5, f1:45.1, auc:67.4 | loss:0.083
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.00 seconds
[21,140] | tst acc:59.4, f1:46.4, auc:59.1 | trn acc:69.1, f1:46.0, auc:68.4 | loss:0.080
Epoch 21 finished in 4.18 seconds
[22,488] | tst acc:59.9, f1:45.9, auc:60.0 | trn acc:70.3, f1:46.3, auc:69.8 | loss:0.078
Epoch 22 finished in 4.22 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:64.2, f1:51.2, auc:61.0 | trn acc:71.6, f1:47.3, auc:71.1 | loss:0.075
Epoch 24 finished in 4.22 seconds
[25,508] | tst acc:61.7, f1:47.4, auc:62.5 | trn acc:72.2, f1:47.5, auc:71.8 | loss:0.072
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:58.1, f1:39.3, auc:60.8 | trn acc:73.3, f1:48.3, auc:73.0 | loss:0.070
Epoch 27 finished in 4.17 seconds
[28,528] | tst acc:62.2, f1:46.3, auc:62.2 | trn acc:73.6, f1:48.7, auc:73.9 | loss:0.068
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:61.9, f1:44.1, auc:67.7 | trn acc:74.4, f1:49.4, auc:75.0 | loss:0.065
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:64.2, f1:48.7, auc:65.8 | trn acc:75.3, f1:50.0, auc:76.1 | loss:0.063
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:61.7, f1:45.2, auc:65.0 | trn acc:75.4, f1:49.9, auc:76.6 | loss:0.062
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:61.7, f1:44.0, auc:68.4 | trn acc:75.8, f1:50.5, auc:77.5 | loss:0.061
Epoch 34 finished in 4.21 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:62.7, f1:44.6, auc:65.4 | trn acc:76.3, f1:50.7, auc:78.0 | loss:0.060
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:63.2, f1:46.5, auc:67.3 | trn acc:76.7, f1:51.4, auc:78.8 | loss:0.059
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:63.2, f1:44.9, auc:71.4 | trn acc:76.8, f1:51.5, auc:79.1 | loss:0.058
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:61.9, f1:43.3, auc:67.5 | trn acc:76.9, f1:51.9, auc:79.9 | loss:0.057
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.96 seconds
[42,280] | tst acc:62.4, f1:44.4, auc:71.4 | trn acc:77.3, f1:52.2, auc:80.2 | loss:0.056
Epoch 42 finished in 4.22 seconds
[43,628] | tst acc:63.9, f1:45.5, auc:71.0 | trn acc:77.4, f1:52.7, auc:80.7 | loss:0.055
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:63.4, f1:44.7, auc:69.4 | trn acc:77.4, f1:52.4, auc:81.0 | loss:0.055
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:61.4, f1:40.8, auc:71.0 | trn acc:77.6, f1:52.5, auc:81.4 | loss:0.054
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:64.2, f1:47.2, auc:71.6 | trn acc:77.4, f1:52.4, auc:81.5 | loss:0.054
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:63.2, f1:45.8, auc:71.2 | trn acc:78.1, f1:53.2, auc:82.0 | loss:0.053
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.01 seconds
[51,340] | tst acc:59.9, f1:38.0, auc:71.4 | trn acc:78.0, f1:53.3, auc:82.4 | loss:0.053
Epoch 51 finished in 4.17 seconds
Epoch 52 finished in 4.01 seconds
[53,12] | tst acc:62.9, f1:43.9, auc:70.7 | trn acc:77.8, f1:53.1, auc:82.4 | loss:0.053
Epoch 53 finished in 4.17 seconds
[54,360] | tst acc:60.4, f1:37.8, auc:71.8 | trn acc:78.3, f1:53.7, auc:82.8 | loss:0.052
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:61.9, f1:42.9, auc:72.6 | trn acc:77.9, f1:53.4, auc:82.8 | loss:0.052
Epoch 56 finished in 4.22 seconds
[57,380] | tst acc:62.4, f1:43.2, auc:72.6 | trn acc:78.3, f1:53.6, auc:83.0 | loss:0.052
Epoch 57 finished in 4.17 seconds
Epoch 58 finished in 4.01 seconds
[59,52] | tst acc:63.4, f1:45.9, auc:74.6 | trn acc:77.9, f1:53.6, auc:83.2 | loss:0.052
Epoch 59 finished in 4.17 seconds
[60,400] | tst acc:61.7, f1:40.9, auc:73.3 | trn acc:78.3, f1:54.2, auc:83.5 | loss:0.051
Epoch 60 finished in 4.22 seconds
Epoch 61 finished in 3.96 seconds
[62,72] | tst acc:60.7, f1:39.4, auc:74.5 | trn acc:78.4, f1:54.2, auc:83.6 | loss:0.051
Epoch 62 finished in 4.21 seconds
[63,420] | tst acc:64.9, f1:49.3, auc:74.7 | trn acc:78.3, f1:54.1, auc:83.8 | loss:0.051
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 4.01 seconds
[65,92] | tst acc:62.2, f1:42.1, auc:74.7 | trn acc:78.2, f1:54.0, auc:83.6 | loss:0.051
Epoch 65 finished in 4.17 seconds
[66,440] | tst acc:62.2, f1:41.2, auc:75.1 | trn acc:78.4, f1:54.2, auc:83.8 | loss:0.051
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.96 seconds
[68,112] | tst acc:60.7, f1:38.4, auc:74.7 | trn acc:78.7, f1:54.4, auc:83.9 | loss:0.050
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:64.2, f1:47.2, auc:74.9 | trn acc:78.1, f1:53.9, auc:83.9 | loss:0.051
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:60.9, f1:39.1, auc:75.2 | trn acc:78.5, f1:54.4, auc:83.9 | loss:0.051
Average epoch runtime: 4.07 seconds
Total training time: 292.85 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.3, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.3000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:47.2, f1:27.3, auc:49.1 | trn acc:48.7, f1:36.6, auc:49.5 | loss:2.797
Epoch 0 finished in 4.18 seconds
[1,348] | tst acc:56.6, f1:29.6, auc:55.1 | trn acc:52.5, f1:39.9, auc:52.5 | loss:1.894
Epoch 1 finished in 4.18 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:66.8, f1:36.7, auc:61.3 | trn acc:60.1, f1:42.2, auc:57.7 | loss:0.725
Epoch 3 finished in 4.17 seconds
[4,368] | tst acc:60.9, f1:34.2, auc:61.1 | trn acc:62.1, f1:42.7, auc:60.0 | loss:0.110
Epoch 4 finished in 4.22 seconds
Epoch 5 finished in 3.96 seconds
[6,40] | tst acc:66.8, f1:37.4, auc:65.8 | trn acc:62.2, f1:43.1, auc:60.1 | loss:0.106
Epoch 6 finished in 4.22 seconds
[7,388] | tst acc:67.0, f1:33.5, auc:62.4 | trn acc:62.9, f1:43.3, auc:61.1 | loss:0.104
Epoch 7 finished in 4.17 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:68.6, f1:39.4, auc:69.1 | trn acc:63.3, f1:43.5, auc:62.1 | loss:0.099
Epoch 9 finished in 4.18 seconds
[10,408] | tst acc:70.8, f1:44.1, auc:68.5 | trn acc:63.9, f1:43.8, auc:62.8 | loss:0.097
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:70.8, f1:41.7, auc:70.8 | trn acc:64.9, f1:44.1, auc:63.7 | loss:0.094
Epoch 12 finished in 4.22 seconds
[13,428] | tst acc:70.2, f1:44.2, auc:73.4 | trn acc:65.4, f1:44.5, auc:64.7 | loss:0.092
Epoch 13 finished in 4.18 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:68.4, f1:38.5, auc:69.5 | trn acc:66.1, f1:44.6, auc:65.2 | loss:0.091
Epoch 15 finished in 4.17 seconds
[16,448] | tst acc:71.0, f1:40.0, auc:66.9 | trn acc:67.4, f1:45.4, auc:66.5 | loss:0.087
Epoch 16 finished in 4.22 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:73.5, f1:42.8, auc:68.7 | trn acc:68.1, f1:45.8, auc:67.2 | loss:0.085
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:74.3, f1:47.8, auc:75.8 | trn acc:68.7, f1:46.0, auc:68.2 | loss:0.083
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:74.5, f1:43.1, auc:74.5 | trn acc:69.6, f1:46.5, auc:69.2 | loss:0.080
Epoch 21 finished in 4.17 seconds
[22,488] | tst acc:73.5, f1:41.4, auc:73.1 | trn acc:70.7, f1:47.0, auc:70.3 | loss:0.078
Epoch 22 finished in 4.22 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:77.2, f1:46.5, auc:76.4 | trn acc:71.5, f1:47.2, auc:71.2 | loss:0.075
Epoch 24 finished in 4.22 seconds
[25,508] | tst acc:81.0, f1:54.2, auc:81.3 | trn acc:72.4, f1:48.3, auc:72.4 | loss:0.073
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:75.9, f1:44.4, auc:74.3 | trn acc:73.3, f1:48.7, auc:73.6 | loss:0.070
Epoch 27 finished in 4.17 seconds
[28,528] | tst acc:81.2, f1:52.1, auc:81.4 | trn acc:73.7, f1:49.0, auc:74.3 | loss:0.068
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:82.6, f1:55.2, auc:82.6 | trn acc:74.2, f1:49.9, auc:75.2 | loss:0.066
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:82.6, f1:58.6, auc:84.0 | trn acc:75.0, f1:49.9, auc:75.9 | loss:0.064
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:79.9, f1:50.3, auc:80.9 | trn acc:75.4, f1:50.7, auc:76.9 | loss:0.062
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:83.6, f1:57.9, auc:85.4 | trn acc:75.7, f1:50.9, auc:77.5 | loss:0.061
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:85.8, f1:63.9, auc:87.4 | trn acc:75.9, f1:51.3, auc:78.4 | loss:0.060
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:84.7, f1:61.7, auc:87.1 | trn acc:76.3, f1:51.7, auc:78.7 | loss:0.059
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:83.1, f1:56.6, auc:87.8 | trn acc:76.8, f1:52.3, auc:79.4 | loss:0.058
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:83.9, f1:58.3, auc:85.0 | trn acc:76.6, f1:51.9, auc:79.6 | loss:0.057
Epoch 40 finished in 4.21 seconds
Epoch 41 finished in 3.97 seconds
[42,280] | tst acc:82.6, f1:54.5, auc:86.6 | trn acc:76.8, f1:52.2, auc:80.0 | loss:0.057
Epoch 42 finished in 4.22 seconds
[43,628] | tst acc:85.0, f1:60.6, auc:86.0 | trn acc:77.2, f1:53.0, auc:80.8 | loss:0.056
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:84.5, f1:58.6, auc:88.0 | trn acc:77.5, f1:53.2, auc:81.1 | loss:0.055
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:85.3, f1:60.4, auc:88.3 | trn acc:77.1, f1:52.6, auc:81.1 | loss:0.055
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:84.7, f1:60.7, auc:87.6 | trn acc:77.2, f1:53.0, auc:81.6 | loss:0.055
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:83.6, f1:57.9, auc:87.9 | trn acc:77.8, f1:53.4, auc:82.0 | loss:0.054
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:85.5, f1:60.3, auc:88.6 | trn acc:77.7, f1:53.8, auc:82.2 | loss:0.054
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:84.5, f1:59.2, auc:88.3 | trn acc:77.7, f1:53.6, auc:82.4 | loss:0.053
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:85.8, f1:59.5, auc:88.7 | trn acc:77.8, f1:53.7, auc:82.6 | loss:0.053
Epoch 54 finished in 4.19 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:85.8, f1:63.4, auc:89.7 | trn acc:77.6, f1:53.4, auc:82.7 | loss:0.053
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:86.3, f1:64.8, auc:89.0 | trn acc:78.0, f1:53.8, auc:83.3 | loss:0.052
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:85.8, f1:62.4, auc:89.5 | trn acc:77.7, f1:54.0, auc:82.9 | loss:0.052
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:86.1, f1:62.3, auc:89.4 | trn acc:77.9, f1:54.1, auc:83.4 | loss:0.052
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:86.1, f1:61.2, auc:90.1 | trn acc:78.1, f1:54.1, auc:83.5 | loss:0.051
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:86.3, f1:65.3, auc:89.1 | trn acc:78.1, f1:54.1, auc:83.6 | loss:0.051
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:88.5, f1:68.6, auc:91.6 | trn acc:78.1, f1:54.1, auc:83.6 | loss:0.051
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:86.1, f1:62.3, auc:89.8 | trn acc:78.3, f1:54.4, auc:83.7 | loss:0.051
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:85.3, f1:60.4, auc:88.8 | trn acc:77.8, f1:54.0, auc:83.7 | loss:0.051
Epoch 68 finished in 4.19 seconds
[69,460] | tst acc:86.6, f1:65.3, auc:90.8 | trn acc:78.1, f1:54.3, auc:83.8 | loss:0.051
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:87.7, f1:66.2, auc:92.1 | trn acc:78.1, f1:54.2, auc:83.7 | loss:0.051
Average epoch runtime: 4.06 seconds
Total training time: 292.36 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.3, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.3000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.4, f1:54.4, auc:48.1 | trn acc:50.1, f1:47.1, auc:51.0 | loss:2.432
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:51.2, f1:52.6, auc:53.0 | trn acc:52.6, f1:39.5, auc:52.5 | loss:1.908
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:56.7, f1:54.1, auc:59.3 | trn acc:59.8, f1:41.8, auc:57.6 | loss:0.743
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:50.8, f1:49.5, auc:55.7 | trn acc:62.4, f1:42.7, auc:60.1 | loss:0.109
Epoch 4 finished in 4.20 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:58.8, f1:56.4, auc:67.7 | trn acc:62.5, f1:42.7, auc:60.2 | loss:0.109
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:55.1, f1:49.7, auc:63.5 | trn acc:63.1, f1:42.9, auc:61.1 | loss:0.103
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:53.5, f1:49.5, auc:61.1 | trn acc:63.4, f1:43.2, auc:61.8 | loss:0.099
Epoch 9 finished in 4.15 seconds
[10,408] | tst acc:58.4, f1:56.0, auc:67.5 | trn acc:64.0, f1:43.3, auc:62.6 | loss:0.099
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:55.1, f1:50.1, auc:64.9 | trn acc:64.9, f1:43.7, auc:63.7 | loss:0.094
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:56.9, f1:52.2, auc:65.0 | trn acc:65.4, f1:43.8, auc:64.4 | loss:0.092
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:55.5, f1:50.8, auc:66.2 | trn acc:66.4, f1:44.2, auc:65.4 | loss:0.089
Epoch 15 finished in 4.15 seconds
[16,448] | tst acc:52.4, f1:45.9, auc:61.4 | trn acc:67.1, f1:44.7, auc:66.1 | loss:0.087
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:54.7, f1:45.6, auc:68.5 | trn acc:68.2, f1:45.3, auc:67.2 | loss:0.085
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:55.3, f1:47.9, auc:67.5 | trn acc:68.7, f1:45.3, auc:68.0 | loss:0.083
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.00 seconds
[21,140] | tst acc:55.7, f1:47.9, auc:69.6 | trn acc:69.8, f1:45.9, auc:69.1 | loss:0.080
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:54.3, f1:44.9, auc:68.8 | trn acc:70.6, f1:46.5, auc:70.0 | loss:0.077
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:57.3, f1:47.1, auc:72.6 | trn acc:71.7, f1:47.0, auc:71.1 | loss:0.075
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:56.3, f1:46.0, auc:71.0 | trn acc:72.5, f1:47.7, auc:72.1 | loss:0.073
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:55.9, f1:43.9, auc:71.9 | trn acc:73.1, f1:47.9, auc:73.0 | loss:0.070
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:54.3, f1:41.0, auc:72.6 | trn acc:73.7, f1:48.2, auc:73.9 | loss:0.068
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:53.1, f1:38.2, auc:74.1 | trn acc:74.3, f1:48.9, auc:75.0 | loss:0.065
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:57.1, f1:44.8, auc:74.7 | trn acc:75.0, f1:49.3, auc:75.7 | loss:0.064
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.00 seconds
[33,220] | tst acc:59.4, f1:48.4, auc:75.3 | trn acc:75.4, f1:50.0, auc:76.6 | loss:0.062
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:57.3, f1:44.4, auc:76.7 | trn acc:75.7, f1:50.2, auc:77.2 | loss:0.061
Epoch 34 finished in 4.21 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:55.5, f1:41.6, auc:75.0 | trn acc:76.0, f1:50.6, auc:77.8 | loss:0.060
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:56.7, f1:43.8, auc:78.4 | trn acc:76.3, f1:50.8, auc:78.6 | loss:0.059
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:57.8, f1:46.1, auc:76.3 | trn acc:76.6, f1:51.1, auc:79.0 | loss:0.058
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:55.5, f1:41.6, auc:80.1 | trn acc:76.6, f1:51.4, auc:79.5 | loss:0.057
Epoch 40 finished in 4.21 seconds
Epoch 41 finished in 3.96 seconds
[42,280] | tst acc:56.9, f1:43.6, auc:80.4 | trn acc:77.1, f1:51.6, auc:80.0 | loss:0.056
Epoch 42 finished in 4.22 seconds
[43,628] | tst acc:55.5, f1:41.3, auc:79.5 | trn acc:77.0, f1:52.0, auc:80.4 | loss:0.056
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:56.3, f1:41.8, auc:80.0 | trn acc:77.3, f1:51.9, auc:80.7 | loss:0.055
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:56.1, f1:41.7, auc:78.2 | trn acc:77.1, f1:52.2, auc:81.1 | loss:0.055
Epoch 46 finished in 4.21 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:56.9, f1:43.6, auc:80.0 | trn acc:77.1, f1:52.0, auc:81.2 | loss:0.055
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:55.7, f1:42.1, auc:80.5 | trn acc:77.6, f1:52.4, auc:81.8 | loss:0.054
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.01 seconds
[51,340] | tst acc:55.5, f1:40.4, auc:80.9 | trn acc:77.5, f1:52.6, auc:81.9 | loss:0.054
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 4.01 seconds
[53,12] | tst acc:56.1, f1:41.7, auc:81.4 | trn acc:77.7, f1:52.8, auc:82.3 | loss:0.053
Epoch 53 finished in 4.17 seconds
[54,360] | tst acc:56.3, f1:41.2, auc:82.0 | trn acc:77.6, f1:52.4, auc:82.4 | loss:0.053
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:56.7, f1:42.6, auc:82.5 | trn acc:77.7, f1:52.7, auc:82.4 | loss:0.053
Epoch 56 finished in 4.21 seconds
[57,380] | tst acc:56.5, f1:43.1, auc:82.4 | trn acc:77.7, f1:52.9, auc:82.8 | loss:0.052
Epoch 57 finished in 4.17 seconds
Epoch 58 finished in 4.01 seconds
[59,52] | tst acc:55.7, f1:41.8, auc:83.8 | trn acc:78.0, f1:53.1, auc:82.9 | loss:0.052
Epoch 59 finished in 4.17 seconds
[60,400] | tst acc:56.5, f1:42.2, auc:84.8 | trn acc:77.7, f1:52.6, auc:83.1 | loss:0.052
Epoch 60 finished in 4.22 seconds
Epoch 61 finished in 3.96 seconds
[62,72] | tst acc:54.9, f1:39.2, auc:83.5 | trn acc:78.0, f1:53.1, auc:83.2 | loss:0.052
Epoch 62 finished in 4.21 seconds
[63,420] | tst acc:58.2, f1:45.8, auc:81.1 | trn acc:78.1, f1:53.3, auc:83.5 | loss:0.051
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 4.01 seconds
[65,92] | tst acc:56.5, f1:41.9, auc:84.8 | trn acc:77.8, f1:53.3, auc:83.4 | loss:0.052
Epoch 65 finished in 4.17 seconds
[66,440] | tst acc:57.3, f1:43.5, auc:84.8 | trn acc:78.1, f1:53.6, auc:83.3 | loss:0.051
Epoch 66 finished in 4.22 seconds
Epoch 67 finished in 3.96 seconds
[68,112] | tst acc:57.1, f1:43.1, auc:84.9 | trn acc:78.2, f1:53.4, auc:83.6 | loss:0.051
Epoch 68 finished in 4.21 seconds
[69,460] | tst acc:58.6, f1:46.3, auc:84.4 | trn acc:77.9, f1:53.2, auc:83.5 | loss:0.051
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:55.7, f1:39.9, auc:84.6 | trn acc:78.1, f1:53.5, auc:83.6 | loss:0.051
Average epoch runtime: 4.06 seconds
Total training time: 292.38 GPU seconds
alpha = 0.4
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.4, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.4000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:50.4, f1:46.4, auc:49.5 | trn acc:49.6, f1:39.8, auc:51.3 | loss:2.450
Epoch 0 finished in 4.13 seconds
[1,348] | tst acc:49.4, f1:42.0, auc:50.7 | trn acc:52.2, f1:39.6, auc:52.5 | loss:1.832
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:58.7, f1:47.5, auc:59.6 | trn acc:59.1, f1:42.7, auc:58.0 | loss:0.779
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:54.1, f1:45.7, auc:55.6 | trn acc:61.1, f1:43.9, auc:59.7 | loss:0.108
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:58.5, f1:48.4, auc:62.1 | trn acc:61.5, f1:44.1, auc:60.3 | loss:0.102
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:58.9, f1:46.0, auc:61.7 | trn acc:62.1, f1:44.4, auc:60.9 | loss:0.103
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 4.00 seconds
[9,60] | tst acc:59.3, f1:48.1, auc:64.2 | trn acc:62.2, f1:44.6, auc:61.5 | loss:0.099
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:64.8, f1:55.4, auc:65.5 | trn acc:63.0, f1:45.0, auc:62.7 | loss:0.098
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:60.0, f1:47.8, auc:63.5 | trn acc:63.7, f1:45.5, auc:63.5 | loss:0.094
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:61.0, f1:49.5, auc:65.6 | trn acc:64.4, f1:46.2, auc:64.3 | loss:0.093
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:60.8, f1:49.4, auc:65.0 | trn acc:65.2, f1:46.4, auc:65.4 | loss:0.092
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:59.6, f1:46.5, auc:63.2 | trn acc:66.0, f1:47.0, auc:66.1 | loss:0.090
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:64.2, f1:49.7, auc:66.1 | trn acc:66.9, f1:47.6, auc:67.1 | loss:0.087
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:64.4, f1:50.9, auc:69.8 | trn acc:67.7, f1:48.3, auc:68.1 | loss:0.085
Epoch 19 finished in 4.15 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:64.2, f1:50.0, auc:70.6 | trn acc:68.7, f1:48.9, auc:69.3 | loss:0.083
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:63.0, f1:48.6, auc:68.4 | trn acc:69.7, f1:49.8, auc:70.1 | loss:0.081
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:66.7, f1:51.3, auc:72.5 | trn acc:71.0, f1:50.6, auc:71.5 | loss:0.079
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:65.7, f1:50.3, auc:72.9 | trn acc:71.7, f1:51.6, auc:72.4 | loss:0.077
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:66.1, f1:49.1, auc:71.4 | trn acc:73.1, f1:52.7, auc:73.8 | loss:0.074
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:63.4, f1:43.6, auc:70.6 | trn acc:73.6, f1:53.5, auc:74.5 | loss:0.073
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.94 seconds
[30,200] | tst acc:66.7, f1:46.7, auc:74.5 | trn acc:74.9, f1:54.4, auc:75.8 | loss:0.071
Epoch 30 finished in 4.19 seconds
[31,548] | tst acc:68.7, f1:52.5, auc:73.1 | trn acc:75.1, f1:55.1, auc:76.3 | loss:0.070
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:68.3, f1:51.9, auc:75.1 | trn acc:76.2, f1:56.0, auc:77.3 | loss:0.068
Epoch 33 finished in 4.15 seconds
[34,568] | tst acc:68.7, f1:52.3, auc:77.0 | trn acc:76.6, f1:56.6, auc:78.1 | loss:0.067
Epoch 34 finished in 4.19 seconds
Epoch 35 finished in 3.94 seconds
[36,240] | tst acc:66.5, f1:47.2, auc:75.8 | trn acc:77.0, f1:57.3, auc:78.7 | loss:0.066
Epoch 36 finished in 4.19 seconds
[37,588] | tst acc:67.5, f1:49.8, auc:75.9 | trn acc:77.6, f1:58.2, auc:79.6 | loss:0.064
Epoch 37 finished in 4.15 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:69.3, f1:52.4, auc:78.2 | trn acc:77.8, f1:58.2, auc:79.9 | loss:0.063
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:68.9, f1:51.2, auc:78.6 | trn acc:78.2, f1:59.0, auc:80.5 | loss:0.062
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:69.7, f1:53.9, auc:77.0 | trn acc:78.3, f1:59.1, auc:80.9 | loss:0.061
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:68.9, f1:50.9, auc:77.7 | trn acc:78.6, f1:59.2, auc:81.2 | loss:0.061
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:68.5, f1:50.0, auc:79.0 | trn acc:78.9, f1:59.8, auc:81.7 | loss:0.060
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:67.5, f1:47.6, auc:79.2 | trn acc:78.9, f1:60.0, auc:82.1 | loss:0.059
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:70.9, f1:54.3, auc:78.7 | trn acc:79.3, f1:60.7, auc:82.4 | loss:0.059
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:69.1, f1:50.8, auc:79.6 | trn acc:79.2, f1:60.3, auc:82.6 | loss:0.058
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:69.5, f1:50.5, auc:78.2 | trn acc:79.3, f1:60.5, auc:82.8 | loss:0.058
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:69.3, f1:50.6, auc:79.3 | trn acc:79.7, f1:61.4, auc:83.2 | loss:0.057
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:67.7, f1:47.1, auc:80.0 | trn acc:79.5, f1:61.2, auc:83.1 | loss:0.057
Epoch 54 finished in 4.19 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:68.3, f1:49.8, auc:80.6 | trn acc:79.9, f1:61.7, auc:83.5 | loss:0.056
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:69.9, f1:51.7, auc:79.8 | trn acc:79.9, f1:61.5, auc:83.7 | loss:0.056
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:70.3, f1:53.0, auc:81.1 | trn acc:79.9, f1:61.8, auc:83.8 | loss:0.056
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:70.9, f1:52.6, auc:81.3 | trn acc:80.2, f1:61.8, auc:83.8 | loss:0.056
Epoch 60 finished in 4.19 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:70.5, f1:52.8, auc:81.9 | trn acc:80.1, f1:62.1, auc:83.9 | loss:0.056
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:71.9, f1:55.5, auc:80.2 | trn acc:80.0, f1:62.1, auc:84.0 | loss:0.056
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:69.7, f1:52.2, auc:80.8 | trn acc:80.3, f1:62.5, auc:84.3 | loss:0.055
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:72.6, f1:56.4, auc:82.0 | trn acc:79.9, f1:62.1, auc:83.9 | loss:0.056
Epoch 66 finished in 4.19 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:70.9, f1:53.2, auc:81.0 | trn acc:80.5, f1:62.7, auc:84.3 | loss:0.055
Epoch 68 finished in 4.19 seconds
[69,460] | tst acc:71.5, f1:55.9, auc:81.2 | trn acc:80.3, f1:62.5, auc:84.3 | loss:0.055
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:70.7, f1:54.2, auc:80.9 | trn acc:80.1, f1:62.4, auc:84.2 | loss:0.056
Average epoch runtime: 4.05 seconds
Total training time: 291.49 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.4, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.4000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:48.8, f1:36.3, auc:48.8 | trn acc:48.9, f1:46.7, auc:51.0 | loss:2.279
Epoch 0 finished in 4.14 seconds
[1,348] | tst acc:57.3, f1:41.7, auc:59.3 | trn acc:52.1, f1:40.0, auc:52.4 | loss:1.833
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:60.6, f1:41.3, auc:59.6 | trn acc:58.8, f1:42.7, auc:57.3 | loss:0.723
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:56.3, f1:40.0, auc:57.5 | trn acc:60.8, f1:44.0, auc:59.8 | loss:0.106
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:66.2, f1:50.0, auc:68.5 | trn acc:61.5, f1:44.5, auc:60.5 | loss:0.104
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:66.7, f1:47.4, auc:66.5 | trn acc:61.7, f1:44.7, auc:60.9 | loss:0.101
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:64.8, f1:45.3, auc:66.0 | trn acc:61.8, f1:44.8, auc:61.3 | loss:0.101
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:65.3, f1:47.5, auc:68.2 | trn acc:62.3, f1:45.0, auc:61.9 | loss:0.098
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:66.0, f1:46.5, auc:65.4 | trn acc:63.0, f1:45.3, auc:62.9 | loss:0.097
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:62.2, f1:43.5, auc:65.6 | trn acc:63.7, f1:45.8, auc:63.8 | loss:0.093
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:67.6, f1:48.5, auc:69.4 | trn acc:64.2, f1:46.1, auc:64.2 | loss:0.092
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:62.4, f1:41.2, auc:64.9 | trn acc:65.0, f1:46.7, auc:65.2 | loss:0.091
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:69.0, f1:45.0, auc:70.2 | trn acc:66.1, f1:47.5, auc:66.3 | loss:0.088
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:68.1, f1:46.5, auc:68.9 | trn acc:67.2, f1:47.7, auc:67.4 | loss:0.087
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:69.7, f1:49.0, auc:70.5 | trn acc:67.8, f1:48.5, auc:68.1 | loss:0.084
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:67.8, f1:45.8, auc:70.9 | trn acc:69.0, f1:49.6, auc:69.5 | loss:0.082
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:74.6, f1:53.0, auc:75.4 | trn acc:70.2, f1:50.2, auc:70.6 | loss:0.080
Epoch 24 finished in 4.22 seconds
[25,508] | tst acc:73.9, f1:53.6, auc:77.7 | trn acc:71.1, f1:51.3, auc:71.9 | loss:0.078
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:74.9, f1:52.4, auc:77.0 | trn acc:72.4, f1:52.0, auc:72.9 | loss:0.076
Epoch 27 finished in 4.17 seconds
[28,528] | tst acc:76.5, f1:54.5, auc:76.6 | trn acc:73.2, f1:53.1, auc:74.0 | loss:0.074
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:76.3, f1:51.7, auc:82.1 | trn acc:74.3, f1:54.0, auc:75.3 | loss:0.072
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:80.8, f1:63.4, auc:79.9 | trn acc:75.1, f1:55.2, auc:76.4 | loss:0.070
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:79.1, f1:59.0, auc:81.3 | trn acc:76.0, f1:56.0, auc:77.1 | loss:0.069
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:78.4, f1:57.0, auc:79.8 | trn acc:76.2, f1:56.3, auc:77.9 | loss:0.067
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:77.9, f1:55.2, auc:80.8 | trn acc:76.9, f1:57.2, auc:78.6 | loss:0.066
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:80.0, f1:60.5, auc:81.5 | trn acc:77.5, f1:57.9, auc:79.5 | loss:0.064
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:78.2, f1:57.1, auc:81.4 | trn acc:77.6, f1:58.2, auc:79.7 | loss:0.064
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:80.8, f1:60.6, auc:83.9 | trn acc:77.9, f1:58.7, auc:80.5 | loss:0.062
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.97 seconds
[42,280] | tst acc:80.8, f1:61.3, auc:84.1 | trn acc:78.3, f1:58.8, auc:80.7 | loss:0.061
Epoch 42 finished in 4.22 seconds
[43,628] | tst acc:81.5, f1:62.9, auc:84.7 | trn acc:78.3, f1:59.5, auc:81.3 | loss:0.061
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:81.0, f1:60.9, auc:83.8 | trn acc:78.9, f1:60.1, auc:81.8 | loss:0.060
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:80.0, f1:58.5, auc:83.4 | trn acc:78.7, f1:59.9, auc:81.9 | loss:0.060
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:82.2, f1:63.5, auc:84.8 | trn acc:79.2, f1:60.7, auc:82.6 | loss:0.059
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:80.8, f1:60.2, auc:85.2 | trn acc:79.0, f1:60.1, auc:82.4 | loss:0.059
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.01 seconds
[51,340] | tst acc:80.0, f1:56.4, auc:84.9 | trn acc:79.2, f1:60.7, auc:82.7 | loss:0.058
Epoch 51 finished in 4.17 seconds
Epoch 52 finished in 4.01 seconds
[53,12] | tst acc:83.8, f1:65.7, auc:86.7 | trn acc:79.6, f1:61.4, auc:83.3 | loss:0.057
Epoch 53 finished in 4.18 seconds
[54,360] | tst acc:81.5, f1:59.9, auc:86.4 | trn acc:79.7, f1:61.6, auc:83.3 | loss:0.057
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:80.3, f1:58.8, auc:84.9 | trn acc:79.7, f1:61.7, auc:83.5 | loss:0.057
Epoch 56 finished in 4.22 seconds
[57,380] | tst acc:81.0, f1:60.5, auc:86.7 | trn acc:79.7, f1:61.7, auc:83.5 | loss:0.057
Epoch 57 finished in 4.17 seconds
Epoch 58 finished in 4.01 seconds
[59,52] | tst acc:82.4, f1:63.4, auc:86.2 | trn acc:79.8, f1:61.7, auc:83.7 | loss:0.056
Epoch 59 finished in 4.18 seconds
[60,400] | tst acc:81.0, f1:59.7, auc:86.7 | trn acc:79.9, f1:62.0, auc:83.8 | loss:0.056
Epoch 60 finished in 4.22 seconds
Epoch 61 finished in 3.96 seconds
[62,72] | tst acc:83.8, f1:66.0, auc:85.7 | trn acc:80.1, f1:62.3, auc:84.2 | loss:0.056
Epoch 62 finished in 4.21 seconds
[63,420] | tst acc:83.3, f1:65.0, auc:87.5 | trn acc:80.1, f1:62.3, auc:84.1 | loss:0.056
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 4.01 seconds
[65,92] | tst acc:82.2, f1:63.1, auc:86.5 | trn acc:80.0, f1:62.4, auc:84.2 | loss:0.056
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:83.8, f1:66.3, auc:87.8 | trn acc:80.3, f1:62.6, auc:84.3 | loss:0.055
Epoch 66 finished in 4.22 seconds
Epoch 67 finished in 3.97 seconds
[68,112] | tst acc:81.2, f1:60.4, auc:87.4 | trn acc:79.8, f1:62.2, auc:84.0 | loss:0.056
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:81.5, f1:62.6, auc:86.7 | trn acc:80.3, f1:62.6, auc:84.3 | loss:0.055
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:80.8, f1:59.4, auc:87.1 | trn acc:80.2, f1:62.4, auc:84.2 | loss:0.056
Average epoch runtime: 4.06 seconds
Total training time: 292.55 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.4, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.4000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:52.5, f1:41.8, auc:53.7 | trn acc:49.0, f1:45.0, auc:49.0 | loss:2.452
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:54.2, f1:41.8, auc:56.3 | trn acc:52.1, f1:39.4, auc:52.3 | loss:1.835
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 3.99 seconds
[3,20] | tst acc:57.5, f1:39.0, auc:54.7 | trn acc:59.0, f1:42.4, auc:57.6 | loss:0.717
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:57.7, f1:43.4, auc:56.1 | trn acc:60.9, f1:43.2, auc:59.6 | loss:0.105
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:61.1, f1:41.9, auc:58.4 | trn acc:61.3, f1:43.7, auc:60.1 | loss:0.103
Epoch 6 finished in 4.20 seconds
[7,388] | tst acc:63.7, f1:45.8, auc:59.3 | trn acc:61.7, f1:44.2, auc:60.6 | loss:0.101
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:62.9, f1:45.2, auc:63.5 | trn acc:62.1, f1:44.2, auc:61.3 | loss:0.100
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:64.8, f1:46.9, auc:63.0 | trn acc:62.4, f1:44.2, auc:61.9 | loss:0.098
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:63.3, f1:43.7, auc:62.5 | trn acc:63.1, f1:44.9, auc:62.9 | loss:0.093
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:61.1, f1:43.0, auc:62.1 | trn acc:63.8, f1:45.5, auc:63.8 | loss:0.092
Epoch 13 finished in 4.15 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:64.4, f1:46.6, auc:63.5 | trn acc:64.4, f1:45.7, auc:64.6 | loss:0.092
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:66.1, f1:47.5, auc:63.9 | trn acc:65.4, f1:46.4, auc:65.5 | loss:0.089
Epoch 16 finished in 4.21 seconds
Epoch 17 finished in 3.94 seconds
[18,120] | tst acc:70.0, f1:49.8, auc:66.8 | trn acc:66.3, f1:46.9, auc:66.5 | loss:0.088
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:64.8, f1:45.8, auc:64.9 | trn acc:67.1, f1:47.4, auc:67.3 | loss:0.087
Epoch 19 finished in 4.15 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:65.2, f1:44.3, auc:64.1 | trn acc:68.2, f1:48.7, auc:68.8 | loss:0.083
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:64.8, f1:44.4, auc:66.5 | trn acc:69.2, f1:49.2, auc:69.6 | loss:0.081
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.94 seconds
[24,160] | tst acc:71.5, f1:51.8, auc:70.4 | trn acc:70.3, f1:50.2, auc:71.0 | loss:0.079
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:68.7, f1:47.3, auc:71.6 | trn acc:71.6, f1:51.4, auc:72.1 | loss:0.078
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:71.7, f1:50.6, auc:72.0 | trn acc:72.6, f1:52.3, auc:73.5 | loss:0.075
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:71.1, f1:48.1, auc:71.2 | trn acc:73.5, f1:53.0, auc:74.3 | loss:0.073
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:71.5, f1:48.4, auc:70.9 | trn acc:74.5, f1:54.3, auc:75.5 | loss:0.072
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:73.2, f1:51.6, auc:75.5 | trn acc:75.4, f1:55.2, auc:76.5 | loss:0.069
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:74.1, f1:52.4, auc:76.8 | trn acc:75.9, f1:55.5, auc:77.1 | loss:0.069
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:75.4, f1:54.0, auc:76.5 | trn acc:76.6, f1:56.5, auc:78.1 | loss:0.067
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:77.5, f1:56.7, auc:79.7 | trn acc:77.2, f1:57.4, auc:78.8 | loss:0.065
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:76.9, f1:58.0, auc:75.2 | trn acc:77.6, f1:57.5, auc:79.4 | loss:0.064
Epoch 37 finished in 4.15 seconds
Epoch 38 finished in 4.00 seconds
[39,260] | tst acc:72.4, f1:49.2, auc:77.6 | trn acc:77.9, f1:57.9, auc:79.8 | loss:0.063
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:72.4, f1:48.0, auc:76.4 | trn acc:78.0, f1:58.4, auc:80.3 | loss:0.063
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:76.5, f1:56.6, auc:78.7 | trn acc:78.2, f1:58.5, auc:80.6 | loss:0.062
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:74.3, f1:50.2, auc:79.6 | trn acc:78.6, f1:59.0, auc:81.2 | loss:0.061
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:75.6, f1:54.6, auc:79.1 | trn acc:78.6, f1:59.2, auc:81.4 | loss:0.060
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:74.7, f1:52.6, auc:79.3 | trn acc:79.0, f1:59.6, auc:81.9 | loss:0.059
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:75.6, f1:52.7, auc:78.0 | trn acc:79.1, f1:59.7, auc:82.0 | loss:0.059
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:76.5, f1:55.1, auc:79.1 | trn acc:79.3, f1:60.2, auc:82.6 | loss:0.058
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:76.9, f1:54.9, auc:79.2 | trn acc:79.4, f1:60.6, auc:82.7 | loss:0.058
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:76.7, f1:55.0, auc:80.5 | trn acc:79.7, f1:60.7, auc:83.1 | loss:0.057
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:76.2, f1:52.2, auc:79.0 | trn acc:79.7, f1:61.0, auc:83.3 | loss:0.057
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:77.5, f1:57.4, auc:79.8 | trn acc:79.8, f1:60.9, auc:83.3 | loss:0.057
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:74.7, f1:52.2, auc:80.3 | trn acc:79.9, f1:61.5, auc:83.6 | loss:0.056
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:76.0, f1:54.7, auc:81.4 | trn acc:79.8, f1:61.1, auc:83.6 | loss:0.056
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:76.2, f1:53.0, auc:81.3 | trn acc:80.0, f1:61.6, auc:83.8 | loss:0.056
Epoch 60 finished in 4.21 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:77.5, f1:56.3, auc:81.9 | trn acc:80.0, f1:61.4, auc:83.8 | loss:0.056
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:75.4, f1:52.9, auc:80.7 | trn acc:80.2, f1:62.1, auc:84.1 | loss:0.056
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:76.9, f1:56.0, auc:81.2 | trn acc:80.2, f1:61.8, auc:84.0 | loss:0.056
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:76.5, f1:53.6, auc:80.1 | trn acc:80.3, f1:61.9, auc:84.1 | loss:0.055
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:76.9, f1:54.1, auc:80.9 | trn acc:80.4, f1:62.1, auc:84.3 | loss:0.055
Epoch 68 finished in 4.21 seconds
[69,460] | tst acc:77.8, f1:57.3, auc:81.1 | trn acc:80.2, f1:61.8, auc:84.2 | loss:0.055
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:76.2, f1:54.2, auc:81.4 | trn acc:80.2, f1:62.0, auc:84.2 | loss:0.055
Average epoch runtime: 4.05 seconds
Total training time: 291.70 GPU seconds
alpha = 0.5
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.5, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.5000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:50.0, f1:54.1, auc:50.8 | trn acc:50.4, f1:42.5, auc:52.8 | loss:2.185
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:51.6, f1:55.1, auc:54.3 | trn acc:52.0, f1:40.5, auc:52.7 | loss:1.735
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:55.4, f1:56.3, auc:58.9 | trn acc:57.9, f1:44.4, auc:58.1 | loss:0.772
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:53.8, f1:55.1, auc:58.4 | trn acc:59.7, f1:45.5, auc:60.3 | loss:0.098
Epoch 4 finished in 4.20 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:56.2, f1:56.2, auc:60.2 | trn acc:60.1, f1:45.9, auc:60.8 | loss:0.099
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:60.2, f1:59.1, auc:65.0 | trn acc:60.5, f1:46.0, auc:61.4 | loss:0.094
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:57.2, f1:56.1, auc:63.7 | trn acc:60.6, f1:46.6, auc:61.7 | loss:0.096
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:56.8, f1:56.2, auc:66.3 | trn acc:61.2, f1:46.6, auc:62.4 | loss:0.092
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:58.8, f1:58.4, auc:63.4 | trn acc:61.8, f1:47.2, auc:63.2 | loss:0.092
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:59.6, f1:58.7, auc:65.4 | trn acc:62.1, f1:47.4, auc:63.7 | loss:0.091
Epoch 13 finished in 4.15 seconds
Epoch 14 finished in 4.00 seconds
[15,100] | tst acc:59.4, f1:58.4, auc:66.1 | trn acc:62.9, f1:47.7, auc:64.6 | loss:0.088
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:53.0, f1:51.2, auc:60.1 | trn acc:63.6, f1:48.4, auc:65.3 | loss:0.089
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:55.2, f1:51.8, auc:64.9 | trn acc:64.2, f1:49.4, auc:65.9 | loss:0.087
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:55.2, f1:53.8, auc:62.4 | trn acc:65.2, f1:49.9, auc:67.0 | loss:0.085
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:59.0, f1:57.5, auc:68.6 | trn acc:66.3, f1:50.6, auc:68.1 | loss:0.083
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:59.0, f1:56.6, auc:67.4 | trn acc:67.0, f1:51.5, auc:68.9 | loss:0.083
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:60.8, f1:57.3, auc:72.0 | trn acc:68.3, f1:52.2, auc:70.3 | loss:0.081
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:61.4, f1:58.4, auc:71.7 | trn acc:69.4, f1:53.9, auc:71.4 | loss:0.079
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:59.0, f1:53.6, auc:74.1 | trn acc:70.8, f1:54.6, auc:72.7 | loss:0.077
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:59.8, f1:54.5, auc:74.8 | trn acc:71.9, f1:55.9, auc:73.9 | loss:0.075
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:58.8, f1:53.1, auc:73.3 | trn acc:72.8, f1:56.8, auc:74.9 | loss:0.074
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:64.9, f1:60.1, auc:77.5 | trn acc:74.3, f1:58.8, auc:76.4 | loss:0.072
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:64.3, f1:59.7, auc:76.8 | trn acc:74.9, f1:58.9, auc:76.9 | loss:0.071
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:61.8, f1:56.6, auc:75.4 | trn acc:76.0, f1:60.4, auc:78.4 | loss:0.069
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:63.5, f1:57.1, auc:79.2 | trn acc:76.3, f1:60.8, auc:78.6 | loss:0.068
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:62.4, f1:56.4, auc:78.4 | trn acc:77.2, f1:61.7, auc:79.4 | loss:0.067
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:62.9, f1:57.5, auc:74.9 | trn acc:77.5, f1:62.3, auc:80.0 | loss:0.066
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:64.1, f1:58.3, auc:79.4 | trn acc:78.0, f1:62.7, auc:80.5 | loss:0.065
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:63.7, f1:58.6, auc:78.2 | trn acc:78.4, f1:63.4, auc:81.2 | loss:0.064
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:63.7, f1:57.8, auc:79.5 | trn acc:78.8, f1:63.9, auc:81.5 | loss:0.063
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 4.00 seconds
[45,300] | tst acc:63.5, f1:58.3, auc:79.5 | trn acc:78.8, f1:64.0, auc:81.7 | loss:0.063
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:64.3, f1:58.6, auc:81.6 | trn acc:79.2, f1:64.3, auc:82.1 | loss:0.062
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:64.1, f1:57.7, auc:80.3 | trn acc:79.2, f1:64.3, auc:82.3 | loss:0.062
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:63.7, f1:57.0, auc:81.1 | trn acc:79.6, f1:65.1, auc:83.0 | loss:0.061
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:64.1, f1:57.3, auc:81.2 | trn acc:79.9, f1:65.7, auc:83.3 | loss:0.060
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:63.5, f1:56.7, auc:80.7 | trn acc:79.8, f1:65.3, auc:83.1 | loss:0.060
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:63.9, f1:56.9, auc:80.0 | trn acc:80.0, f1:65.8, auc:83.5 | loss:0.060
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:64.5, f1:58.2, auc:82.4 | trn acc:80.2, f1:65.9, auc:83.6 | loss:0.059
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:64.1, f1:58.1, auc:80.8 | trn acc:80.2, f1:66.1, auc:83.7 | loss:0.059
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:63.7, f1:57.6, auc:80.1 | trn acc:80.4, f1:66.2, auc:84.1 | loss:0.059
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:63.7, f1:57.0, auc:80.7 | trn acc:80.5, f1:66.4, auc:84.1 | loss:0.059
Epoch 60 finished in 4.21 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:64.7, f1:58.3, auc:80.5 | trn acc:80.4, f1:66.4, auc:84.2 | loss:0.059
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:63.1, f1:55.8, auc:81.5 | trn acc:80.6, f1:66.6, auc:84.4 | loss:0.058
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:64.7, f1:58.9, auc:82.8 | trn acc:80.8, f1:66.8, auc:84.4 | loss:0.058
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:63.3, f1:55.9, auc:82.2 | trn acc:80.4, f1:66.7, auc:84.2 | loss:0.059
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:63.9, f1:56.5, auc:80.8 | trn acc:80.8, f1:66.9, auc:84.5 | loss:0.058
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:65.9, f1:60.1, auc:84.2 | trn acc:80.8, f1:66.8, auc:84.4 | loss:0.058
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:64.1, f1:57.7, auc:81.4 | trn acc:80.6, f1:66.8, auc:84.6 | loss:0.058
Average epoch runtime: 4.05 seconds
Total training time: 291.83 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.5, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.5000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:51.1, f1:35.3, auc:55.3 | trn acc:48.6, f1:40.7, auc:50.2 | loss:2.268
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:55.4, f1:38.5, auc:61.7 | trn acc:51.8, f1:40.8, auc:52.5 | loss:1.746
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 3.99 seconds
[3,20] | tst acc:60.4, f1:40.2, auc:63.5 | trn acc:57.8, f1:44.3, auc:58.2 | loss:0.800
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:58.3, f1:38.3, auc:61.0 | trn acc:59.7, f1:45.9, auc:60.6 | loss:0.100
Epoch 4 finished in 4.20 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:63.9, f1:44.3, auc:69.0 | trn acc:60.1, f1:46.0, auc:61.1 | loss:0.097
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:65.1, f1:44.4, auc:66.1 | trn acc:60.6, f1:46.5, auc:61.5 | loss:0.098
Epoch 7 finished in 4.15 seconds
Epoch 8 finished in 4.00 seconds
[9,60] | tst acc:64.5, f1:45.1, auc:65.9 | trn acc:60.8, f1:46.6, auc:61.9 | loss:0.097
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:67.4, f1:48.5, auc:70.1 | trn acc:61.1, f1:46.4, auc:62.5 | loss:0.093
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:65.9, f1:45.4, auc:65.8 | trn acc:61.8, f1:47.5, auc:63.3 | loss:0.093
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:68.8, f1:51.9, auc:75.5 | trn acc:62.2, f1:47.6, auc:63.8 | loss:0.093
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:64.9, f1:45.0, auc:70.0 | trn acc:62.8, f1:47.8, auc:64.3 | loss:0.088
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:67.8, f1:47.5, auc:69.5 | trn acc:63.7, f1:48.3, auc:65.4 | loss:0.088
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:67.4, f1:43.8, auc:65.5 | trn acc:64.5, f1:49.5, auc:66.1 | loss:0.087
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:68.2, f1:47.5, auc:70.1 | trn acc:65.1, f1:50.0, auc:66.9 | loss:0.085
Epoch 19 finished in 4.15 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:70.2, f1:52.5, auc:75.0 | trn acc:66.3, f1:50.5, auc:68.0 | loss:0.084
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:68.0, f1:45.8, auc:70.3 | trn acc:67.1, f1:51.6, auc:69.0 | loss:0.083
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:73.5, f1:53.4, auc:74.8 | trn acc:68.3, f1:52.6, auc:70.3 | loss:0.080
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:72.5, f1:53.5, auc:77.6 | trn acc:69.7, f1:53.8, auc:71.6 | loss:0.079
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:72.1, f1:49.3, auc:74.4 | trn acc:70.8, f1:54.8, auc:72.8 | loss:0.077
Epoch 27 finished in 4.15 seconds
[28,528] | tst acc:77.6, f1:57.9, auc:79.4 | trn acc:71.7, f1:55.5, auc:73.6 | loss:0.075
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:75.4, f1:53.8, auc:77.3 | trn acc:73.1, f1:57.3, auc:75.2 | loss:0.074
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:78.4, f1:58.8, auc:77.2 | trn acc:73.8, f1:57.8, auc:75.9 | loss:0.073
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:79.3, f1:60.1, auc:79.5 | trn acc:75.1, f1:59.4, auc:77.2 | loss:0.070
Epoch 33 finished in 4.15 seconds
[34,568] | tst acc:78.4, f1:59.1, auc:79.7 | trn acc:75.7, f1:60.0, auc:77.8 | loss:0.070
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:79.9, f1:59.8, auc:79.2 | trn acc:76.5, f1:61.0, auc:78.6 | loss:0.068
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:79.3, f1:61.0, auc:81.5 | trn acc:76.9, f1:61.6, auc:79.3 | loss:0.067
Epoch 37 finished in 4.15 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:80.9, f1:64.9, auc:83.0 | trn acc:77.5, f1:62.3, auc:79.9 | loss:0.066
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:79.5, f1:60.3, auc:82.4 | trn acc:78.0, f1:63.0, auc:80.4 | loss:0.065
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:80.7, f1:63.0, auc:81.2 | trn acc:78.3, f1:63.0, auc:80.8 | loss:0.065
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:79.5, f1:59.7, auc:81.6 | trn acc:78.5, f1:63.8, auc:81.2 | loss:0.064
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:81.5, f1:64.3, auc:81.7 | trn acc:78.7, f1:64.0, auc:81.7 | loss:0.063
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:79.5, f1:59.3, auc:82.7 | trn acc:78.9, f1:64.2, auc:81.8 | loss:0.063
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:85.0, f1:68.9, auc:84.1 | trn acc:79.5, f1:64.9, auc:82.7 | loss:0.061
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:82.1, f1:64.5, auc:84.4 | trn acc:79.0, f1:64.6, auc:82.3 | loss:0.062
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:82.1, f1:64.2, auc:84.2 | trn acc:79.5, f1:65.2, auc:82.7 | loss:0.061
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:83.4, f1:65.8, auc:85.5 | trn acc:79.9, f1:65.7, auc:83.3 | loss:0.060
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:82.3, f1:63.9, auc:84.8 | trn acc:79.7, f1:65.5, auc:83.1 | loss:0.060
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:82.8, f1:65.9, auc:85.2 | trn acc:80.0, f1:66.1, auc:83.6 | loss:0.060
Epoch 56 finished in 4.21 seconds
[57,380] | tst acc:82.3, f1:65.3, auc:84.8 | trn acc:80.1, f1:65.9, auc:83.6 | loss:0.059
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:83.0, f1:66.4, auc:85.8 | trn acc:80.2, f1:66.4, auc:83.9 | loss:0.059
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:83.2, f1:65.8, auc:85.5 | trn acc:80.0, f1:66.0, auc:83.7 | loss:0.059
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:80.7, f1:62.1, auc:85.8 | trn acc:80.5, f1:66.9, auc:84.2 | loss:0.059
Epoch 62 finished in 4.21 seconds
[63,420] | tst acc:83.2, f1:66.4, auc:87.5 | trn acc:80.3, f1:66.5, auc:84.0 | loss:0.059
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:84.4, f1:68.1, auc:86.5 | trn acc:80.2, f1:66.4, auc:84.1 | loss:0.059
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:83.6, f1:66.9, auc:86.6 | trn acc:80.7, f1:66.8, auc:84.2 | loss:0.058
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:82.5, f1:64.4, auc:85.0 | trn acc:80.3, f1:66.7, auc:84.2 | loss:0.059
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:82.5, f1:65.9, auc:87.1 | trn acc:80.5, f1:66.8, auc:84.3 | loss:0.058
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:83.0, f1:66.1, auc:86.2 | trn acc:80.6, f1:66.8, auc:84.4 | loss:0.058
Average epoch runtime: 4.05 seconds
Total training time: 291.77 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.5, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.5000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:50.0, f1:55.6, auc:50.0 | trn acc:47.4, f1:33.8, auc:48.9 | loss:2.283
Epoch 0 finished in 4.17 seconds
[1,348] | tst acc:52.9, f1:57.4, auc:55.1 | trn acc:51.7, f1:39.7, auc:52.3 | loss:1.742
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 3.99 seconds
[3,20] | tst acc:55.3, f1:55.6, auc:60.0 | trn acc:57.9, f1:43.7, auc:57.9 | loss:0.769
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:53.1, f1:55.7, auc:56.7 | trn acc:59.4, f1:44.6, auc:59.8 | loss:0.099
Epoch 4 finished in 4.20 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:57.3, f1:58.0, auc:62.6 | trn acc:59.7, f1:44.8, auc:60.2 | loss:0.098
Epoch 6 finished in 4.20 seconds
[7,388] | tst acc:57.3, f1:57.8, auc:64.0 | trn acc:60.3, f1:45.1, auc:61.1 | loss:0.096
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:55.9, f1:57.4, auc:61.5 | trn acc:60.5, f1:45.6, auc:61.6 | loss:0.097
Epoch 9 finished in 4.15 seconds
[10,408] | tst acc:60.1, f1:61.1, auc:63.7 | trn acc:60.9, f1:45.7, auc:61.9 | loss:0.095
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:57.9, f1:58.7, auc:63.0 | trn acc:61.8, f1:46.5, auc:63.1 | loss:0.091
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:55.5, f1:56.1, auc:62.3 | trn acc:62.0, f1:46.6, auc:63.4 | loss:0.090
Epoch 13 finished in 4.15 seconds
Epoch 14 finished in 4.00 seconds
[15,100] | tst acc:56.2, f1:57.0, auc:63.3 | trn acc:62.8, f1:47.2, auc:64.4 | loss:0.090
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:55.9, f1:55.6, auc:62.9 | trn acc:63.7, f1:47.6, auc:65.3 | loss:0.089
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:55.5, f1:53.5, auc:61.3 | trn acc:64.2, f1:48.4, auc:65.8 | loss:0.086
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:60.1, f1:58.8, auc:67.7 | trn acc:65.0, f1:48.7, auc:66.7 | loss:0.085
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:61.0, f1:60.2, auc:65.8 | trn acc:66.2, f1:50.1, auc:68.0 | loss:0.083
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:57.7, f1:56.4, auc:66.0 | trn acc:67.1, f1:50.5, auc:69.0 | loss:0.082
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:59.9, f1:56.9, auc:69.2 | trn acc:68.2, f1:51.7, auc:70.1 | loss:0.080
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:60.1, f1:56.8, auc:69.6 | trn acc:69.4, f1:52.7, auc:71.3 | loss:0.078
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:54.8, f1:50.8, auc:66.5 | trn acc:70.8, f1:53.8, auc:72.6 | loss:0.077
Epoch 27 finished in 4.15 seconds
[28,528] | tst acc:58.1, f1:54.3, auc:69.6 | trn acc:71.8, f1:55.2, auc:73.6 | loss:0.075
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:59.3, f1:54.3, auc:69.8 | trn acc:73.0, f1:56.2, auc:75.0 | loss:0.074
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:61.5, f1:56.8, auc:74.4 | trn acc:74.0, f1:57.3, auc:75.8 | loss:0.072
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:64.8, f1:61.0, auc:75.3 | trn acc:75.2, f1:58.4, auc:77.1 | loss:0.070
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:61.0, f1:56.7, auc:71.6 | trn acc:76.0, f1:59.4, auc:77.9 | loss:0.069
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.94 seconds
[36,240] | tst acc:62.1, f1:56.8, auc:74.8 | trn acc:76.7, f1:60.2, auc:78.7 | loss:0.068
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:61.9, f1:57.1, auc:74.8 | trn acc:77.2, f1:61.1, auc:79.5 | loss:0.067
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:62.6, f1:57.7, auc:73.6 | trn acc:77.8, f1:61.7, auc:79.9 | loss:0.066
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:63.4, f1:58.9, auc:75.4 | trn acc:78.2, f1:62.1, auc:80.4 | loss:0.065
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:63.7, f1:59.1, auc:76.3 | trn acc:78.7, f1:62.8, auc:81.2 | loss:0.063
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:63.9, f1:59.2, auc:77.9 | trn acc:78.7, f1:63.0, auc:81.2 | loss:0.064
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:63.9, f1:58.8, auc:79.9 | trn acc:79.1, f1:63.3, auc:81.8 | loss:0.062
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:61.5, f1:55.9, auc:76.8 | trn acc:79.1, f1:63.5, auc:81.9 | loss:0.062
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:61.7, f1:55.4, auc:78.0 | trn acc:79.4, f1:64.1, auc:82.4 | loss:0.061
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:62.3, f1:56.7, auc:77.5 | trn acc:79.7, f1:64.3, auc:82.7 | loss:0.061
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:63.4, f1:57.4, auc:78.4 | trn acc:80.0, f1:64.6, auc:83.0 | loss:0.060
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:63.4, f1:57.4, auc:80.2 | trn acc:79.8, f1:64.6, auc:82.9 | loss:0.060
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:63.0, f1:56.7, auc:78.6 | trn acc:80.1, f1:64.8, auc:83.1 | loss:0.060
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:63.7, f1:58.6, auc:80.9 | trn acc:80.3, f1:65.7, auc:83.8 | loss:0.059
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:62.6, f1:56.4, auc:79.2 | trn acc:80.3, f1:65.2, auc:83.7 | loss:0.059
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:63.0, f1:57.4, auc:83.3 | trn acc:80.4, f1:65.6, auc:83.8 | loss:0.059
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:63.9, f1:57.9, auc:82.0 | trn acc:80.4, f1:65.5, auc:83.9 | loss:0.059
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:64.1, f1:59.1, auc:81.7 | trn acc:80.5, f1:65.6, auc:83.9 | loss:0.058
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:62.3, f1:55.8, auc:82.6 | trn acc:80.5, f1:65.8, auc:84.2 | loss:0.058
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:63.4, f1:57.7, auc:80.2 | trn acc:81.0, f1:66.1, auc:84.4 | loss:0.057
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:63.7, f1:57.6, auc:83.6 | trn acc:80.7, f1:65.8, auc:84.2 | loss:0.058
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:62.8, f1:56.3, auc:81.8 | trn acc:80.7, f1:66.0, auc:84.3 | loss:0.058
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:63.4, f1:58.5, auc:83.2 | trn acc:80.9, f1:66.2, auc:84.5 | loss:0.057
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:61.9, f1:55.5, auc:80.3 | trn acc:80.6, f1:65.9, auc:84.1 | loss:0.058
Average epoch runtime: 4.05 seconds
Total training time: 291.72 GPU seconds
alpha = 0.6
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.6, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.6000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.2, f1:47.7, auc:48.7 | trn acc:49.2, f1:34.2, auc:51.0 | loss:2.018
Epoch 0 finished in 4.14 seconds
[1,348] | tst acc:45.8, f1:47.3, auc:47.7 | trn acc:51.4, f1:41.2, auc:52.5 | loss:1.641
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 3.99 seconds
[3,20] | tst acc:52.5, f1:53.8, auc:55.5 | trn acc:56.4, f1:45.0, auc:58.5 | loss:0.844
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:55.4, f1:54.9, auc:51.9 | trn acc:58.6, f1:47.2, auc:60.5 | loss:0.092
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:56.5, f1:53.3, auc:55.8 | trn acc:58.8, f1:47.2, auc:61.0 | loss:0.092
Epoch 6 finished in 4.20 seconds
[7,388] | tst acc:54.8, f1:50.6, auc:56.5 | trn acc:59.4, f1:48.1, auc:61.7 | loss:0.090
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:60.5, f1:56.8, auc:63.5 | trn acc:59.2, f1:47.4, auc:61.8 | loss:0.088
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:54.8, f1:50.0, auc:59.1 | trn acc:59.7, f1:47.9, auc:62.5 | loss:0.088
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:54.2, f1:50.3, auc:55.6 | trn acc:60.3, f1:48.6, auc:63.2 | loss:0.086
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:55.9, f1:51.2, auc:55.6 | trn acc:60.8, f1:48.8, auc:63.8 | loss:0.085
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 4.00 seconds
[15,100] | tst acc:54.2, f1:50.9, auc:55.8 | trn acc:61.1, f1:49.4, auc:64.3 | loss:0.085
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:54.8, f1:51.8, auc:55.9 | trn acc:61.7, f1:49.7, auc:64.9 | loss:0.083
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:55.4, f1:44.0, auc:62.0 | trn acc:62.4, f1:50.2, auc:65.9 | loss:0.082
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:53.7, f1:46.8, auc:58.3 | trn acc:63.2, f1:50.8, auc:66.7 | loss:0.081
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:61.0, f1:57.7, auc:63.2 | trn acc:64.0, f1:52.1, auc:67.5 | loss:0.081
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:63.3, f1:60.1, auc:66.6 | trn acc:64.6, f1:52.3, auc:68.3 | loss:0.078
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:61.6, f1:57.0, auc:65.7 | trn acc:65.9, f1:53.4, auc:69.7 | loss:0.078
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:58.8, f1:52.3, auc:61.5 | trn acc:66.9, f1:54.4, auc:70.9 | loss:0.076
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:53.7, f1:46.1, auc:59.3 | trn acc:68.0, f1:55.4, auc:71.7 | loss:0.076
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:63.3, f1:53.2, auc:72.1 | trn acc:69.3, f1:56.9, auc:73.2 | loss:0.074
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:62.1, f1:56.8, auc:69.6 | trn acc:70.4, f1:58.1, auc:74.3 | loss:0.072
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:59.3, f1:50.0, auc:68.4 | trn acc:71.7, f1:59.2, auc:75.7 | loss:0.071
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:64.4, f1:56.6, auc:72.0 | trn acc:72.9, f1:60.5, auc:76.6 | loss:0.070
Epoch 33 finished in 4.18 seconds
[34,568] | tst acc:62.7, f1:54.2, auc:66.9 | trn acc:73.8, f1:61.4, auc:77.5 | loss:0.069
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.97 seconds
[36,240] | tst acc:67.2, f1:58.0, auc:75.3 | trn acc:74.9, f1:62.5, auc:78.7 | loss:0.067
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:68.9, f1:61.0, auc:76.7 | trn acc:75.4, f1:63.2, auc:79.0 | loss:0.067
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:66.7, f1:59.3, auc:73.4 | trn acc:76.1, f1:64.0, auc:79.9 | loss:0.066
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:68.4, f1:60.6, auc:78.6 | trn acc:76.6, f1:64.4, auc:80.3 | loss:0.065
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.96 seconds
[42,280] | tst acc:66.7, f1:55.0, auc:79.2 | trn acc:77.1, f1:65.1, auc:80.9 | loss:0.064
Epoch 42 finished in 4.23 seconds
[43,628] | tst acc:70.1, f1:61.9, auc:81.0 | trn acc:77.4, f1:65.4, auc:81.2 | loss:0.063
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.00 seconds
[45,300] | tst acc:71.2, f1:63.8, auc:80.1 | trn acc:77.7, f1:65.9, auc:81.6 | loss:0.063
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:71.2, f1:64.3, auc:82.3 | trn acc:78.2, f1:66.2, auc:82.2 | loss:0.062
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:71.8, f1:65.3, auc:78.2 | trn acc:78.3, f1:66.6, auc:82.4 | loss:0.062
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:68.9, f1:58.6, auc:77.1 | trn acc:78.4, f1:66.5, auc:82.5 | loss:0.061
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:67.2, f1:58.0, auc:79.8 | trn acc:78.6, f1:67.0, auc:82.8 | loss:0.061
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:68.4, f1:59.4, auc:81.8 | trn acc:78.7, f1:66.9, auc:82.9 | loss:0.060
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:68.4, f1:57.6, auc:81.9 | trn acc:79.0, f1:67.4, auc:83.3 | loss:0.060
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:70.1, f1:61.9, auc:82.1 | trn acc:79.0, f1:67.5, auc:83.4 | loss:0.060
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:69.5, f1:62.0, auc:83.0 | trn acc:79.2, f1:67.6, auc:83.6 | loss:0.059
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:67.8, f1:58.4, auc:84.0 | trn acc:79.3, f1:67.9, auc:83.8 | loss:0.059
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:70.6, f1:61.2, auc:84.8 | trn acc:79.2, f1:67.7, auc:83.7 | loss:0.059
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:68.4, f1:60.0, auc:79.1 | trn acc:79.6, f1:68.2, auc:84.2 | loss:0.058
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:67.2, f1:56.7, auc:82.5 | trn acc:79.4, f1:67.9, auc:83.9 | loss:0.059
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:69.5, f1:59.7, auc:85.7 | trn acc:79.5, f1:68.0, auc:84.2 | loss:0.058
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:70.1, f1:60.1, auc:82.1 | trn acc:79.5, f1:68.0, auc:84.1 | loss:0.059
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:73.4, f1:65.7, auc:84.5 | trn acc:79.7, f1:68.5, auc:84.3 | loss:0.058
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:70.6, f1:63.4, auc:84.6 | trn acc:79.6, f1:67.9, auc:84.3 | loss:0.058
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:69.5, f1:60.3, auc:83.3 | trn acc:79.6, f1:68.2, auc:84.2 | loss:0.058
Average epoch runtime: 4.06 seconds
Total training time: 292.04 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.6, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.6000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:54.3, f1:45.9, auc:56.1 | trn acc:48.0, f1:41.1, auc:48.7 | loss:2.203
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:55.8, f1:47.9, auc:60.0 | trn acc:51.3, f1:40.7, auc:52.5 | loss:1.631
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:59.1, f1:49.8, auc:65.7 | trn acc:56.5, f1:45.0, auc:58.5 | loss:0.828
Epoch 3 finished in 4.16 seconds
[4,368] | tst acc:57.0, f1:48.2, auc:60.6 | trn acc:58.7, f1:47.2, auc:60.9 | loss:0.094
Epoch 4 finished in 4.20 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:62.7, f1:52.8, auc:67.9 | trn acc:59.0, f1:46.8, auc:61.5 | loss:0.091
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:63.0, f1:52.3, auc:66.3 | trn acc:59.2, f1:47.5, auc:61.8 | loss:0.091
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 3.99 seconds
[9,60] | tst acc:61.5, f1:52.0, auc:65.7 | trn acc:59.5, f1:47.6, auc:62.2 | loss:0.088
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:65.1, f1:55.5, auc:68.6 | trn acc:59.9, f1:48.0, auc:62.8 | loss:0.087
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:67.5, f1:56.9, auc:69.0 | trn acc:60.4, f1:48.5, auc:63.5 | loss:0.088
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:65.1, f1:55.5, auc:69.1 | trn acc:60.9, f1:48.8, auc:64.0 | loss:0.086
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 4.00 seconds
[15,100] | tst acc:67.2, f1:58.6, auc:72.2 | trn acc:61.3, f1:48.9, auc:64.6 | loss:0.085
Epoch 15 finished in 4.15 seconds
[16,448] | tst acc:65.4, f1:54.3, auc:68.6 | trn acc:62.1, f1:49.7, auc:65.4 | loss:0.082
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:65.1, f1:54.1, auc:69.5 | trn acc:62.7, f1:50.0, auc:66.1 | loss:0.082
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:65.4, f1:54.3, auc:68.8 | trn acc:63.2, f1:50.9, auc:66.6 | loss:0.080
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:72.5, f1:62.6, auc:75.3 | trn acc:64.1, f1:51.5, auc:67.7 | loss:0.082
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:67.5, f1:58.9, auc:73.4 | trn acc:65.2, f1:52.1, auc:69.0 | loss:0.078
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:71.6, f1:60.6, auc:76.3 | trn acc:66.2, f1:53.5, auc:69.9 | loss:0.078
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:72.5, f1:62.3, auc:77.8 | trn acc:67.0, f1:54.4, auc:70.8 | loss:0.076
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:68.1, f1:53.3, auc:71.7 | trn acc:68.4, f1:55.2, auc:72.2 | loss:0.075
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:73.4, f1:60.4, auc:77.5 | trn acc:69.4, f1:56.3, auc:73.3 | loss:0.074
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:72.2, f1:61.1, auc:79.3 | trn acc:70.9, f1:58.4, auc:74.9 | loss:0.072
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:76.7, f1:66.4, auc:80.4 | trn acc:71.8, f1:58.8, auc:75.5 | loss:0.071
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:79.1, f1:69.8, auc:83.8 | trn acc:73.0, f1:60.0, auc:76.8 | loss:0.070
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:79.1, f1:69.6, auc:83.5 | trn acc:74.1, f1:61.5, auc:77.9 | loss:0.068
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:79.7, f1:69.6, auc:86.0 | trn acc:75.1, f1:62.3, auc:78.8 | loss:0.067
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:78.8, f1:70.0, auc:83.5 | trn acc:75.8, f1:63.3, auc:79.5 | loss:0.066
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:80.6, f1:71.9, auc:86.6 | trn acc:76.2, f1:63.7, auc:79.8 | loss:0.065
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:80.6, f1:70.6, auc:86.6 | trn acc:76.9, f1:64.5, auc:80.7 | loss:0.064
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:81.2, f1:72.7, auc:85.9 | trn acc:77.4, f1:65.0, auc:81.3 | loss:0.063
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:84.5, f1:77.0, auc:89.0 | trn acc:77.6, f1:65.5, auc:81.5 | loss:0.063
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:80.9, f1:71.7, auc:88.2 | trn acc:77.9, f1:65.5, auc:81.9 | loss:0.062
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:83.3, f1:74.3, auc:88.7 | trn acc:78.1, f1:66.0, auc:82.1 | loss:0.062
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:80.6, f1:70.0, auc:87.0 | trn acc:78.4, f1:66.5, auc:82.6 | loss:0.061
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:82.7, f1:73.6, auc:89.6 | trn acc:78.6, f1:66.6, auc:82.8 | loss:0.061
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:83.6, f1:75.1, auc:89.0 | trn acc:78.9, f1:67.1, auc:83.3 | loss:0.060
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:82.7, f1:73.4, auc:88.6 | trn acc:78.8, f1:66.8, auc:83.1 | loss:0.060
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:80.6, f1:70.9, auc:88.1 | trn acc:79.3, f1:67.6, auc:83.6 | loss:0.059
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:84.5, f1:76.6, auc:90.2 | trn acc:79.1, f1:67.1, auc:83.5 | loss:0.059
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:85.7, f1:78.9, auc:90.3 | trn acc:79.3, f1:67.7, auc:83.9 | loss:0.059
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:86.3, f1:79.1, auc:91.1 | trn acc:79.5, f1:67.6, auc:84.0 | loss:0.059
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:85.7, f1:78.4, auc:89.5 | trn acc:79.6, f1:68.0, auc:84.1 | loss:0.058
Epoch 60 finished in 4.23 seconds
Epoch 61 finished in 3.97 seconds
[62,72] | tst acc:82.1, f1:73.7, auc:90.8 | trn acc:79.6, f1:67.8, auc:84.3 | loss:0.058
Epoch 62 finished in 4.22 seconds
[63,420] | tst acc:82.4, f1:72.8, auc:89.2 | trn acc:79.6, f1:68.0, auc:84.2 | loss:0.058
Epoch 63 finished in 4.19 seconds
Epoch 64 finished in 4.02 seconds
[65,92] | tst acc:83.6, f1:75.1, auc:89.0 | trn acc:79.8, f1:68.3, auc:84.4 | loss:0.058
Epoch 65 finished in 4.19 seconds
[66,440] | tst acc:83.0, f1:74.2, auc:89.8 | trn acc:79.9, f1:68.2, auc:84.5 | loss:0.058
Epoch 66 finished in 4.25 seconds
Epoch 67 finished in 3.97 seconds
[68,112] | tst acc:84.2, f1:75.6, auc:91.3 | trn acc:79.7, f1:68.1, auc:84.3 | loss:0.058
Epoch 68 finished in 4.24 seconds
[69,460] | tst acc:85.4, f1:77.2, auc:89.8 | trn acc:79.8, f1:68.2, auc:84.5 | loss:0.058
Epoch 69 finished in 4.18 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.02 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:85.1, f1:76.9, auc:90.0 | trn acc:79.8, f1:68.3, auc:84.5 | loss:0.058
Average epoch runtime: 4.06 seconds
Total training time: 292.13 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.6, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.6000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:50.0, f1:43.0, auc:51.6 | trn acc:49.9, f1:38.7, auc:51.0 | loss:2.040
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:50.4, f1:44.1, auc:54.9 | trn acc:51.4, f1:39.8, auc:52.4 | loss:1.630
Epoch 1 finished in 4.17 seconds
Epoch 2 finished in 4.00 seconds
[3,20] | tst acc:58.8, f1:50.0, auc:60.2 | trn acc:56.7, f1:44.4, auc:58.6 | loss:0.839
Epoch 3 finished in 4.17 seconds
[4,368] | tst acc:55.5, f1:47.6, auc:58.0 | trn acc:58.5, f1:46.0, auc:60.2 | loss:0.093
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.95 seconds
[6,40] | tst acc:60.2, f1:51.3, auc:66.3 | trn acc:59.0, f1:46.1, auc:61.1 | loss:0.094
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:62.2, f1:52.1, auc:64.6 | trn acc:59.5, f1:46.4, auc:61.6 | loss:0.090
Epoch 7 finished in 4.16 seconds
Epoch 8 finished in 4.00 seconds
[9,60] | tst acc:60.4, f1:50.2, auc:62.9 | trn acc:59.6, f1:46.9, auc:61.9 | loss:0.089
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:65.3, f1:56.5, auc:68.4 | trn acc:60.0, f1:46.9, auc:62.7 | loss:0.089
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:62.2, f1:53.0, auc:66.0 | trn acc:60.4, f1:47.6, auc:63.1 | loss:0.088
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:62.2, f1:53.7, auc:68.9 | trn acc:61.0, f1:47.7, auc:63.9 | loss:0.085
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:63.3, f1:55.2, auc:68.5 | trn acc:61.4, f1:48.3, auc:64.3 | loss:0.084
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:64.1, f1:54.4, auc:65.4 | trn acc:62.1, f1:48.7, auc:65.3 | loss:0.083
Epoch 16 finished in 4.21 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:66.1, f1:55.3, auc:70.7 | trn acc:62.9, f1:49.7, auc:66.1 | loss:0.083
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:66.1, f1:56.4, auc:70.5 | trn acc:63.3, f1:49.8, auc:66.7 | loss:0.082
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 4.00 seconds
[21,140] | tst acc:69.8, f1:62.1, auc:74.7 | trn acc:64.3, f1:51.0, auc:67.8 | loss:0.080
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:65.1, f1:55.3, auc:72.0 | trn acc:65.2, f1:51.5, auc:68.8 | loss:0.078
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:72.2, f1:62.6, auc:77.0 | trn acc:66.3, f1:52.8, auc:69.9 | loss:0.077
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:69.6, f1:59.3, auc:77.0 | trn acc:67.3, f1:53.4, auc:71.1 | loss:0.076
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:67.5, f1:54.6, auc:74.2 | trn acc:68.6, f1:54.8, auc:72.2 | loss:0.075
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:72.5, f1:61.3, auc:78.2 | trn acc:69.6, f1:55.7, auc:73.4 | loss:0.073
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:72.2, f1:61.4, auc:78.2 | trn acc:70.9, f1:57.3, auc:74.7 | loss:0.072
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:75.9, f1:65.9, auc:80.8 | trn acc:72.0, f1:58.3, auc:75.5 | loss:0.071
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:78.8, f1:69.8, auc:82.8 | trn acc:73.5, f1:59.7, auc:77.2 | loss:0.068
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:77.8, f1:68.9, auc:82.8 | trn acc:74.4, f1:60.9, auc:77.7 | loss:0.068
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:78.0, f1:68.0, auc:82.4 | trn acc:75.3, f1:61.5, auc:78.7 | loss:0.066
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:80.4, f1:71.9, auc:84.4 | trn acc:76.0, f1:62.7, auc:79.6 | loss:0.065
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:80.4, f1:72.1, auc:85.6 | trn acc:76.6, f1:63.2, auc:80.2 | loss:0.064
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:79.2, f1:69.9, auc:86.6 | trn acc:77.1, f1:63.8, auc:80.6 | loss:0.064
Epoch 40 finished in 4.21 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:81.2, f1:72.1, auc:87.1 | trn acc:77.4, f1:64.3, auc:81.1 | loss:0.063
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:79.8, f1:70.3, auc:87.4 | trn acc:77.7, f1:64.6, auc:81.3 | loss:0.063
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 4.00 seconds
[45,300] | tst acc:82.0, f1:73.9, auc:88.6 | trn acc:78.2, f1:65.3, auc:81.9 | loss:0.062
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:82.0, f1:73.1, auc:86.4 | trn acc:78.5, f1:65.3, auc:82.3 | loss:0.061
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:82.9, f1:74.6, auc:87.8 | trn acc:78.7, f1:65.8, auc:82.7 | loss:0.060
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:82.2, f1:73.5, auc:87.2 | trn acc:78.7, f1:65.8, auc:82.6 | loss:0.060
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:81.0, f1:71.7, auc:87.6 | trn acc:78.8, f1:66.2, auc:82.8 | loss:0.060
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:81.0, f1:70.7, auc:87.4 | trn acc:79.4, f1:66.3, auc:83.5 | loss:0.059
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:82.5, f1:73.3, auc:89.3 | trn acc:79.3, f1:66.6, auc:83.4 | loss:0.059
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:81.8, f1:72.4, auc:89.3 | trn acc:79.3, f1:66.5, auc:83.5 | loss:0.059
Epoch 56 finished in 4.22 seconds
[57,380] | tst acc:82.0, f1:73.3, auc:89.2 | trn acc:79.7, f1:67.2, auc:83.9 | loss:0.058
Epoch 57 finished in 4.17 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:82.2, f1:73.2, auc:88.1 | trn acc:79.6, f1:67.0, auc:83.9 | loss:0.058
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:83.3, f1:74.5, auc:89.0 | trn acc:79.8, f1:67.2, auc:84.2 | loss:0.058
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:82.4, f1:74.1, auc:88.1 | trn acc:79.6, f1:66.9, auc:83.9 | loss:0.058
Epoch 62 finished in 4.19 seconds
[63,420] | tst acc:83.7, f1:74.9, auc:88.5 | trn acc:79.8, f1:67.3, auc:84.1 | loss:0.058
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:83.3, f1:74.8, auc:89.4 | trn acc:80.1, f1:67.6, auc:84.5 | loss:0.057
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:82.9, f1:73.7, auc:90.1 | trn acc:80.1, f1:67.6, auc:84.5 | loss:0.057
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:84.9, f1:76.9, auc:89.5 | trn acc:79.9, f1:67.4, auc:84.2 | loss:0.058
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:83.5, f1:75.3, auc:90.5 | trn acc:80.1, f1:67.2, auc:84.5 | loss:0.057
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:83.9, f1:75.6, auc:88.8 | trn acc:80.0, f1:67.7, auc:84.3 | loss:0.058
Average epoch runtime: 4.05 seconds
Total training time: 291.92 GPU seconds
alpha = 0.7
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.7, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.7000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.8, f1:47.8, auc:49.6 | trn acc:49.5, f1:39.7, auc:50.3 | loss:1.879
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:45.4, f1:44.6, auc:47.6 | trn acc:51.0, f1:40.5, auc:52.5 | loss:1.493
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:52.1, f1:50.0, auc:53.8 | trn acc:55.4, f1:45.7, auc:59.3 | loss:0.867
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:53.1, f1:52.4, auc:56.6 | trn acc:57.3, f1:47.7, auc:60.6 | loss:0.091
Epoch 4 finished in 4.23 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:54.6, f1:51.7, auc:58.6 | trn acc:57.6, f1:47.5, auc:61.7 | loss:0.083
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:53.3, f1:50.0, auc:55.1 | trn acc:57.8, f1:47.9, auc:62.2 | loss:0.081
Epoch 7 finished in 4.17 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:53.5, f1:50.1, auc:56.0 | trn acc:58.0, f1:48.5, auc:62.5 | loss:0.081
Epoch 9 finished in 4.17 seconds
[10,408] | tst acc:57.7, f1:54.8, auc:59.3 | trn acc:58.4, f1:48.6, auc:63.1 | loss:0.079
Epoch 10 finished in 4.23 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:55.6, f1:53.4, auc:58.9 | trn acc:58.7, f1:48.7, auc:63.7 | loss:0.080
Epoch 12 finished in 4.22 seconds
[13,428] | tst acc:56.8, f1:55.2, auc:61.0 | trn acc:59.1, f1:49.4, auc:64.1 | loss:0.079
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:53.5, f1:50.9, auc:55.3 | trn acc:59.5, f1:49.7, auc:64.9 | loss:0.078
Epoch 15 finished in 4.15 seconds
[16,448] | tst acc:53.7, f1:50.2, auc:53.3 | trn acc:59.9, f1:50.2, auc:65.4 | loss:0.076
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.94 seconds
[18,120] | tst acc:59.5, f1:54.7, auc:58.3 | trn acc:60.2, f1:50.4, auc:65.9 | loss:0.076
Epoch 18 finished in 4.19 seconds
[19,468] | tst acc:60.8, f1:57.4, auc:63.8 | trn acc:61.0, f1:51.3, auc:66.9 | loss:0.075
Epoch 19 finished in 4.15 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:58.1, f1:54.5, auc:60.9 | trn acc:61.7, f1:51.9, auc:67.8 | loss:0.073
Epoch 21 finished in 4.15 seconds
[22,488] | tst acc:56.8, f1:54.1, auc:59.0 | trn acc:62.3, f1:52.5, auc:68.6 | loss:0.072
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.94 seconds
[24,160] | tst acc:55.2, f1:50.2, auc:56.9 | trn acc:63.2, f1:53.3, auc:69.6 | loss:0.071
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:59.8, f1:57.0, auc:60.2 | trn acc:63.9, f1:54.1, auc:70.7 | loss:0.071
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:57.1, f1:50.9, auc:58.4 | trn acc:65.1, f1:55.4, auc:71.9 | loss:0.069
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:58.9, f1:53.6, auc:60.0 | trn acc:65.8, f1:56.0, auc:72.7 | loss:0.068
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.94 seconds
[30,200] | tst acc:58.9, f1:54.4, auc:61.9 | trn acc:67.0, f1:57.0, auc:74.2 | loss:0.067
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:60.6, f1:54.9, auc:59.6 | trn acc:68.1, f1:58.2, auc:75.0 | loss:0.066
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:62.5, f1:57.1, auc:61.2 | trn acc:69.4, f1:59.3, auc:76.7 | loss:0.065
Epoch 33 finished in 4.15 seconds
[34,568] | tst acc:63.9, f1:59.4, auc:67.1 | trn acc:70.6, f1:60.6, auc:77.4 | loss:0.064
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.94 seconds
[36,240] | tst acc:63.5, f1:57.7, auc:63.9 | trn acc:71.4, f1:61.4, auc:77.9 | loss:0.063
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:64.1, f1:58.5, auc:64.5 | trn acc:72.5, f1:62.0, auc:79.1 | loss:0.062
Epoch 37 finished in 4.15 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:63.9, f1:57.8, auc:66.9 | trn acc:73.3, f1:63.2, auc:79.9 | loss:0.061
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:66.0, f1:60.7, auc:68.0 | trn acc:73.9, f1:63.7, auc:80.4 | loss:0.060
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:66.4, f1:59.7, auc:67.2 | trn acc:74.3, f1:63.9, auc:80.8 | loss:0.060
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:63.3, f1:56.4, auc:67.3 | trn acc:75.1, f1:65.0, auc:81.4 | loss:0.059
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:66.8, f1:61.3, auc:65.8 | trn acc:75.3, f1:65.2, auc:81.7 | loss:0.059
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:63.9, f1:56.6, auc:66.2 | trn acc:75.6, f1:65.3, auc:82.1 | loss:0.058
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:65.1, f1:57.8, auc:67.8 | trn acc:75.9, f1:65.7, auc:82.3 | loss:0.058
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:64.7, f1:57.5, auc:67.3 | trn acc:76.2, f1:66.0, auc:82.7 | loss:0.057
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:68.0, f1:61.8, auc:69.1 | trn acc:76.5, f1:66.3, auc:83.1 | loss:0.056
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:65.1, f1:56.6, auc:66.2 | trn acc:76.4, f1:66.4, auc:82.9 | loss:0.057
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:66.8, f1:59.8, auc:70.0 | trn acc:76.6, f1:66.5, auc:83.3 | loss:0.056
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:67.2, f1:60.3, auc:68.4 | trn acc:76.8, f1:66.8, auc:83.5 | loss:0.056
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:66.2, f1:60.1, auc:68.1 | trn acc:77.0, f1:67.1, auc:83.7 | loss:0.055
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:66.4, f1:59.9, auc:69.7 | trn acc:76.8, f1:66.8, auc:83.7 | loss:0.055
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:65.6, f1:58.2, auc:69.0 | trn acc:77.2, f1:67.0, auc:84.1 | loss:0.055
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:66.0, f1:59.4, auc:69.3 | trn acc:77.2, f1:67.4, auc:84.0 | loss:0.055
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:65.8, f1:58.7, auc:67.9 | trn acc:77.0, f1:67.1, auc:83.8 | loss:0.055
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:66.2, f1:58.6, auc:69.5 | trn acc:77.4, f1:67.4, auc:84.4 | loss:0.054
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:65.8, f1:58.9, auc:69.7 | trn acc:77.3, f1:67.6, auc:84.2 | loss:0.055
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:65.6, f1:59.0, auc:68.9 | trn acc:77.3, f1:67.2, auc:84.4 | loss:0.054
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:67.4, f1:60.8, auc:70.9 | trn acc:77.5, f1:67.7, auc:84.5 | loss:0.054
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:67.8, f1:60.3, auc:70.3 | trn acc:77.2, f1:67.4, auc:84.1 | loss:0.055
Average epoch runtime: 4.05 seconds
Total training time: 291.73 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.7, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.7000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:52.9, f1:38.9, auc:56.5 | trn acc:49.1, f1:44.8, auc:49.5 | loss:2.033
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:51.5, f1:39.5, auc:58.2 | trn acc:50.9, f1:40.7, auc:52.4 | loss:1.505
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:52.0, f1:41.3, auc:62.7 | trn acc:55.2, f1:45.7, auc:59.1 | loss:0.880
Epoch 3 finished in 4.19 seconds
[4,368] | tst acc:56.1, f1:46.2, auc:63.9 | trn acc:57.2, f1:47.9, auc:60.6 | loss:0.093
Epoch 4 finished in 4.23 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:58.6, f1:46.1, auc:63.2 | trn acc:57.5, f1:48.1, auc:61.6 | loss:0.080
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:58.3, f1:44.0, auc:62.9 | trn acc:57.7, f1:48.1, auc:61.9 | loss:0.080
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:58.0, f1:45.4, auc:63.4 | trn acc:57.8, f1:48.4, auc:62.5 | loss:0.079
Epoch 9 finished in 4.18 seconds
[10,408] | tst acc:58.9, f1:45.9, auc:67.6 | trn acc:58.1, f1:48.7, auc:62.9 | loss:0.078
Epoch 10 finished in 4.23 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:60.2, f1:48.2, auc:67.3 | trn acc:58.5, f1:49.1, auc:63.3 | loss:0.078
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:58.9, f1:48.8, auc:70.5 | trn acc:58.7, f1:49.0, auc:64.1 | loss:0.077
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:60.2, f1:47.1, auc:66.5 | trn acc:59.2, f1:50.0, auc:64.5 | loss:0.076
Epoch 15 finished in 4.15 seconds
[16,448] | tst acc:61.9, f1:48.9, auc:67.8 | trn acc:59.5, f1:49.9, auc:65.0 | loss:0.076
Epoch 16 finished in 4.21 seconds
Epoch 17 finished in 3.94 seconds
[18,120] | tst acc:60.8, f1:47.4, auc:68.2 | trn acc:60.2, f1:51.0, auc:65.9 | loss:0.075
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:65.7, f1:54.7, auc:73.6 | trn acc:60.5, f1:51.3, auc:66.3 | loss:0.074
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:63.2, f1:52.6, auc:73.7 | trn acc:61.2, f1:51.6, auc:67.4 | loss:0.073
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:59.9, f1:49.1, auc:70.4 | trn acc:61.8, f1:52.5, auc:67.9 | loss:0.073
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:64.3, f1:52.4, auc:72.4 | trn acc:62.8, f1:53.5, auc:69.2 | loss:0.071
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:64.6, f1:54.5, auc:73.2 | trn acc:63.4, f1:54.1, auc:70.1 | loss:0.071
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:63.5, f1:48.9, auc:72.4 | trn acc:64.6, f1:55.2, auc:71.4 | loss:0.070
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:66.2, f1:53.0, auc:75.6 | trn acc:65.5, f1:56.1, auc:72.6 | loss:0.069
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:66.2, f1:55.1, auc:77.5 | trn acc:66.5, f1:57.1, auc:73.6 | loss:0.067
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:69.2, f1:55.3, auc:76.1 | trn acc:67.8, f1:58.3, auc:74.9 | loss:0.067
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:70.6, f1:58.1, auc:79.2 | trn acc:68.8, f1:59.3, auc:76.0 | loss:0.065
Epoch 33 finished in 4.18 seconds
[34,568] | tst acc:66.8, f1:56.4, auc:81.2 | trn acc:70.1, f1:60.5, auc:77.2 | loss:0.064
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:70.6, f1:57.8, auc:81.0 | trn acc:71.1, f1:61.2, auc:77.9 | loss:0.063
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:72.5, f1:61.3, auc:81.5 | trn acc:72.1, f1:62.3, auc:78.9 | loss:0.062
Epoch 37 finished in 4.17 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:72.8, f1:62.1, auc:84.2 | trn acc:72.9, f1:63.3, auc:79.7 | loss:0.061
Epoch 39 finished in 4.18 seconds
[40,608] | tst acc:74.7, f1:63.2, auc:83.5 | trn acc:73.5, f1:63.6, auc:80.2 | loss:0.061
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.96 seconds
[42,280] | tst acc:73.6, f1:61.0, auc:82.6 | trn acc:74.1, f1:64.3, auc:80.7 | loss:0.060
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:71.9, f1:59.6, auc:81.0 | trn acc:74.6, f1:64.7, auc:81.3 | loss:0.059
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:73.6, f1:61.4, auc:83.4 | trn acc:75.0, f1:65.4, auc:81.7 | loss:0.059
Epoch 45 finished in 4.18 seconds
[46,648] | tst acc:75.7, f1:64.5, auc:86.3 | trn acc:75.2, f1:65.4, auc:81.9 | loss:0.058
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:73.6, f1:62.3, auc:85.7 | trn acc:75.6, f1:66.0, auc:82.2 | loss:0.058
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:75.5, f1:64.0, auc:87.3 | trn acc:75.8, f1:66.0, auc:82.6 | loss:0.057
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.01 seconds
[51,340] | tst acc:75.2, f1:63.5, auc:84.3 | trn acc:76.0, f1:66.2, auc:82.9 | loss:0.057
Epoch 51 finished in 4.18 seconds
Epoch 52 finished in 4.01 seconds
[53,12] | tst acc:77.7, f1:65.5, auc:85.0 | trn acc:76.2, f1:66.5, auc:83.1 | loss:0.057
Epoch 53 finished in 4.17 seconds
[54,360] | tst acc:74.4, f1:61.8, auc:83.6 | trn acc:76.4, f1:67.0, auc:83.5 | loss:0.056
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:76.8, f1:65.6, auc:84.6 | trn acc:76.2, f1:66.3, auc:83.3 | loss:0.056
Epoch 56 finished in 4.21 seconds
[57,380] | tst acc:73.8, f1:62.2, auc:84.7 | trn acc:76.7, f1:67.2, auc:83.7 | loss:0.055
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:76.6, f1:65.9, auc:87.3 | trn acc:76.5, f1:66.8, auc:83.6 | loss:0.056
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:74.7, f1:61.7, auc:84.3 | trn acc:76.8, f1:67.4, auc:84.0 | loss:0.055
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:74.1, f1:62.7, auc:85.4 | trn acc:76.6, f1:66.9, auc:83.8 | loss:0.055
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:77.4, f1:66.4, auc:85.8 | trn acc:77.1, f1:67.6, auc:84.5 | loss:0.054
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:75.2, f1:63.5, auc:85.6 | trn acc:76.6, f1:67.0, auc:83.8 | loss:0.055
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:75.7, f1:64.5, auc:84.8 | trn acc:76.9, f1:67.5, auc:84.2 | loss:0.054
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:73.3, f1:61.7, auc:83.6 | trn acc:77.0, f1:67.6, auc:84.3 | loss:0.054
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:77.9, f1:66.9, auc:87.6 | trn acc:76.9, f1:67.3, auc:84.4 | loss:0.054
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.00 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:78.2, f1:67.2, auc:85.8 | trn acc:76.8, f1:67.4, auc:84.0 | loss:0.055
Average epoch runtime: 4.06 seconds
Total training time: 292.45 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.7, gamma=2.0, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.7000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:51.7, f1:42.4, auc:53.2 | trn acc:49.0, f1:40.0, auc:50.7 | loss:1.861
Epoch 0 finished in 4.18 seconds
[1,348] | tst acc:50.1, f1:43.0, auc:54.3 | trn acc:51.1, f1:40.9, auc:52.7 | loss:1.494
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:55.4, f1:46.7, auc:62.9 | trn acc:55.3, f1:45.6, auc:59.4 | loss:0.874
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:58.2, f1:51.8, auc:64.6 | trn acc:57.5, f1:47.9, auc:60.9 | loss:0.096
Epoch 4 finished in 4.22 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:60.3, f1:51.3, auc:64.5 | trn acc:57.6, f1:48.3, auc:61.8 | loss:0.082
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:55.6, f1:46.5, auc:60.0 | trn acc:58.0, f1:48.1, auc:62.4 | loss:0.083
Epoch 7 finished in 4.17 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:61.4, f1:52.6, auc:67.0 | trn acc:58.2, f1:48.9, auc:62.7 | loss:0.080
Epoch 9 finished in 4.18 seconds
[10,408] | tst acc:60.1, f1:50.5, auc:66.1 | trn acc:58.3, f1:48.6, auc:63.2 | loss:0.080
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:61.6, f1:52.4, auc:67.2 | trn acc:58.9, f1:49.6, auc:63.7 | loss:0.079
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:59.5, f1:52.3, auc:67.3 | trn acc:59.3, f1:49.8, auc:64.4 | loss:0.077
Epoch 13 finished in 4.15 seconds
Epoch 14 finished in 4.00 seconds
[15,100] | tst acc:59.8, f1:51.3, auc:67.3 | trn acc:59.5, f1:49.8, auc:64.9 | loss:0.077
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:55.6, f1:45.9, auc:60.2 | trn acc:59.9, f1:50.4, auc:65.3 | loss:0.076
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:59.5, f1:47.8, auc:64.9 | trn acc:60.5, f1:50.8, auc:66.2 | loss:0.075
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:62.9, f1:55.1, auc:72.1 | trn acc:61.1, f1:51.5, auc:66.8 | loss:0.074
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:62.1, f1:54.0, auc:70.2 | trn acc:61.7, f1:51.9, auc:67.6 | loss:0.073
Epoch 21 finished in 4.15 seconds
[22,488] | tst acc:60.6, f1:53.0, auc:70.4 | trn acc:62.5, f1:52.8, auc:68.6 | loss:0.072
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:64.5, f1:55.0, auc:69.7 | trn acc:63.4, f1:53.6, auc:69.7 | loss:0.072
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:66.1, f1:58.3, auc:75.6 | trn acc:64.0, f1:54.4, auc:70.5 | loss:0.071
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:64.5, f1:53.7, auc:70.6 | trn acc:65.3, f1:55.4, auc:71.9 | loss:0.069
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:70.2, f1:59.9, auc:76.0 | trn acc:66.1, f1:56.3, auc:72.9 | loss:0.068
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:67.1, f1:58.6, auc:74.6 | trn acc:67.4, f1:57.7, auc:74.2 | loss:0.067
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:71.0, f1:61.1, auc:77.6 | trn acc:68.6, f1:58.7, auc:75.4 | loss:0.066
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:70.0, f1:61.0, auc:80.1 | trn acc:69.6, f1:59.7, auc:76.5 | loss:0.065
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:69.7, f1:61.6, auc:79.5 | trn acc:70.8, f1:61.0, auc:77.4 | loss:0.064
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:74.4, f1:66.4, auc:81.5 | trn acc:71.9, f1:62.0, auc:78.4 | loss:0.063
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:74.7, f1:67.1, auc:85.2 | trn acc:72.5, f1:62.3, auc:79.0 | loss:0.062
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:73.6, f1:65.3, auc:81.8 | trn acc:73.6, f1:63.6, auc:80.2 | loss:0.060
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:77.3, f1:70.7, auc:85.3 | trn acc:74.0, f1:63.8, auc:80.3 | loss:0.061
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:74.9, f1:65.5, auc:83.4 | trn acc:74.7, f1:64.8, auc:81.1 | loss:0.060
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:74.4, f1:65.0, auc:82.3 | trn acc:74.9, f1:64.8, auc:81.4 | loss:0.059
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:74.9, f1:67.1, auc:84.2 | trn acc:75.5, f1:65.4, auc:82.1 | loss:0.058
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:72.8, f1:63.6, auc:83.4 | trn acc:75.8, f1:65.9, auc:82.3 | loss:0.058
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:72.8, f1:63.6, auc:82.4 | trn acc:76.1, f1:66.2, auc:82.6 | loss:0.057
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:74.9, f1:66.4, auc:84.8 | trn acc:76.1, f1:66.2, auc:82.8 | loss:0.057
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:74.9, f1:66.4, auc:84.5 | trn acc:76.3, f1:66.6, auc:83.0 | loss:0.057
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:77.0, f1:67.4, auc:84.4 | trn acc:76.6, f1:66.6, auc:83.4 | loss:0.056
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:75.2, f1:65.9, auc:84.6 | trn acc:76.8, f1:66.9, auc:83.6 | loss:0.056
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:75.7, f1:66.4, auc:85.6 | trn acc:76.8, f1:66.9, auc:83.7 | loss:0.055
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:74.7, f1:66.0, auc:83.4 | trn acc:77.2, f1:67.5, auc:84.1 | loss:0.055
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:74.2, f1:65.3, auc:84.7 | trn acc:76.9, f1:67.2, auc:83.9 | loss:0.055
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:74.7, f1:65.5, auc:84.2 | trn acc:77.2, f1:67.4, auc:84.2 | loss:0.055
Epoch 60 finished in 4.21 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:76.2, f1:68.9, auc:86.4 | trn acc:77.1, f1:67.2, auc:84.3 | loss:0.054
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:76.8, f1:69.2, auc:85.4 | trn acc:77.2, f1:67.4, auc:84.3 | loss:0.054
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:74.2, f1:65.0, auc:84.1 | trn acc:77.4, f1:67.8, auc:84.5 | loss:0.054
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:73.1, f1:63.9, auc:84.2 | trn acc:77.4, f1:67.9, auc:84.5 | loss:0.054
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:75.5, f1:67.1, auc:85.1 | trn acc:77.4, f1:67.8, auc:84.5 | loss:0.054
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:76.5, f1:68.1, auc:87.1 | trn acc:77.3, f1:67.6, auc:84.4 | loss:0.054
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:77.0, f1:67.9, auc:84.6 | trn acc:77.4, f1:67.8, auc:84.7 | loss:0.054
Average epoch runtime: 4.06 seconds
Total training time: 292.03 GPU seconds
alpha = 0.8
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.8, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.8000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.0, f1:49.4, auc:49.5 | trn acc:49.1, f1:39.3, auc:50.5 | loss:1.649
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:51.7, f1:55.1, auc:53.8 | trn acc:50.7, f1:41.4, auc:52.6 | loss:1.350
Epoch 1 finished in 4.18 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:54.0, f1:56.0, auc:56.8 | trn acc:53.6, f1:46.7, auc:59.0 | loss:0.809
Epoch 3 finished in 4.17 seconds
[4,368] | tst acc:53.1, f1:56.6, auc:54.3 | trn acc:55.5, f1:49.0, auc:60.3 | loss:0.187
Epoch 4 finished in 4.21 seconds
Epoch 5 finished in 3.96 seconds
[6,40] | tst acc:61.7, f1:63.8, auc:63.8 | trn acc:56.0, f1:49.9, auc:62.3 | loss:0.074
Epoch 6 finished in 4.21 seconds
[7,388] | tst acc:58.6, f1:60.4, auc:62.0 | trn acc:56.2, f1:50.3, auc:62.8 | loss:0.074
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:56.7, f1:59.2, auc:60.2 | trn acc:56.1, f1:49.9, auc:63.4 | loss:0.072
Epoch 9 finished in 4.17 seconds
[10,408] | tst acc:63.6, f1:65.5, auc:65.8 | trn acc:56.5, f1:50.4, auc:64.1 | loss:0.071
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:60.0, f1:62.5, auc:64.6 | trn acc:56.6, f1:50.7, auc:64.3 | loss:0.072
Epoch 12 finished in 4.22 seconds
[13,428] | tst acc:60.0, f1:63.5, auc:63.1 | trn acc:57.2, f1:51.4, auc:65.3 | loss:0.069
Epoch 13 finished in 4.17 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:61.5, f1:64.2, auc:63.7 | trn acc:57.4, f1:51.7, auc:65.7 | loss:0.068
Epoch 15 finished in 4.17 seconds
[16,448] | tst acc:53.8, f1:56.2, auc:57.2 | trn acc:57.9, f1:52.1, auc:66.6 | loss:0.068
Epoch 16 finished in 4.22 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:60.5, f1:62.1, auc:66.1 | trn acc:58.2, f1:52.9, auc:67.1 | loss:0.067
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:61.5, f1:64.2, auc:65.9 | trn acc:58.4, f1:52.8, auc:67.9 | loss:0.066
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:61.7, f1:64.5, auc:66.2 | trn acc:58.8, f1:53.4, auc:68.6 | loss:0.065
Epoch 21 finished in 4.17 seconds
[22,488] | tst acc:57.9, f1:61.7, auc:61.6 | trn acc:59.5, f1:54.3, auc:69.5 | loss:0.064
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:58.4, f1:60.1, auc:66.2 | trn acc:60.0, f1:54.7, auc:70.4 | loss:0.063
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:65.7, f1:68.6, auc:70.1 | trn acc:60.3, f1:55.0, auc:71.2 | loss:0.062
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:66.7, f1:68.4, auc:71.4 | trn acc:61.4, f1:56.3, auc:72.6 | loss:0.061
Epoch 27 finished in 4.15 seconds
[28,528] | tst acc:66.9, f1:68.1, auc:72.4 | trn acc:61.6, f1:56.1, auc:73.2 | loss:0.059
Epoch 28 finished in 4.19 seconds
Epoch 29 finished in 3.94 seconds
[30,200] | tst acc:65.7, f1:67.6, auc:72.4 | trn acc:62.5, f1:57.6, auc:73.8 | loss:0.060
Epoch 30 finished in 4.19 seconds
[31,548] | tst acc:67.2, f1:68.8, auc:73.8 | trn acc:63.3, f1:58.0, auc:75.4 | loss:0.058
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.98 seconds
[33,220] | tst acc:67.2, f1:68.4, auc:73.4 | trn acc:63.9, f1:58.3, auc:76.2 | loss:0.057
Epoch 33 finished in 4.15 seconds
[34,568] | tst acc:68.6, f1:70.5, auc:75.9 | trn acc:65.0, f1:59.5, auc:77.2 | loss:0.056
Epoch 34 finished in 4.19 seconds
Epoch 35 finished in 3.94 seconds
[36,240] | tst acc:68.6, f1:70.2, auc:75.6 | trn acc:65.6, f1:60.1, auc:77.8 | loss:0.055
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:69.2, f1:70.7, auc:74.2 | trn acc:66.4, f1:60.6, auc:78.5 | loss:0.055
Epoch 37 finished in 4.14 seconds
Epoch 38 finished in 3.98 seconds
[39,260] | tst acc:71.3, f1:72.5, auc:79.3 | trn acc:67.0, f1:61.1, auc:79.3 | loss:0.053
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:73.8, f1:74.9, auc:80.6 | trn acc:67.9, f1:62.0, auc:80.0 | loss:0.053
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:73.2, f1:73.6, auc:80.2 | trn acc:68.2, f1:62.4, auc:80.3 | loss:0.053
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:71.1, f1:72.1, auc:79.2 | trn acc:68.5, f1:62.3, auc:80.8 | loss:0.052
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:73.4, f1:74.1, auc:79.5 | trn acc:69.0, f1:62.7, auc:81.4 | loss:0.051
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:74.3, f1:74.6, auc:79.9 | trn acc:69.6, f1:63.7, auc:81.6 | loss:0.051
Epoch 46 finished in 4.19 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:74.7, f1:75.4, auc:81.7 | trn acc:69.7, f1:63.3, auc:82.2 | loss:0.050
Epoch 48 finished in 4.19 seconds
[49,668] | tst acc:75.5, f1:76.4, auc:82.6 | trn acc:70.2, f1:64.2, auc:82.1 | loss:0.050
Epoch 49 finished in 4.14 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:75.5, f1:76.4, auc:81.8 | trn acc:70.2, f1:64.0, auc:82.5 | loss:0.050
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.98 seconds
[53,12] | tst acc:75.7, f1:76.1, auc:82.8 | trn acc:70.4, f1:64.3, auc:82.7 | loss:0.049
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:76.4, f1:76.9, auc:83.6 | trn acc:70.4, f1:64.0, auc:83.1 | loss:0.049
Epoch 54 finished in 4.19 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:76.8, f1:77.0, auc:82.8 | trn acc:71.0, f1:65.1, auc:83.2 | loss:0.049
Epoch 56 finished in 4.19 seconds
[57,380] | tst acc:73.6, f1:74.9, auc:81.7 | trn acc:70.6, f1:64.5, auc:83.3 | loss:0.049
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:75.5, f1:76.3, auc:83.6 | trn acc:70.8, f1:64.9, auc:83.5 | loss:0.048
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:75.5, f1:76.2, auc:82.7 | trn acc:70.9, f1:64.6, auc:83.9 | loss:0.048
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:75.7, f1:76.6, auc:82.9 | trn acc:70.9, f1:65.0, auc:83.6 | loss:0.048
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:74.1, f1:74.7, auc:82.9 | trn acc:71.2, f1:65.2, auc:83.8 | loss:0.048
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:75.5, f1:76.3, auc:82.8 | trn acc:70.9, f1:64.9, auc:83.8 | loss:0.048
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:74.5, f1:75.1, auc:82.7 | trn acc:71.0, f1:64.8, auc:84.1 | loss:0.047
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:74.9, f1:75.9, auc:82.4 | trn acc:71.0, f1:65.0, auc:84.0 | loss:0.047
Epoch 68 finished in 4.19 seconds
[69,460] | tst acc:77.0, f1:77.3, auc:83.8 | trn acc:71.2, f1:65.3, auc:84.1 | loss:0.048
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:74.5, f1:74.6, auc:82.4 | trn acc:71.1, f1:65.1, auc:84.0 | loss:0.048
Average epoch runtime: 4.05 seconds
Total training time: 291.74 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.8, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.8000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:46.9, f1:31.3, auc:45.0 | trn acc:50.0, f1:41.3, auc:51.2 | loss:1.664
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:48.4, f1:37.7, auc:57.2 | trn acc:50.4, f1:40.9, auc:52.3 | loss:1.353
Epoch 1 finished in 4.21 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:52.0, f1:42.3, auc:63.0 | trn acc:53.5, f1:46.4, auc:58.9 | loss:0.813
Epoch 3 finished in 4.20 seconds
[4,368] | tst acc:52.3, f1:41.3, auc:58.1 | trn acc:55.5, f1:48.8, auc:60.2 | loss:0.185
Epoch 4 finished in 4.24 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:56.6, f1:47.4, auc:67.3 | trn acc:55.6, f1:49.0, auc:61.9 | loss:0.075
Epoch 6 finished in 4.25 seconds
[7,388] | tst acc:58.2, f1:47.8, auc:66.8 | trn acc:56.1, f1:49.7, auc:62.5 | loss:0.073
Epoch 7 finished in 4.20 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:61.3, f1:50.3, auc:69.6 | trn acc:56.0, f1:49.6, auc:63.2 | loss:0.070
Epoch 9 finished in 4.19 seconds
[10,408] | tst acc:59.4, f1:50.9, auc:68.1 | trn acc:56.3, f1:49.8, auc:63.7 | loss:0.071
Epoch 10 finished in 4.25 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:58.6, f1:49.5, auc:69.3 | trn acc:56.6, f1:50.2, auc:64.2 | loss:0.070
Epoch 12 finished in 4.24 seconds
[13,428] | tst acc:59.8, f1:53.0, auc:74.4 | trn acc:57.0, f1:50.8, auc:65.1 | loss:0.069
Epoch 13 finished in 4.19 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:55.9, f1:46.4, auc:69.7 | trn acc:57.2, f1:51.0, auc:65.4 | loss:0.067
Epoch 15 finished in 4.19 seconds
[16,448] | tst acc:59.0, f1:47.8, auc:66.8 | trn acc:57.7, f1:51.8, auc:66.2 | loss:0.066
Epoch 16 finished in 4.24 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:55.1, f1:47.5, auc:64.2 | trn acc:57.8, f1:51.6, auc:66.8 | loss:0.066
Epoch 18 finished in 4.24 seconds
[19,468] | tst acc:59.0, f1:49.3, auc:68.2 | trn acc:58.1, f1:52.1, auc:67.5 | loss:0.066
Epoch 19 finished in 4.19 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:58.6, f1:51.4, auc:75.6 | trn acc:58.8, f1:53.1, auc:68.4 | loss:0.064
Epoch 21 finished in 4.19 seconds
[22,488] | tst acc:62.1, f1:54.0, auc:75.5 | trn acc:59.4, f1:53.6, auc:69.4 | loss:0.064
Epoch 22 finished in 4.23 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:65.6, f1:55.6, auc:77.6 | trn acc:59.9, f1:54.1, auc:70.3 | loss:0.063
Epoch 24 finished in 4.25 seconds
[25,508] | tst acc:62.1, f1:55.3, auc:74.9 | trn acc:60.5, f1:55.2, auc:71.0 | loss:0.062
Epoch 25 finished in 4.19 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:63.7, f1:53.7, auc:72.0 | trn acc:61.0, f1:55.5, auc:72.0 | loss:0.061
Epoch 27 finished in 4.19 seconds
[28,528] | tst acc:68.0, f1:59.0, auc:83.7 | trn acc:61.6, f1:55.9, auc:73.2 | loss:0.060
Epoch 28 finished in 4.24 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:65.2, f1:57.4, auc:82.2 | trn acc:62.4, f1:56.7, auc:74.2 | loss:0.059
Epoch 30 finished in 4.24 seconds
[31,548] | tst acc:66.4, f1:57.4, auc:80.4 | trn acc:63.2, f1:57.6, auc:75.1 | loss:0.058
Epoch 31 finished in 4.19 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:65.6, f1:57.7, auc:83.6 | trn acc:64.1, f1:58.6, auc:76.2 | loss:0.057
Epoch 33 finished in 4.19 seconds
[34,568] | tst acc:67.2, f1:59.6, auc:83.2 | trn acc:64.7, f1:58.7, auc:77.1 | loss:0.056
Epoch 34 finished in 4.24 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:63.7, f1:55.5, auc:81.7 | trn acc:65.9, f1:60.4, auc:77.8 | loss:0.056
Epoch 36 finished in 4.24 seconds
[37,588] | tst acc:66.8, f1:57.7, auc:84.2 | trn acc:66.2, f1:60.0, auc:78.9 | loss:0.054
Epoch 37 finished in 4.19 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:68.8, f1:60.8, auc:85.0 | trn acc:67.1, f1:61.1, auc:79.3 | loss:0.054
Epoch 39 finished in 4.20 seconds
[40,608] | tst acc:69.5, f1:61.8, auc:83.8 | trn acc:67.7, f1:61.6, auc:79.9 | loss:0.053
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:71.1, f1:63.0, auc:85.1 | trn acc:68.1, f1:61.7, auc:80.3 | loss:0.052
Epoch 42 finished in 4.22 seconds
[43,628] | tst acc:69.1, f1:61.1, auc:89.0 | trn acc:68.8, f1:62.6, auc:80.9 | loss:0.052
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:70.7, f1:62.7, auc:88.4 | trn acc:69.0, f1:62.5, auc:81.2 | loss:0.051
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:74.6, f1:66.0, auc:89.6 | trn acc:69.8, f1:63.7, auc:81.6 | loss:0.051
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:70.7, f1:62.7, auc:88.3 | trn acc:69.8, f1:63.4, auc:82.0 | loss:0.050
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:73.0, f1:65.3, auc:89.8 | trn acc:70.1, f1:63.6, auc:82.2 | loss:0.050
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:69.5, f1:61.4, auc:89.8 | trn acc:70.2, f1:63.7, auc:82.7 | loss:0.050
Epoch 51 finished in 4.17 seconds
Epoch 52 finished in 3.98 seconds
[53,12] | tst acc:73.4, f1:64.9, auc:90.1 | trn acc:70.4, f1:64.1, auc:82.6 | loss:0.050
Epoch 53 finished in 4.17 seconds
[54,360] | tst acc:69.1, f1:60.3, auc:88.0 | trn acc:70.7, f1:64.3, auc:82.9 | loss:0.049
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:73.8, f1:66.0, auc:91.7 | trn acc:70.8, f1:64.2, auc:83.4 | loss:0.048
Epoch 56 finished in 4.22 seconds
[57,380] | tst acc:73.0, f1:65.0, auc:89.9 | trn acc:70.8, f1:64.5, auc:83.2 | loss:0.049
Epoch 57 finished in 4.17 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:73.4, f1:65.3, auc:90.5 | trn acc:70.9, f1:64.6, auc:83.5 | loss:0.048
Epoch 59 finished in 4.17 seconds
[60,400] | tst acc:70.3, f1:62.0, auc:88.4 | trn acc:70.9, f1:64.6, auc:83.6 | loss:0.048
Epoch 60 finished in 4.22 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:69.9, f1:62.1, auc:89.6 | trn acc:71.1, f1:64.9, auc:83.9 | loss:0.048
Epoch 62 finished in 4.22 seconds
[63,420] | tst acc:73.4, f1:64.9, auc:90.2 | trn acc:71.1, f1:64.9, auc:83.9 | loss:0.048
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:72.3, f1:64.0, auc:89.5 | trn acc:71.0, f1:64.7, auc:83.7 | loss:0.048
Epoch 65 finished in 4.17 seconds
[66,440] | tst acc:74.6, f1:66.7, auc:88.5 | trn acc:71.2, f1:64.8, auc:84.1 | loss:0.047
Epoch 66 finished in 4.22 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:73.4, f1:66.0, auc:91.2 | trn acc:71.2, f1:65.0, auc:83.9 | loss:0.048
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:72.7, f1:64.6, auc:91.6 | trn acc:71.0, f1:64.6, auc:83.9 | loss:0.048
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:75.0, f1:67.0, auc:90.4 | trn acc:71.4, f1:65.4, auc:84.0 | loss:0.048
Average epoch runtime: 4.07 seconds
Total training time: 293.11 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.8, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.8000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.7, f1:11.7, auc:57.9 | trn acc:47.3, f1:40.7, auc:47.3 | loss:1.889
Epoch 0 finished in 4.17 seconds
[1,348] | tst acc:45.3, f1:12.8, auc:62.3 | trn acc:50.5, f1:40.3, auc:52.4 | loss:1.338
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:46.3, f1:13.0, auc:66.4 | trn acc:53.3, f1:45.2, auc:58.8 | loss:0.802
Epoch 3 finished in 4.19 seconds
[4,368] | tst acc:51.3, f1:17.0, auc:81.6 | trn acc:55.5, f1:47.9, auc:60.7 | loss:0.184
Epoch 4 finished in 4.24 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:45.7, f1:11.9, auc:68.6 | trn acc:55.7, f1:48.2, auc:62.3 | loss:0.074
Epoch 6 finished in 4.24 seconds
[7,388] | tst acc:50.7, f1:14.0, auc:77.1 | trn acc:56.3, f1:48.8, auc:63.4 | loss:0.071
Epoch 7 finished in 4.19 seconds
Epoch 8 finished in 4.02 seconds
[9,60] | tst acc:50.3, f1:15.8, auc:81.2 | trn acc:56.2, f1:49.1, auc:63.6 | loss:0.070
Epoch 9 finished in 4.18 seconds
[10,408] | tst acc:45.0, f1:13.6, auc:76.0 | trn acc:56.4, f1:49.2, auc:64.0 | loss:0.070
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:46.0, f1:10.0, auc:62.0 | trn acc:56.7, f1:49.2, auc:64.8 | loss:0.068
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:43.7, f1:11.5, auc:72.3 | trn acc:57.1, f1:50.2, auc:65.3 | loss:0.068
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:49.3, f1:16.5, auc:81.4 | trn acc:57.2, f1:50.2, auc:65.9 | loss:0.068
Epoch 15 finished in 4.17 seconds
[16,448] | tst acc:48.3, f1:13.4, auc:69.1 | trn acc:57.6, f1:50.7, auc:66.3 | loss:0.067
Epoch 16 finished in 4.21 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:52.0, f1:15.3, auc:78.7 | trn acc:57.9, f1:51.3, auc:67.0 | loss:0.066
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:51.3, f1:14.1, auc:76.2 | trn acc:58.2, f1:51.3, auc:67.6 | loss:0.065
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 4.00 seconds
[21,140] | tst acc:47.0, f1:15.0, auc:83.5 | trn acc:58.6, f1:51.7, auc:68.6 | loss:0.063
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:48.3, f1:15.3, auc:74.7 | trn acc:59.3, f1:52.8, auc:69.3 | loss:0.063
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:51.0, f1:16.9, auc:82.2 | trn acc:59.8, f1:53.2, auc:70.2 | loss:0.063
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:49.7, f1:14.7, auc:77.2 | trn acc:60.3, f1:53.7, auc:71.1 | loss:0.061
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 4.00 seconds
[27,180] | tst acc:53.7, f1:16.8, auc:73.8 | trn acc:61.2, f1:54.8, auc:72.2 | loss:0.060
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:51.7, f1:16.2, auc:84.4 | trn acc:61.7, f1:55.1, auc:73.2 | loss:0.060
Epoch 28 finished in 4.21 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:52.7, f1:14.5, auc:77.8 | trn acc:62.5, f1:56.0, auc:74.1 | loss:0.058
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:51.3, f1:16.1, auc:83.1 | trn acc:63.5, f1:56.7, auc:75.3 | loss:0.057
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:51.3, f1:16.1, auc:83.9 | trn acc:64.3, f1:57.8, auc:76.2 | loss:0.057
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:53.7, f1:15.8, auc:79.8 | trn acc:65.2, f1:58.5, auc:77.3 | loss:0.055
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:54.3, f1:16.0, auc:81.5 | trn acc:65.8, f1:58.9, auc:77.9 | loss:0.055
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:55.0, f1:17.2, auc:82.7 | trn acc:66.8, f1:59.8, auc:79.0 | loss:0.054
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:55.0, f1:17.2, auc:88.3 | trn acc:67.3, f1:59.8, auc:79.5 | loss:0.053
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:55.3, f1:17.3, auc:82.6 | trn acc:68.4, f1:61.6, auc:80.0 | loss:0.053
Epoch 40 finished in 4.21 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:58.3, f1:18.3, auc:82.2 | trn acc:68.6, f1:61.4, auc:80.7 | loss:0.052
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:56.3, f1:17.6, auc:84.4 | trn acc:69.2, f1:61.9, auc:81.0 | loss:0.051
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 4.00 seconds
[45,300] | tst acc:54.7, f1:18.1, auc:83.5 | trn acc:69.7, f1:62.5, auc:81.5 | loss:0.051
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:54.7, f1:17.1, auc:83.9 | trn acc:70.1, f1:62.5, auc:82.0 | loss:0.050
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:57.0, f1:18.9, auc:84.7 | trn acc:70.4, f1:62.9, auc:82.3 | loss:0.050
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:55.0, f1:17.2, auc:84.8 | trn acc:70.6, f1:63.1, auc:82.4 | loss:0.050
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:59.0, f1:19.6, auc:87.1 | trn acc:70.5, f1:62.6, auc:82.9 | loss:0.049
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:58.3, f1:18.3, auc:84.5 | trn acc:71.4, f1:64.4, auc:82.9 | loss:0.049
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:58.3, f1:18.3, auc:86.7 | trn acc:71.2, f1:63.7, auc:83.4 | loss:0.048
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:58.3, f1:18.3, auc:85.8 | trn acc:71.1, f1:63.6, auc:83.2 | loss:0.048
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:57.3, f1:17.9, auc:84.5 | trn acc:71.3, f1:63.8, auc:83.7 | loss:0.047
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:57.7, f1:19.1, auc:87.9 | trn acc:71.4, f1:64.1, auc:83.5 | loss:0.048
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:56.3, f1:17.6, auc:85.5 | trn acc:71.7, f1:64.6, auc:83.7 | loss:0.048
Epoch 60 finished in 4.21 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:57.3, f1:17.9, auc:85.3 | trn acc:71.7, f1:64.3, auc:84.1 | loss:0.047
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:56.7, f1:16.7, auc:84.8 | trn acc:71.5, f1:64.0, auc:84.1 | loss:0.047
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:56.7, f1:17.7, auc:83.2 | trn acc:71.7, f1:64.4, auc:84.1 | loss:0.047
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:57.7, f1:18.1, auc:88.1 | trn acc:71.5, f1:64.1, auc:84.2 | loss:0.047
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:56.3, f1:17.6, auc:87.2 | trn acc:71.8, f1:64.5, auc:84.2 | loss:0.047
Epoch 68 finished in 4.21 seconds
[69,460] | tst acc:59.3, f1:19.7, auc:86.7 | trn acc:71.7, f1:64.4, auc:84.1 | loss:0.047
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:59.0, f1:18.5, auc:88.1 | trn acc:71.7, f1:64.4, auc:84.4 | loss:0.046
Average epoch runtime: 4.06 seconds
Total training time: 292.21 GPU seconds
alpha = 0.9
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.9, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.9000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:47.5, f1:24.1, auc:50.5 | trn acc:49.5, f1:44.2, auc:51.0 | loss:1.619
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:45.2, f1:28.9, auc:57.1 | trn acc:50.2, f1:41.3, auc:52.6 | loss:1.163
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:45.4, f1:30.1, auc:59.3 | trn acc:52.0, f1:47.0, auc:58.8 | loss:0.654
Epoch 3 finished in 4.17 seconds
[4,368] | tst acc:43.5, f1:30.9, auc:56.0 | trn acc:53.2, f1:49.8, auc:61.2 | loss:0.319
Epoch 4 finished in 4.22 seconds
Epoch 5 finished in 3.96 seconds
[6,40] | tst acc:48.0, f1:32.7, auc:58.8 | trn acc:53.5, f1:50.2, auc:63.5 | loss:0.062
Epoch 6 finished in 4.22 seconds
[7,388] | tst acc:42.2, f1:28.9, auc:56.1 | trn acc:53.9, f1:51.0, auc:64.6 | loss:0.060
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:45.2, f1:31.2, auc:56.9 | trn acc:53.7, f1:51.1, auc:65.4 | loss:0.057
Epoch 9 finished in 4.17 seconds
[10,408] | tst acc:44.3, f1:29.3, auc:60.0 | trn acc:53.9, f1:51.2, auc:65.8 | loss:0.057
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.94 seconds
[12,80] | tst acc:44.5, f1:32.0, auc:57.9 | trn acc:54.1, f1:51.6, auc:66.6 | loss:0.055
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:42.4, f1:31.9, auc:57.9 | trn acc:54.1, f1:51.7, auc:66.9 | loss:0.055
Epoch 13 finished in 4.15 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:46.3, f1:31.6, auc:57.5 | trn acc:54.4, f1:52.4, auc:67.6 | loss:0.055
Epoch 15 finished in 4.15 seconds
[16,448] | tst acc:40.7, f1:27.3, auc:52.9 | trn acc:54.5, f1:52.4, auc:68.2 | loss:0.053
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.94 seconds
[18,120] | tst acc:48.2, f1:33.5, auc:59.9 | trn acc:54.6, f1:52.8, auc:68.6 | loss:0.053
Epoch 18 finished in 4.19 seconds
[19,468] | tst acc:46.0, f1:33.3, auc:59.9 | trn acc:54.7, f1:53.1, auc:69.4 | loss:0.051
Epoch 19 finished in 4.15 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:42.4, f1:30.5, auc:55.6 | trn acc:55.1, f1:53.7, auc:70.0 | loss:0.051
Epoch 21 finished in 4.15 seconds
[22,488] | tst acc:40.0, f1:28.9, auc:53.8 | trn acc:55.0, f1:53.6, auc:70.7 | loss:0.049
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.94 seconds
[24,160] | tst acc:44.1, f1:32.2, auc:62.4 | trn acc:55.4, f1:54.0, auc:71.4 | loss:0.048
Epoch 24 finished in 4.20 seconds
[25,508] | tst acc:43.3, f1:32.2, auc:59.9 | trn acc:55.5, f1:54.6, auc:72.3 | loss:0.048
Epoch 25 finished in 4.15 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:45.4, f1:33.4, auc:60.7 | trn acc:55.5, f1:54.5, auc:72.9 | loss:0.046
Epoch 27 finished in 4.15 seconds
[28,528] | tst acc:43.0, f1:31.1, auc:59.4 | trn acc:55.7, f1:55.0, auc:73.4 | loss:0.046
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.94 seconds
[30,200] | tst acc:45.6, f1:33.9, auc:62.9 | trn acc:56.1, f1:55.4, auc:74.6 | loss:0.045
Epoch 30 finished in 4.20 seconds
[31,548] | tst acc:40.7, f1:30.6, auc:59.5 | trn acc:56.3, f1:55.6, auc:75.2 | loss:0.044
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:42.2, f1:30.8, auc:59.4 | trn acc:56.4, f1:55.9, auc:76.0 | loss:0.043
Epoch 33 finished in 4.15 seconds
[34,568] | tst acc:45.0, f1:35.3, auc:64.8 | trn acc:56.7, f1:56.1, auc:76.7 | loss:0.042
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.94 seconds
[36,240] | tst acc:46.0, f1:34.7, auc:65.5 | trn acc:56.9, f1:56.3, auc:77.5 | loss:0.041
Epoch 36 finished in 4.20 seconds
[37,588] | tst acc:41.3, f1:32.8, auc:64.5 | trn acc:57.1, f1:56.7, auc:77.7 | loss:0.041
Epoch 37 finished in 4.15 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:45.0, f1:33.9, auc:65.8 | trn acc:57.5, f1:57.1, auc:78.4 | loss:0.040
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:43.3, f1:32.6, auc:64.1 | trn acc:57.9, f1:57.3, auc:79.1 | loss:0.039
Epoch 40 finished in 4.19 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:46.3, f1:34.5, auc:67.9 | trn acc:57.9, f1:57.4, auc:79.3 | loss:0.039
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:44.3, f1:35.6, auc:65.3 | trn acc:58.3, f1:57.8, auc:79.9 | loss:0.038
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:42.6, f1:32.3, auc:63.7 | trn acc:58.5, f1:58.0, auc:80.3 | loss:0.038
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:46.0, f1:36.4, auc:66.8 | trn acc:58.8, f1:58.3, auc:80.9 | loss:0.038
Epoch 46 finished in 4.19 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:45.4, f1:35.4, auc:65.5 | trn acc:59.0, f1:58.3, auc:81.2 | loss:0.037
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:44.8, f1:34.5, auc:68.5 | trn acc:59.1, f1:58.4, auc:81.4 | loss:0.037
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:44.3, f1:35.0, auc:65.4 | trn acc:59.1, f1:58.4, auc:81.6 | loss:0.037
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:44.8, f1:33.8, auc:67.3 | trn acc:59.4, f1:58.7, auc:82.1 | loss:0.036
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:44.3, f1:35.3, auc:69.7 | trn acc:59.3, f1:58.6, auc:82.4 | loss:0.036
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:46.0, f1:36.0, auc:69.5 | trn acc:59.5, f1:59.0, auc:82.6 | loss:0.036
Epoch 56 finished in 4.19 seconds
[57,380] | tst acc:45.0, f1:34.9, auc:69.3 | trn acc:59.3, f1:58.5, auc:82.8 | loss:0.035
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:47.3, f1:35.9, auc:70.2 | trn acc:59.8, f1:59.3, auc:82.8 | loss:0.035
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:45.2, f1:34.4, auc:71.6 | trn acc:59.5, f1:58.7, auc:83.3 | loss:0.035
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:45.2, f1:35.4, auc:70.7 | trn acc:59.9, f1:59.3, auc:83.2 | loss:0.035
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:43.0, f1:34.5, auc:69.5 | trn acc:59.5, f1:58.8, auc:83.5 | loss:0.034
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:46.3, f1:35.8, auc:73.5 | trn acc:59.9, f1:59.5, auc:83.2 | loss:0.035
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:48.0, f1:37.2, auc:71.2 | trn acc:59.6, f1:59.0, auc:83.6 | loss:0.035
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:46.0, f1:35.4, auc:70.8 | trn acc:59.3, f1:58.6, auc:83.6 | loss:0.034
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:43.9, f1:34.2, auc:71.4 | trn acc:59.7, f1:59.2, auc:83.5 | loss:0.034
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:46.7, f1:35.3, auc:72.2 | trn acc:59.8, f1:59.4, auc:83.8 | loss:0.034
Average epoch runtime: 4.05 seconds
Total training time: 291.52 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.9, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.9000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:51.9, f1:44.7, auc:53.0 | trn acc:49.1, f1:38.6, auc:49.8 | loss:1.386
Epoch 0 finished in 4.16 seconds
[1,348] | tst acc:51.7, f1:50.7, auc:55.8 | trn acc:50.5, f1:41.9, auc:52.7 | loss:1.168
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:54.9, f1:54.1, auc:60.0 | trn acc:51.9, f1:46.9, auc:58.4 | loss:0.657
Epoch 3 finished in 4.19 seconds
[4,368] | tst acc:49.7, f1:50.3, auc:51.6 | trn acc:53.0, f1:50.0, auc:60.6 | loss:0.323
Epoch 4 finished in 4.23 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:57.3, f1:57.1, auc:61.7 | trn acc:53.2, f1:50.2, auc:62.3 | loss:0.061
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:52.8, f1:53.0, auc:60.4 | trn acc:53.5, f1:50.7, auc:63.5 | loss:0.058
Epoch 7 finished in 4.19 seconds
Epoch 8 finished in 4.02 seconds
[9,60] | tst acc:55.8, f1:55.3, auc:60.0 | trn acc:53.5, f1:51.1, auc:63.8 | loss:0.059
Epoch 9 finished in 4.17 seconds
[10,408] | tst acc:55.3, f1:56.0, auc:63.4 | trn acc:53.7, f1:51.3, auc:64.6 | loss:0.058
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:52.8, f1:52.4, auc:56.1 | trn acc:54.0, f1:51.7, auc:65.5 | loss:0.057
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:52.1, f1:54.1, auc:60.9 | trn acc:54.3, f1:52.2, auc:66.1 | loss:0.056
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:56.2, f1:56.5, auc:65.5 | trn acc:54.0, f1:52.0, auc:66.5 | loss:0.054
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:53.5, f1:54.2, auc:60.0 | trn acc:54.3, f1:52.4, auc:67.2 | loss:0.054
Epoch 16 finished in 4.21 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:48.3, f1:48.5, auc:59.2 | trn acc:54.4, f1:53.0, auc:67.7 | loss:0.052
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:55.5, f1:56.7, auc:62.2 | trn acc:54.4, f1:52.9, auc:68.4 | loss:0.051
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:54.4, f1:55.7, auc:62.2 | trn acc:54.7, f1:53.4, auc:69.2 | loss:0.051
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:51.5, f1:54.4, auc:62.8 | trn acc:55.0, f1:54.0, auc:69.7 | loss:0.050
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.94 seconds
[24,160] | tst acc:55.3, f1:58.1, auc:65.6 | trn acc:55.3, f1:54.2, auc:70.7 | loss:0.049
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:53.0, f1:55.2, auc:60.1 | trn acc:55.4, f1:54.7, auc:71.5 | loss:0.048
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:55.1, f1:56.3, auc:62.8 | trn acc:55.4, f1:54.5, auc:72.3 | loss:0.046
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:58.7, f1:60.3, auc:67.8 | trn acc:55.5, f1:55.0, auc:73.1 | loss:0.046
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.94 seconds
[30,200] | tst acc:56.0, f1:57.7, auc:66.4 | trn acc:56.2, f1:56.0, auc:73.9 | loss:0.045
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:55.8, f1:58.8, auc:68.6 | trn acc:56.0, f1:55.6, auc:74.7 | loss:0.044
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:57.3, f1:59.4, auc:69.8 | trn acc:56.1, f1:55.9, auc:75.3 | loss:0.043
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:56.4, f1:59.2, auc:68.1 | trn acc:56.4, f1:56.1, auc:76.3 | loss:0.042
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:59.1, f1:60.0, auc:70.0 | trn acc:57.0, f1:56.9, auc:76.9 | loss:0.042
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:56.0, f1:59.1, auc:70.3 | trn acc:56.9, f1:56.6, auc:77.3 | loss:0.041
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:56.0, f1:57.9, auc:67.9 | trn acc:57.1, f1:56.7, auc:78.3 | loss:0.040
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:60.3, f1:61.9, auc:71.4 | trn acc:57.8, f1:57.6, auc:78.7 | loss:0.040
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:58.2, f1:59.3, auc:69.9 | trn acc:57.9, f1:57.7, auc:79.3 | loss:0.039
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:57.1, f1:60.1, auc:73.4 | trn acc:58.2, f1:58.0, auc:79.9 | loss:0.038
Epoch 43 finished in 4.16 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:59.1, f1:61.6, auc:72.6 | trn acc:58.4, f1:58.1, auc:80.3 | loss:0.038
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:57.8, f1:60.5, auc:74.6 | trn acc:58.5, f1:58.2, auc:80.6 | loss:0.037
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:56.4, f1:59.4, auc:71.8 | trn acc:58.6, f1:58.1, auc:81.1 | loss:0.037
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:58.7, f1:61.3, auc:73.7 | trn acc:59.0, f1:58.8, auc:81.3 | loss:0.037
Epoch 49 finished in 4.16 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:58.5, f1:60.7, auc:72.6 | trn acc:59.1, f1:58.7, auc:81.7 | loss:0.036
Epoch 51 finished in 4.17 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:56.4, f1:58.5, auc:73.9 | trn acc:58.9, f1:58.6, auc:81.8 | loss:0.036
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:58.2, f1:61.2, auc:75.0 | trn acc:59.2, f1:58.9, auc:82.2 | loss:0.036
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:56.9, f1:59.8, auc:73.6 | trn acc:59.2, f1:58.8, auc:82.2 | loss:0.036
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:58.7, f1:61.5, auc:75.1 | trn acc:59.1, f1:58.8, auc:82.4 | loss:0.036
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:61.9, f1:63.3, auc:73.9 | trn acc:59.4, f1:59.2, auc:82.8 | loss:0.035
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:59.4, f1:61.4, auc:75.9 | trn acc:59.1, f1:58.7, auc:82.8 | loss:0.035
Epoch 60 finished in 4.21 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:59.8, f1:62.3, auc:75.1 | trn acc:59.7, f1:59.5, auc:83.0 | loss:0.035
Epoch 62 finished in 4.21 seconds
[63,420] | tst acc:57.6, f1:61.0, auc:76.2 | trn acc:59.2, f1:58.9, auc:83.1 | loss:0.035
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:59.6, f1:62.3, auc:75.2 | trn acc:59.4, f1:59.1, auc:83.4 | loss:0.035
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:58.2, f1:60.9, auc:75.2 | trn acc:59.8, f1:59.6, auc:83.3 | loss:0.035
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:59.1, f1:61.4, auc:76.2 | trn acc:59.4, f1:59.2, auc:83.2 | loss:0.035
Epoch 68 finished in 4.21 seconds
[69,460] | tst acc:57.8, f1:60.5, auc:74.3 | trn acc:59.2, f1:58.8, auc:83.4 | loss:0.035
Epoch 69 finished in 4.16 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:58.9, f1:61.1, auc:74.0 | trn acc:59.6, f1:59.4, auc:83.4 | loss:0.035
Average epoch runtime: 4.06 seconds
Total training time: 292.12 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=0.9, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(0.9000)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.2, f1:24.5, auc:53.5 | trn acc:50.1, f1:44.7, auc:50.3 | loss:1.633
Epoch 0 finished in 4.17 seconds
[1,348] | tst acc:47.2, f1:29.2, auc:52.9 | trn acc:50.2, f1:40.5, auc:52.5 | loss:1.139
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:46.2, f1:32.4, auc:61.7 | trn acc:51.7, f1:45.9, auc:58.6 | loss:0.646
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:48.2, f1:34.9, auc:63.4 | trn acc:52.6, f1:48.2, auc:61.0 | loss:0.319
Epoch 4 finished in 4.23 seconds
Epoch 5 finished in 3.96 seconds
[6,40] | tst acc:51.2, f1:34.5, auc:67.6 | trn acc:53.4, f1:49.6, auc:63.2 | loss:0.059
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:49.2, f1:34.2, auc:65.6 | trn acc:53.5, f1:49.7, auc:64.2 | loss:0.058
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:48.2, f1:33.2, auc:63.3 | trn acc:53.3, f1:49.7, auc:64.6 | loss:0.055
Epoch 9 finished in 4.17 seconds
[10,408] | tst acc:49.8, f1:36.1, auc:73.5 | trn acc:53.6, f1:50.3, auc:65.2 | loss:0.056
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.96 seconds
[12,80] | tst acc:48.2, f1:34.3, auc:66.9 | trn acc:53.7, f1:50.3, auc:65.9 | loss:0.054
Epoch 12 finished in 4.23 seconds
[13,428] | tst acc:45.5, f1:34.3, auc:65.4 | trn acc:53.6, f1:50.1, auc:66.5 | loss:0.053
Epoch 13 finished in 4.18 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:46.5, f1:32.5, auc:64.2 | trn acc:54.1, f1:51.4, auc:66.6 | loss:0.053
Epoch 15 finished in 4.18 seconds
[16,448] | tst acc:44.6, f1:33.9, auc:67.1 | trn acc:54.1, f1:51.1, auc:67.6 | loss:0.052
Epoch 16 finished in 4.23 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:51.2, f1:34.5, auc:63.6 | trn acc:54.2, f1:51.5, auc:68.3 | loss:0.051
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:48.2, f1:36.9, auc:73.6 | trn acc:54.1, f1:51.5, auc:68.6 | loss:0.050
Epoch 19 finished in 4.18 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:46.2, f1:34.5, auc:66.5 | trn acc:54.6, f1:52.2, auc:69.6 | loss:0.049
Epoch 21 finished in 4.17 seconds
[22,488] | tst acc:44.9, f1:35.5, auc:69.6 | trn acc:54.5, f1:52.1, auc:70.2 | loss:0.048
Epoch 22 finished in 4.22 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:46.5, f1:33.6, auc:72.5 | trn acc:54.9, f1:52.9, auc:71.1 | loss:0.047
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:49.5, f1:38.1, auc:77.5 | trn acc:55.3, f1:53.7, auc:71.6 | loss:0.047
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:45.9, f1:33.9, auc:67.7 | trn acc:55.0, f1:53.2, auc:72.4 | loss:0.046
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:46.9, f1:36.4, auc:72.2 | trn acc:55.3, f1:53.8, auc:73.3 | loss:0.045
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:49.5, f1:38.6, auc:76.6 | trn acc:55.5, f1:54.0, auc:74.1 | loss:0.044
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:45.5, f1:35.8, auc:72.3 | trn acc:56.0, f1:54.8, auc:74.7 | loss:0.044
Epoch 31 finished in 4.16 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:46.9, f1:36.4, auc:75.5 | trn acc:55.9, f1:54.6, auc:75.7 | loss:0.042
Epoch 33 finished in 4.16 seconds
[34,568] | tst acc:47.2, f1:38.0, auc:75.3 | trn acc:56.1, f1:54.6, auc:76.5 | loss:0.041
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:49.5, f1:39.0, auc:74.0 | trn acc:56.3, f1:54.9, auc:77.1 | loss:0.041
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:45.5, f1:35.3, auc:76.9 | trn acc:57.2, f1:56.2, auc:77.6 | loss:0.041
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:45.5, f1:37.3, auc:80.0 | trn acc:57.0, f1:55.6, auc:78.4 | loss:0.039
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:46.2, f1:36.6, auc:76.9 | trn acc:57.6, f1:56.5, auc:78.9 | loss:0.039
Epoch 40 finished in 4.21 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:53.5, f1:41.0, auc:78.1 | trn acc:57.5, f1:56.1, auc:79.2 | loss:0.039
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:47.2, f1:38.9, auc:75.3 | trn acc:58.2, f1:56.9, auc:79.7 | loss:0.038
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 4.00 seconds
[45,300] | tst acc:50.2, f1:39.4, auc:79.8 | trn acc:58.3, f1:56.7, auc:80.3 | loss:0.037
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:45.9, f1:36.4, auc:77.1 | trn acc:58.7, f1:57.3, auc:80.7 | loss:0.037
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:48.8, f1:39.2, auc:80.6 | trn acc:58.9, f1:57.2, auc:81.1 | loss:0.037
Epoch 48 finished in 4.22 seconds
[49,668] | tst acc:48.5, f1:40.0, auc:82.6 | trn acc:59.3, f1:57.8, auc:81.3 | loss:0.037
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.01 seconds
[51,340] | tst acc:45.2, f1:37.1, auc:77.0 | trn acc:59.0, f1:57.4, auc:81.7 | loss:0.036
Epoch 51 finished in 4.17 seconds
Epoch 52 finished in 4.00 seconds
[53,12] | tst acc:49.5, f1:39.0, auc:73.9 | trn acc:59.6, f1:58.2, auc:81.9 | loss:0.036
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:46.2, f1:37.5, auc:79.0 | trn acc:59.6, f1:58.1, auc:82.4 | loss:0.035
Epoch 54 finished in 4.21 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:49.2, f1:37.9, auc:78.6 | trn acc:59.5, f1:57.9, auc:82.4 | loss:0.035
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:48.8, f1:39.7, auc:82.2 | trn acc:59.6, f1:57.9, auc:82.5 | loss:0.035
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:50.8, f1:40.2, auc:83.5 | trn acc:59.8, f1:58.4, auc:83.0 | loss:0.035
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:48.5, f1:38.6, auc:78.8 | trn acc:59.6, f1:58.0, auc:82.9 | loss:0.035
Epoch 60 finished in 4.21 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:47.5, f1:38.1, auc:80.1 | trn acc:59.6, f1:58.0, auc:83.1 | loss:0.035
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:46.5, f1:38.2, auc:80.3 | trn acc:59.8, f1:58.4, auc:83.2 | loss:0.035
Epoch 63 finished in 4.16 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:51.2, f1:40.3, auc:80.0 | trn acc:60.0, f1:58.6, auc:83.3 | loss:0.035
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:50.2, f1:40.3, auc:79.8 | trn acc:59.7, f1:58.1, auc:83.5 | loss:0.034
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:49.5, f1:39.5, auc:81.6 | trn acc:59.6, f1:58.1, auc:83.2 | loss:0.035
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:49.8, f1:39.2, auc:82.3 | trn acc:59.8, f1:58.1, auc:83.8 | loss:0.034
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:49.2, f1:38.9, auc:83.4 | trn acc:60.1, f1:58.8, auc:83.3 | loss:0.035
Average epoch runtime: 4.06 seconds
Total training time: 292.36 GPU seconds
alpha = 1.0
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=1.0, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(1.)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.4, f1:32.1, auc:50.1 | trn acc:48.6, f1:38.0, auc:50.2 | loss:1.155
Epoch 0 finished in 4.18 seconds
[1,348] | tst acc:48.6, f1:39.6, auc:54.2 | trn acc:49.8, f1:41.6, auc:52.4 | loss:0.954
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:45.2, f1:39.3, auc:56.3 | trn acc:50.1, f1:47.2, auc:57.8 | loss:0.420
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:40.8, f1:38.9, auc:57.7 | trn acc:49.6, f1:49.8, auc:61.5 | loss:0.217
Epoch 4 finished in 4.22 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:43.9, f1:41.8, auc:62.8 | trn acc:48.3, f1:50.7, auc:62.9 | loss:0.143
Epoch 6 finished in 4.23 seconds
[7,388] | tst acc:38.8, f1:40.8, auc:64.8 | trn acc:47.0, f1:50.7, auc:63.6 | loss:0.073
Epoch 7 finished in 4.17 seconds
Epoch 8 finished in 4.00 seconds
[9,60] | tst acc:39.7, f1:42.4, auc:66.9 | trn acc:46.7, f1:51.2, auc:63.9 | loss:0.026
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:42.4, f1:42.5, auc:66.0 | trn acc:46.6, f1:51.3, auc:64.4 | loss:0.024
Epoch 10 finished in 4.20 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:41.5, f1:42.4, auc:65.1 | trn acc:46.4, f1:51.2, auc:65.0 | loss:0.021
Epoch 12 finished in 4.20 seconds
[13,428] | tst acc:39.2, f1:41.2, auc:63.4 | trn acc:46.2, f1:51.4, auc:65.2 | loss:0.020
Epoch 13 finished in 4.15 seconds
Epoch 14 finished in 4.00 seconds
[15,100] | tst acc:40.4, f1:42.4, auc:68.5 | trn acc:45.9, f1:51.4, auc:65.6 | loss:0.019
Epoch 15 finished in 4.15 seconds
[16,448] | tst acc:36.6, f1:40.9, auc:67.2 | trn acc:45.3, f1:51.1, auc:66.0 | loss:0.018
Epoch 16 finished in 4.20 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:37.9, f1:41.9, auc:67.6 | trn acc:45.4, f1:51.7, auc:66.3 | loss:0.017
Epoch 18 finished in 4.20 seconds
[19,468] | tst acc:36.8, f1:41.7, auc:68.9 | trn acc:44.2, f1:50.8, auc:66.3 | loss:0.015
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 3.99 seconds
[21,140] | tst acc:39.5, f1:42.8, auc:68.6 | trn acc:44.1, f1:51.3, auc:66.5 | loss:0.014
Epoch 21 finished in 4.16 seconds
[22,488] | tst acc:37.5, f1:42.7, auc:68.8 | trn acc:43.3, f1:50.8, auc:66.6 | loss:0.012
Epoch 22 finished in 4.20 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:35.9, f1:41.1, auc:68.5 | trn acc:43.4, f1:51.5, auc:67.0 | loss:0.012
Epoch 24 finished in 4.21 seconds
[25,508] | tst acc:32.8, f1:40.2, auc:64.1 | trn acc:41.8, f1:50.3, auc:66.9 | loss:0.010
Epoch 25 finished in 4.16 seconds
Epoch 26 finished in 3.99 seconds
[27,180] | tst acc:37.0, f1:42.5, auc:67.4 | trn acc:41.4, f1:50.7, auc:66.9 | loss:0.009
Epoch 27 finished in 4.16 seconds
[28,528] | tst acc:31.7, f1:40.5, auc:65.6 | trn acc:40.6, f1:50.3, auc:67.0 | loss:0.007
Epoch 28 finished in 4.20 seconds
Epoch 29 finished in 3.95 seconds
[30,200] | tst acc:32.4, f1:39.8, auc:64.3 | trn acc:39.9, f1:50.2, auc:66.9 | loss:0.007
Epoch 30 finished in 4.21 seconds
[31,548] | tst acc:31.0, f1:40.5, auc:70.3 | trn acc:39.0, f1:49.9, auc:66.8 | loss:0.006
Epoch 31 finished in 4.15 seconds
Epoch 32 finished in 3.99 seconds
[33,220] | tst acc:29.9, f1:39.7, auc:67.5 | trn acc:38.3, f1:49.9, auc:66.8 | loss:0.005
Epoch 33 finished in 4.15 seconds
[34,568] | tst acc:31.5, f1:40.7, auc:66.1 | trn acc:37.5, f1:49.5, auc:66.7 | loss:0.004
Epoch 34 finished in 4.20 seconds
Epoch 35 finished in 3.95 seconds
[36,240] | tst acc:30.6, f1:40.2, auc:64.9 | trn acc:36.7, f1:49.2, auc:66.6 | loss:0.004
Epoch 36 finished in 4.21 seconds
[37,588] | tst acc:28.2, f1:39.6, auc:66.1 | trn acc:36.2, f1:49.1, auc:66.5 | loss:0.003
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:27.5, f1:39.1, auc:68.3 | trn acc:35.6, f1:48.9, auc:66.4 | loss:0.003
Epoch 39 finished in 4.16 seconds
[40,608] | tst acc:28.2, f1:39.6, auc:66.4 | trn acc:34.7, f1:48.3, auc:66.7 | loss:0.002
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.95 seconds
[42,280] | tst acc:26.8, f1:39.1, auc:65.9 | trn acc:34.6, f1:48.6, auc:66.2 | loss:0.002
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:27.5, f1:39.3, auc:68.4 | trn acc:34.4, f1:48.6, auc:66.4 | loss:0.002
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:26.8, f1:39.1, auc:64.2 | trn acc:34.1, f1:48.5, auc:66.3 | loss:0.002
Epoch 45 finished in 4.16 seconds
[46,648] | tst acc:26.6, f1:39.0, auc:68.1 | trn acc:33.6, f1:48.2, auc:66.5 | loss:0.002
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.95 seconds
[48,320] | tst acc:26.2, f1:38.9, auc:65.9 | trn acc:33.2, f1:48.0, auc:66.7 | loss:0.002
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:25.9, f1:38.8, auc:68.7 | trn acc:33.4, f1:48.4, auc:66.8 | loss:0.002
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:25.3, f1:38.6, auc:61.9 | trn acc:33.0, f1:48.2, auc:67.1 | loss:0.002
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 4.00 seconds
[53,12] | tst acc:24.4, f1:38.3, auc:66.2 | trn acc:32.7, f1:47.9, auc:67.4 | loss:0.001
Epoch 53 finished in 4.16 seconds
[54,360] | tst acc:24.8, f1:38.5, auc:62.2 | trn acc:32.8, f1:48.2, auc:67.5 | loss:0.001
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.95 seconds
[56,32] | tst acc:24.4, f1:38.3, auc:64.9 | trn acc:32.5, f1:48.0, auc:67.6 | loss:0.001
Epoch 56 finished in 4.20 seconds
[57,380] | tst acc:24.2, f1:38.3, auc:66.0 | trn acc:32.1, f1:47.6, auc:68.1 | loss:0.001
Epoch 57 finished in 4.16 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:23.9, f1:38.2, auc:74.1 | trn acc:32.2, f1:47.9, auc:68.3 | loss:0.001
Epoch 59 finished in 4.16 seconds
[60,400] | tst acc:24.8, f1:38.5, auc:72.1 | trn acc:32.1, f1:47.8, auc:68.5 | loss:0.001
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.95 seconds
[62,72] | tst acc:24.8, f1:38.5, auc:72.7 | trn acc:31.9, f1:47.7, auc:68.9 | loss:0.001
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:23.7, f1:38.1, auc:68.2 | trn acc:32.2, f1:48.0, auc:69.0 | loss:0.001
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:24.2, f1:38.3, auc:69.6 | trn acc:31.8, f1:47.6, auc:69.1 | loss:0.001
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:24.6, f1:38.4, auc:65.8 | trn acc:32.2, f1:48.1, auc:69.4 | loss:0.001
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.95 seconds
[68,112] | tst acc:24.4, f1:38.3, auc:67.7 | trn acc:31.7, f1:47.6, auc:69.2 | loss:0.001
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:23.9, f1:38.2, auc:68.1 | trn acc:31.9, f1:47.8, auc:69.6 | loss:0.001
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:24.4, f1:38.3, auc:67.8 | trn acc:31.6, f1:47.5, auc:69.3 | loss:0.001
Average epoch runtime: 4.05 seconds
Total training time: 291.94 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=1.0, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(1.)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:49.9, f1:46.5, auc:50.7 | trn acc:49.3, f1:44.2, auc:50.8 | loss:1.467
Epoch 0 finished in 4.15 seconds
[1,348] | tst acc:54.1, f1:56.5, auc:57.5 | trn acc:49.9, f1:41.5, auc:52.5 | loss:0.948
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.02 seconds
[3,20] | tst acc:54.1, f1:58.1, auc:60.5 | trn acc:50.2, f1:47.1, auc:58.2 | loss:0.413
Epoch 3 finished in 4.19 seconds
[4,368] | tst acc:56.9, f1:62.8, auc:63.6 | trn acc:49.2, f1:49.3, auc:61.1 | loss:0.227
Epoch 4 finished in 4.24 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:55.9, f1:63.0, auc:67.5 | trn acc:48.2, f1:50.5, auc:62.9 | loss:0.142
Epoch 6 finished in 4.24 seconds
[7,388] | tst acc:57.1, f1:65.0, auc:70.0 | trn acc:46.8, f1:50.5, auc:64.0 | loss:0.089
Epoch 7 finished in 4.18 seconds
Epoch 8 finished in 4.00 seconds
[9,60] | tst acc:54.1, f1:63.5, auc:64.6 | trn acc:46.2, f1:51.3, auc:63.1 | loss:0.050
Epoch 9 finished in 4.16 seconds
[10,408] | tst acc:57.4, f1:65.7, auc:70.9 | trn acc:45.5, f1:50.7, auc:63.1 | loss:0.020
Epoch 10 finished in 4.21 seconds
Epoch 11 finished in 3.95 seconds
[12,80] | tst acc:57.9, f1:66.0, auc:64.5 | trn acc:45.7, f1:51.5, auc:64.2 | loss:0.020
Epoch 12 finished in 4.21 seconds
[13,428] | tst acc:53.1, f1:62.8, auc:68.6 | trn acc:45.1, f1:50.8, auc:64.4 | loss:0.018
Epoch 13 finished in 4.16 seconds
Epoch 14 finished in 3.99 seconds
[15,100] | tst acc:57.1, f1:65.7, auc:71.6 | trn acc:45.2, f1:51.5, auc:64.8 | loss:0.018
Epoch 15 finished in 4.16 seconds
[16,448] | tst acc:54.1, f1:63.9, auc:65.7 | trn acc:44.5, f1:50.8, auc:65.1 | loss:0.016
Epoch 16 finished in 4.21 seconds
Epoch 17 finished in 3.95 seconds
[18,120] | tst acc:53.4, f1:63.4, auc:66.4 | trn acc:44.4, f1:51.0, auc:65.4 | loss:0.015
Epoch 18 finished in 4.21 seconds
[19,468] | tst acc:55.1, f1:65.6, auc:71.9 | trn acc:43.5, f1:50.5, auc:65.6 | loss:0.014
Epoch 19 finished in 4.16 seconds
Epoch 20 finished in 4.00 seconds
[21,140] | tst acc:53.9, f1:63.8, auc:71.7 | trn acc:43.4, f1:50.9, auc:65.8 | loss:0.013
Epoch 21 finished in 4.17 seconds
[22,488] | tst acc:52.4, f1:64.2, auc:67.7 | trn acc:43.2, f1:51.3, auc:66.0 | loss:0.012
Epoch 22 finished in 4.22 seconds
Epoch 23 finished in 3.95 seconds
[24,160] | tst acc:54.6, f1:65.0, auc:71.1 | trn acc:42.0, f1:50.2, auc:66.1 | loss:0.010
Epoch 24 finished in 4.23 seconds
[25,508] | tst acc:52.6, f1:64.3, auc:69.9 | trn acc:41.6, f1:50.5, auc:66.5 | loss:0.009
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:53.1, f1:64.5, auc:66.1 | trn acc:40.9, f1:50.2, auc:66.5 | loss:0.008
Epoch 27 finished in 4.18 seconds
[28,528] | tst acc:52.1, f1:64.6, auc:70.6 | trn acc:40.2, f1:50.1, auc:66.6 | loss:0.007
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:51.4, f1:63.8, auc:69.3 | trn acc:39.4, f1:50.0, auc:66.4 | loss:0.006
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:51.6, f1:64.2, auc:71.8 | trn acc:38.6, f1:49.6, auc:66.6 | loss:0.005
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:49.1, f1:62.8, auc:65.9 | trn acc:38.3, f1:50.0, auc:66.5 | loss:0.005
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:50.4, f1:63.6, auc:68.1 | trn acc:37.0, f1:49.0, auc:66.4 | loss:0.004
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:47.9, f1:62.2, auc:67.5 | trn acc:36.5, f1:49.1, auc:66.5 | loss:0.003
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:47.1, f1:62.1, auc:72.8 | trn acc:35.9, f1:48.9, auc:66.3 | loss:0.003
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 3.99 seconds
[39,260] | tst acc:46.6, f1:62.0, auc:71.7 | trn acc:35.6, f1:48.9, auc:66.3 | loss:0.003
Epoch 39 finished in 4.15 seconds
[40,608] | tst acc:48.6, f1:62.9, auc:70.3 | trn acc:34.7, f1:48.4, auc:66.3 | loss:0.002
Epoch 40 finished in 4.20 seconds
Epoch 41 finished in 3.94 seconds
[42,280] | tst acc:47.9, f1:62.7, auc:71.5 | trn acc:34.0, f1:47.9, auc:66.0 | loss:0.002
Epoch 42 finished in 4.20 seconds
[43,628] | tst acc:47.6, f1:62.5, auc:67.3 | trn acc:34.4, f1:48.7, auc:66.2 | loss:0.002
Epoch 43 finished in 4.15 seconds
Epoch 44 finished in 3.99 seconds
[45,300] | tst acc:46.9, f1:62.3, auc:71.4 | trn acc:33.7, f1:48.0, auc:66.3 | loss:0.002
Epoch 45 finished in 4.15 seconds
[46,648] | tst acc:47.4, f1:62.5, auc:68.0 | trn acc:33.7, f1:48.4, auc:66.3 | loss:0.002
Epoch 46 finished in 4.20 seconds
Epoch 47 finished in 3.94 seconds
[48,320] | tst acc:45.9, f1:61.8, auc:71.2 | trn acc:33.5, f1:48.3, auc:66.7 | loss:0.002
Epoch 48 finished in 4.20 seconds
[49,668] | tst acc:45.6, f1:61.7, auc:69.6 | trn acc:32.7, f1:47.6, auc:66.7 | loss:0.002
Epoch 49 finished in 4.15 seconds
Epoch 50 finished in 3.99 seconds
[51,340] | tst acc:44.1, f1:60.8, auc:68.0 | trn acc:32.6, f1:47.7, auc:66.9 | loss:0.002
Epoch 51 finished in 4.15 seconds
Epoch 52 finished in 3.99 seconds
[53,12] | tst acc:44.4, f1:61.2, auc:69.1 | trn acc:32.8, f1:48.0, auc:67.1 | loss:0.001
Epoch 53 finished in 4.15 seconds
[54,360] | tst acc:44.4, f1:61.1, auc:62.1 | trn acc:32.4, f1:47.7, auc:67.4 | loss:0.001
Epoch 54 finished in 4.20 seconds
Epoch 55 finished in 3.94 seconds
[56,32] | tst acc:44.6, f1:61.3, auc:69.1 | trn acc:32.6, f1:48.1, auc:67.8 | loss:0.001
Epoch 56 finished in 4.19 seconds
[57,380] | tst acc:44.4, f1:61.2, auc:67.7 | trn acc:32.8, f1:48.4, auc:67.9 | loss:0.001
Epoch 57 finished in 4.15 seconds
Epoch 58 finished in 3.99 seconds
[59,52] | tst acc:44.1, f1:61.1, auc:70.2 | trn acc:31.4, f1:46.9, auc:68.3 | loss:0.001
Epoch 59 finished in 4.15 seconds
[60,400] | tst acc:44.6, f1:61.3, auc:74.7 | trn acc:32.2, f1:47.9, auc:68.5 | loss:0.001
Epoch 60 finished in 4.20 seconds
Epoch 61 finished in 3.94 seconds
[62,72] | tst acc:44.9, f1:61.4, auc:70.9 | trn acc:31.8, f1:47.5, auc:68.7 | loss:0.001
Epoch 62 finished in 4.20 seconds
[63,420] | tst acc:44.1, f1:61.1, auc:70.1 | trn acc:31.7, f1:47.4, auc:68.8 | loss:0.001
Epoch 63 finished in 4.15 seconds
Epoch 64 finished in 3.99 seconds
[65,92] | tst acc:44.4, f1:61.2, auc:73.7 | trn acc:32.1, f1:47.9, auc:68.9 | loss:0.001
Epoch 65 finished in 4.15 seconds
[66,440] | tst acc:44.9, f1:61.4, auc:69.7 | trn acc:31.5, f1:47.3, auc:69.1 | loss:0.001
Epoch 66 finished in 4.20 seconds
Epoch 67 finished in 3.94 seconds
[68,112] | tst acc:44.9, f1:61.4, auc:72.6 | trn acc:32.1, f1:48.0, auc:69.3 | loss:0.001
Epoch 68 finished in 4.20 seconds
[69,460] | tst acc:44.4, f1:61.2, auc:75.5 | trn acc:31.6, f1:47.4, auc:69.3 | loss:0.001
Epoch 69 finished in 4.15 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.99 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:44.6, f1:61.3, auc:73.2 | trn acc:31.8, f1:47.6, auc:69.4 | loss:0.001
Average epoch runtime: 4.06 seconds
Total training time: 292.06 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=1.0, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
ALPHA: tensor(1.)
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:51.1, f1:48.4, auc:53.0 | trn acc:48.3, f1:30.5, auc:51.4 | loss:0.819
Epoch 0 finished in 4.17 seconds
[1,348] | tst acc:50.1, f1:52.0, auc:55.1 | trn acc:49.8, f1:41.0, auc:52.4 | loss:0.936
Epoch 1 finished in 4.19 seconds
Epoch 2 finished in 4.01 seconds
[3,20] | tst acc:54.9, f1:58.5, auc:60.7 | trn acc:50.1, f1:46.8, auc:58.1 | loss:0.410
Epoch 3 finished in 4.18 seconds
[4,368] | tst acc:54.5, f1:60.7, auc:60.1 | trn acc:49.3, f1:49.2, auc:61.1 | loss:0.221
Epoch 4 finished in 4.23 seconds
Epoch 5 finished in 3.97 seconds
[6,40] | tst acc:58.2, f1:64.5, auc:67.4 | trn acc:48.2, f1:50.3, auc:63.1 | loss:0.137
Epoch 6 finished in 4.22 seconds
[7,388] | tst acc:53.6, f1:61.4, auc:62.4 | trn acc:46.8, f1:50.1, auc:63.4 | loss:0.071
Epoch 7 finished in 4.17 seconds
Epoch 8 finished in 4.01 seconds
[9,60] | tst acc:53.2, f1:61.5, auc:61.8 | trn acc:46.4, f1:50.7, auc:62.7 | loss:0.026
Epoch 9 finished in 4.18 seconds
[10,408] | tst acc:56.5, f1:64.0, auc:65.3 | trn acc:46.1, f1:50.4, auc:63.3 | loss:0.023
Epoch 10 finished in 4.22 seconds
Epoch 11 finished in 3.97 seconds
[12,80] | tst acc:53.0, f1:61.6, auc:61.5 | trn acc:46.1, f1:50.8, auc:63.7 | loss:0.022
Epoch 12 finished in 4.22 seconds
[13,428] | tst acc:54.7, f1:63.2, auc:66.3 | trn acc:45.8, f1:50.6, auc:64.4 | loss:0.020
Epoch 13 finished in 4.18 seconds
Epoch 14 finished in 4.01 seconds
[15,100] | tst acc:52.4, f1:61.3, auc:62.4 | trn acc:45.6, f1:50.9, auc:64.9 | loss:0.019
Epoch 15 finished in 4.17 seconds
[16,448] | tst acc:52.4, f1:61.9, auc:63.5 | trn acc:45.2, f1:50.8, auc:65.1 | loss:0.018
Epoch 16 finished in 4.22 seconds
Epoch 17 finished in 3.96 seconds
[18,120] | tst acc:52.0, f1:61.6, auc:61.5 | trn acc:44.7, f1:50.6, auc:65.6 | loss:0.016
Epoch 18 finished in 4.22 seconds
[19,468] | tst acc:49.7, f1:60.8, auc:65.3 | trn acc:44.2, f1:50.6, auc:65.7 | loss:0.015
Epoch 19 finished in 4.17 seconds
Epoch 20 finished in 4.01 seconds
[21,140] | tst acc:53.6, f1:62.9, auc:67.1 | trn acc:43.9, f1:50.7, auc:66.2 | loss:0.014
Epoch 21 finished in 4.17 seconds
[22,488] | tst acc:51.8, f1:62.8, auc:68.4 | trn acc:43.3, f1:50.6, auc:66.5 | loss:0.013
Epoch 22 finished in 4.21 seconds
Epoch 23 finished in 3.96 seconds
[24,160] | tst acc:53.8, f1:64.2, auc:71.5 | trn acc:42.6, f1:50.4, auc:66.3 | loss:0.011
Epoch 24 finished in 4.23 seconds
[25,508] | tst acc:50.9, f1:62.4, auc:64.0 | trn acc:41.6, f1:49.9, auc:66.6 | loss:0.010
Epoch 25 finished in 4.17 seconds
Epoch 26 finished in 4.01 seconds
[27,180] | tst acc:52.0, f1:62.7, auc:68.6 | trn acc:41.1, f1:50.0, auc:66.8 | loss:0.009
Epoch 27 finished in 4.17 seconds
[28,528] | tst acc:51.1, f1:63.3, auc:66.8 | trn acc:40.6, f1:50.2, auc:66.8 | loss:0.008
Epoch 28 finished in 4.22 seconds
Epoch 29 finished in 3.96 seconds
[30,200] | tst acc:50.3, f1:62.5, auc:66.6 | trn acc:39.4, f1:49.4, auc:66.8 | loss:0.007
Epoch 30 finished in 4.22 seconds
[31,548] | tst acc:49.1, f1:62.0, auc:68.5 | trn acc:38.8, f1:49.5, auc:67.1 | loss:0.006
Epoch 31 finished in 4.17 seconds
Epoch 32 finished in 4.01 seconds
[33,220] | tst acc:47.2, f1:61.4, auc:65.1 | trn acc:37.7, f1:49.0, auc:66.7 | loss:0.005
Epoch 33 finished in 4.17 seconds
[34,568] | tst acc:48.9, f1:62.2, auc:66.8 | trn acc:37.4, f1:49.2, auc:66.8 | loss:0.004
Epoch 34 finished in 4.22 seconds
Epoch 35 finished in 3.96 seconds
[36,240] | tst acc:48.0, f1:61.8, auc:65.4 | trn acc:36.2, f1:48.5, auc:66.7 | loss:0.004
Epoch 36 finished in 4.22 seconds
[37,588] | tst acc:47.8, f1:62.3, auc:69.7 | trn acc:35.7, f1:48.5, auc:66.5 | loss:0.003
Epoch 37 finished in 4.16 seconds
Epoch 38 finished in 4.01 seconds
[39,260] | tst acc:44.3, f1:59.9, auc:64.6 | trn acc:35.0, f1:48.1, auc:66.7 | loss:0.003
Epoch 39 finished in 4.17 seconds
[40,608] | tst acc:47.6, f1:61.9, auc:63.1 | trn acc:34.7, f1:48.3, auc:66.5 | loss:0.002
Epoch 40 finished in 4.22 seconds
Epoch 41 finished in 3.96 seconds
[42,280] | tst acc:45.1, f1:60.6, auc:66.7 | trn acc:34.2, f1:48.1, auc:66.3 | loss:0.002
Epoch 42 finished in 4.21 seconds
[43,628] | tst acc:46.2, f1:61.2, auc:65.0 | trn acc:34.1, f1:48.2, auc:66.4 | loss:0.002
Epoch 43 finished in 4.17 seconds
Epoch 44 finished in 4.01 seconds
[45,300] | tst acc:45.9, f1:61.2, auc:70.4 | trn acc:33.4, f1:47.7, auc:66.5 | loss:0.002
Epoch 45 finished in 4.17 seconds
[46,648] | tst acc:44.3, f1:60.4, auc:69.3 | trn acc:33.2, f1:47.6, auc:66.8 | loss:0.002
Epoch 46 finished in 4.22 seconds
Epoch 47 finished in 3.96 seconds
[48,320] | tst acc:44.3, f1:60.4, auc:67.4 | trn acc:33.1, f1:47.8, auc:66.9 | loss:0.002
Epoch 48 finished in 4.21 seconds
[49,668] | tst acc:45.7, f1:61.3, auc:68.2 | trn acc:32.6, f1:47.4, auc:66.9 | loss:0.002
Epoch 49 finished in 4.17 seconds
Epoch 50 finished in 4.01 seconds
[51,340] | tst acc:44.1, f1:60.5, auc:65.4 | trn acc:32.8, f1:47.9, auc:67.1 | loss:0.002
Epoch 51 finished in 4.16 seconds
Epoch 52 finished in 4.00 seconds
[53,12] | tst acc:43.2, f1:60.1, auc:67.7 | trn acc:31.8, f1:46.9, auc:67.4 | loss:0.001
Epoch 53 finished in 4.17 seconds
[54,360] | tst acc:43.7, f1:60.4, auc:67.1 | trn acc:31.7, f1:46.9, auc:67.6 | loss:0.001
Epoch 54 finished in 4.22 seconds
Epoch 55 finished in 3.96 seconds
[56,32] | tst acc:43.5, f1:60.3, auc:64.8 | trn acc:32.4, f1:47.9, auc:67.8 | loss:0.001
Epoch 56 finished in 4.22 seconds
[57,380] | tst acc:43.7, f1:60.3, auc:66.2 | trn acc:31.7, f1:47.1, auc:68.0 | loss:0.001
Epoch 57 finished in 4.17 seconds
Epoch 58 finished in 4.01 seconds
[59,52] | tst acc:43.0, f1:59.9, auc:65.0 | trn acc:31.8, f1:47.4, auc:68.4 | loss:0.001
Epoch 59 finished in 4.17 seconds
[60,400] | tst acc:43.5, f1:60.2, auc:71.1 | trn acc:32.0, f1:47.7, auc:68.8 | loss:0.001
Epoch 60 finished in 4.22 seconds
Epoch 61 finished in 3.96 seconds
[62,72] | tst acc:44.3, f1:60.7, auc:70.6 | trn acc:31.0, f1:46.5, auc:68.9 | loss:0.001
Epoch 62 finished in 4.22 seconds
[63,420] | tst acc:43.2, f1:60.3, auc:67.4 | trn acc:31.4, f1:47.0, auc:69.0 | loss:0.001
Epoch 63 finished in 4.17 seconds
Epoch 64 finished in 4.01 seconds
[65,92] | tst acc:43.5, f1:60.3, auc:67.7 | trn acc:31.4, f1:47.2, auc:69.2 | loss:0.001
Epoch 65 finished in 4.16 seconds
[66,440] | tst acc:43.7, f1:60.4, auc:69.2 | trn acc:31.8, f1:47.6, auc:69.3 | loss:0.001
Epoch 66 finished in 4.21 seconds
Epoch 67 finished in 3.96 seconds
[68,112] | tst acc:43.9, f1:60.5, auc:70.8 | trn acc:31.2, f1:47.0, auc:69.3 | loss:0.001
Epoch 68 finished in 4.22 seconds
[69,460] | tst acc:43.9, f1:60.5, auc:68.7 | trn acc:31.2, f1:47.0, auc:69.5 | loss:0.001
Epoch 69 finished in 4.17 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 4.01 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:43.7, f1:60.4, auc:66.3 | trn acc:31.4, f1:47.2, auc:69.3 | loss:0.001
Average epoch runtime: 4.07 seconds
Total training time: 292.84 GPU seconds
alpha = auto
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=-1.0, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
AUTOMATIC ALPHA
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:51.8, f1:50.8, auc:52.9 | trn acc:47.5, f1:35.6, auc:49.1 | loss:1.167
Epoch 0 finished in 4.10 seconds
[1,348] | tst acc:54.1, f1:57.8, auc:55.7 | trn acc:49.9, f1:41.5, auc:52.4 | loss:0.956
Epoch 1 finished in 4.12 seconds
Epoch 2 finished in 3.95 seconds
[3,20] | tst acc:53.7, f1:58.9, auc:53.8 | trn acc:50.3, f1:47.6, auc:58.0 | loss:0.429
Epoch 3 finished in 4.11 seconds
[4,368] | tst acc:54.8, f1:61.9, auc:57.6 | trn acc:49.8, f1:50.1, auc:61.4 | loss:0.233
Epoch 4 finished in 4.15 seconds
Epoch 5 finished in 3.90 seconds
[6,40] | tst acc:53.5, f1:62.4, auc:59.5 | trn acc:48.2, f1:50.5, auc:62.9 | loss:0.148
Epoch 6 finished in 4.15 seconds
[7,388] | tst acc:53.9, f1:62.9, auc:59.1 | trn acc:47.4, f1:51.2, auc:62.4 | loss:0.073
Epoch 7 finished in 4.11 seconds
Epoch 8 finished in 3.94 seconds
[9,60] | tst acc:55.0, f1:64.4, auc:60.8 | trn acc:47.1, f1:51.3, auc:63.5 | loss:0.027
Epoch 9 finished in 4.11 seconds
[10,408] | tst acc:53.7, f1:62.4, auc:63.8 | trn acc:47.0, f1:51.4, auc:64.4 | loss:0.025
Epoch 10 finished in 4.15 seconds
Epoch 11 finished in 3.90 seconds
[12,80] | tst acc:56.3, f1:65.2, auc:64.3 | trn acc:46.5, f1:51.2, auc:64.7 | loss:0.024
Epoch 12 finished in 4.15 seconds
[13,428] | tst acc:55.6, f1:65.0, auc:63.9 | trn acc:46.5, f1:51.4, auc:65.1 | loss:0.023
Epoch 13 finished in 4.11 seconds
Epoch 14 finished in 3.94 seconds
[15,100] | tst acc:53.5, f1:63.4, auc:60.2 | trn acc:46.4, f1:51.7, auc:65.7 | loss:0.022
Epoch 15 finished in 4.11 seconds
[16,448] | tst acc:53.7, f1:64.1, auc:62.0 | trn acc:46.0, f1:51.7, auc:65.8 | loss:0.021
Epoch 16 finished in 4.15 seconds
Epoch 17 finished in 3.90 seconds
[18,120] | tst acc:53.3, f1:63.9, auc:62.9 | trn acc:45.6, f1:51.5, auc:66.2 | loss:0.019
Epoch 18 finished in 4.16 seconds
[19,468] | tst acc:55.4, f1:66.2, auc:69.1 | trn acc:45.2, f1:51.6, auc:66.4 | loss:0.018
Epoch 19 finished in 4.11 seconds
Epoch 20 finished in 3.94 seconds
[21,140] | tst acc:52.2, f1:63.3, auc:63.2 | trn acc:44.5, f1:51.2, auc:66.6 | loss:0.017
Epoch 21 finished in 4.11 seconds
[22,488] | tst acc:54.4, f1:65.8, auc:61.6 | trn acc:44.5, f1:51.8, auc:66.6 | loss:0.016
Epoch 22 finished in 4.15 seconds
Epoch 23 finished in 3.90 seconds
[24,160] | tst acc:54.1, f1:64.8, auc:66.2 | trn acc:43.5, f1:51.1, auc:67.1 | loss:0.015
Epoch 24 finished in 4.16 seconds
[25,508] | tst acc:54.8, f1:66.5, auc:67.9 | trn acc:42.9, f1:51.1, auc:67.0 | loss:0.014
Epoch 25 finished in 4.10 seconds
Epoch 26 finished in 3.94 seconds
[27,180] | tst acc:55.4, f1:66.1, auc:66.0 | trn acc:42.5, f1:51.3, auc:67.1 | loss:0.013
Epoch 27 finished in 4.11 seconds
[28,528] | tst acc:50.5, f1:64.0, auc:64.1 | trn acc:41.4, f1:50.6, auc:66.8 | loss:0.012
Epoch 28 finished in 4.15 seconds
Epoch 29 finished in 3.90 seconds
[30,200] | tst acc:49.9, f1:63.2, auc:62.7 | trn acc:40.7, f1:50.4, auc:67.0 | loss:0.011
Epoch 30 finished in 4.16 seconds
[31,548] | tst acc:52.0, f1:64.9, auc:60.3 | trn acc:40.3, f1:50.6, auc:67.2 | loss:0.010
Epoch 31 finished in 4.10 seconds
Epoch 32 finished in 3.94 seconds
[33,220] | tst acc:49.9, f1:63.9, auc:63.5 | trn acc:39.6, f1:50.5, auc:67.1 | loss:0.009
Epoch 33 finished in 4.11 seconds
[34,568] | tst acc:52.4, f1:66.0, auc:64.3 | trn acc:38.6, f1:49.8, auc:67.2 | loss:0.008
Epoch 34 finished in 4.15 seconds
Epoch 35 finished in 3.90 seconds
[36,240] | tst acc:49.7, f1:64.1, auc:60.3 | trn acc:38.0, f1:49.8, auc:67.0 | loss:0.008
Epoch 36 finished in 4.16 seconds
[37,588] | tst acc:50.7, f1:65.2, auc:61.6 | trn acc:37.2, f1:49.6, auc:66.9 | loss:0.007
Epoch 37 finished in 4.10 seconds
Epoch 38 finished in 3.94 seconds
[39,260] | tst acc:48.6, f1:64.0, auc:57.5 | trn acc:36.5, f1:49.3, auc:66.8 | loss:0.007
Epoch 39 finished in 4.11 seconds
[40,608] | tst acc:49.5, f1:64.3, auc:61.2 | trn acc:36.0, f1:49.2, auc:66.8 | loss:0.006
Epoch 40 finished in 4.15 seconds
Epoch 41 finished in 3.90 seconds
[42,280] | tst acc:48.6, f1:64.0, auc:63.5 | trn acc:35.6, f1:49.1, auc:66.3 | loss:0.006
Epoch 42 finished in 4.16 seconds
[43,628] | tst acc:49.0, f1:64.4, auc:58.5 | trn acc:35.2, f1:49.0, auc:66.4 | loss:0.006
Epoch 43 finished in 4.11 seconds
Epoch 44 finished in 3.94 seconds
[45,300] | tst acc:49.3, f1:64.6, auc:59.5 | trn acc:34.8, f1:48.9, auc:66.3 | loss:0.006
Epoch 45 finished in 4.11 seconds
[46,648] | tst acc:49.7, f1:65.1, auc:54.5 | trn acc:34.3, f1:48.6, auc:66.4 | loss:0.005
Epoch 46 finished in 4.15 seconds
Epoch 47 finished in 3.90 seconds
[48,320] | tst acc:50.1, f1:65.5, auc:61.5 | trn acc:34.2, f1:48.8, auc:66.5 | loss:0.005
Epoch 48 finished in 4.15 seconds
[49,668] | tst acc:48.0, f1:64.1, auc:60.7 | trn acc:33.5, f1:48.3, auc:66.6 | loss:0.005
Epoch 49 finished in 4.10 seconds
Epoch 50 finished in 3.95 seconds
[51,340] | tst acc:47.8, f1:64.1, auc:55.6 | trn acc:33.2, f1:48.2, auc:66.8 | loss:0.005
Epoch 51 finished in 4.11 seconds
Epoch 52 finished in 3.94 seconds
[53,12] | tst acc:47.1, f1:64.0, auc:53.5 | trn acc:33.6, f1:48.8, auc:66.7 | loss:0.005
Epoch 53 finished in 4.11 seconds
[54,360] | tst acc:48.0, f1:64.4, auc:57.7 | trn acc:33.1, f1:48.3, auc:66.8 | loss:0.005
Epoch 54 finished in 4.15 seconds
Epoch 55 finished in 3.90 seconds
[56,32] | tst acc:47.8, f1:64.3, auc:60.7 | trn acc:32.4, f1:47.7, auc:67.4 | loss:0.005
Epoch 56 finished in 4.15 seconds
[57,380] | tst acc:47.8, f1:64.3, auc:60.2 | trn acc:32.9, f1:48.4, auc:67.5 | loss:0.005
Epoch 57 finished in 4.11 seconds
Epoch 58 finished in 3.94 seconds
[59,52] | tst acc:47.3, f1:64.3, auc:57.4 | trn acc:32.5, f1:48.1, auc:67.9 | loss:0.004
Epoch 59 finished in 4.11 seconds
[60,400] | tst acc:47.8, f1:64.3, auc:61.0 | trn acc:32.7, f1:48.3, auc:67.9 | loss:0.004
Epoch 60 finished in 4.15 seconds
Epoch 61 finished in 3.90 seconds
[62,72] | tst acc:48.4, f1:64.7, auc:59.3 | trn acc:32.5, f1:48.2, auc:68.4 | loss:0.004
Epoch 62 finished in 4.15 seconds
[63,420] | tst acc:47.6, f1:64.4, auc:58.5 | trn acc:32.4, f1:48.2, auc:68.3 | loss:0.004
Epoch 63 finished in 4.10 seconds
Epoch 64 finished in 3.94 seconds
[65,92] | tst acc:48.0, f1:64.5, auc:61.6 | trn acc:32.1, f1:47.8, auc:68.5 | loss:0.004
Epoch 65 finished in 4.11 seconds
[66,440] | tst acc:48.0, f1:64.4, auc:64.7 | trn acc:32.4, f1:48.2, auc:68.8 | loss:0.004
Epoch 66 finished in 4.16 seconds
Epoch 67 finished in 3.90 seconds
[68,112] | tst acc:48.4, f1:64.7, auc:60.9 | trn acc:32.2, f1:48.1, auc:68.7 | loss:0.004
Epoch 68 finished in 4.15 seconds
[69,460] | tst acc:47.6, f1:64.3, auc:61.9 | trn acc:32.3, f1:48.2, auc:68.8 | loss:0.004
Epoch 69 finished in 4.11 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.94 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:48.0, f1:64.5, auc:61.5 | trn acc:31.7, f1:47.5, auc:69.0 | loss:0.004
Average epoch runtime: 4.00 seconds
Total training time: 288.26 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=-1.0, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
AUTOMATIC ALPHA
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:51.8, f1:42.3, auc:53.0 | trn acc:47.2, f1:31.8, auc:48.9 | loss:1.000
Epoch 0 finished in 4.10 seconds
[1,348] | tst acc:49.2, f1:46.7, auc:55.2 | trn acc:49.9, f1:41.6, auc:52.3 | loss:0.956
Epoch 1 finished in 4.12 seconds
Epoch 2 finished in 3.95 seconds
[3,20] | tst acc:51.8, f1:51.5, auc:59.2 | trn acc:50.1, f1:46.9, auc:57.8 | loss:0.425
Epoch 3 finished in 4.12 seconds
[4,368] | tst acc:49.8, f1:52.4, auc:58.6 | trn acc:49.4, f1:49.4, auc:61.1 | loss:0.230
Epoch 4 finished in 4.16 seconds
Epoch 5 finished in 3.90 seconds
[6,40] | tst acc:53.0, f1:56.7, auc:67.5 | trn acc:47.9, f1:50.1, auc:62.5 | loss:0.150
Epoch 6 finished in 4.16 seconds
[7,388] | tst acc:48.8, f1:53.6, auc:64.9 | trn acc:47.6, f1:51.5, auc:61.6 | loss:0.067
Epoch 7 finished in 4.11 seconds
Epoch 8 finished in 3.94 seconds
[9,60] | tst acc:47.6, f1:53.2, auc:62.4 | trn acc:46.3, f1:50.1, auc:63.0 | loss:0.027
Epoch 9 finished in 4.11 seconds
[10,408] | tst acc:53.0, f1:57.8, auc:68.7 | trn acc:47.0, f1:51.3, auc:63.7 | loss:0.026
Epoch 10 finished in 4.15 seconds
Epoch 11 finished in 3.90 seconds
[12,80] | tst acc:49.2, f1:54.8, auc:65.0 | trn acc:46.3, f1:50.8, auc:63.7 | loss:0.025
Epoch 12 finished in 4.15 seconds
[13,428] | tst acc:47.4, f1:53.6, auc:65.2 | trn acc:46.2, f1:50.9, auc:64.4 | loss:0.023
Epoch 13 finished in 4.10 seconds
Epoch 14 finished in 3.94 seconds
[15,100] | tst acc:47.6, f1:53.7, auc:65.2 | trn acc:46.1, f1:51.2, auc:64.4 | loss:0.022
Epoch 15 finished in 4.11 seconds
[16,448] | tst acc:48.2, f1:54.8, auc:63.6 | trn acc:45.6, f1:51.1, auc:65.1 | loss:0.021
Epoch 16 finished in 4.16 seconds
Epoch 17 finished in 3.90 seconds
[18,120] | tst acc:46.8, f1:54.4, auc:66.5 | trn acc:45.5, f1:51.2, auc:65.3 | loss:0.020
Epoch 18 finished in 4.15 seconds
[19,468] | tst acc:46.0, f1:53.9, auc:66.0 | trn acc:45.1, f1:51.4, auc:65.4 | loss:0.019
Epoch 19 finished in 4.11 seconds
Epoch 20 finished in 3.94 seconds
[21,140] | tst acc:46.6, f1:53.9, auc:66.6 | trn acc:44.5, f1:51.1, auc:65.5 | loss:0.017
Epoch 21 finished in 4.11 seconds
[22,488] | tst acc:47.2, f1:55.4, auc:67.4 | trn acc:43.8, f1:50.7, auc:66.0 | loss:0.016
Epoch 22 finished in 4.15 seconds
Epoch 23 finished in 3.90 seconds
[24,160] | tst acc:46.0, f1:54.1, auc:67.0 | trn acc:43.5, f1:50.9, auc:66.5 | loss:0.015
Epoch 24 finished in 4.15 seconds
[25,508] | tst acc:44.8, f1:54.3, auc:61.5 | trn acc:42.7, f1:50.8, auc:66.3 | loss:0.013
Epoch 25 finished in 4.10 seconds
Epoch 26 finished in 3.94 seconds
[27,180] | tst acc:47.8, f1:55.8, auc:66.0 | trn acc:42.3, f1:51.0, auc:66.5 | loss:0.013
Epoch 27 finished in 4.10 seconds
[28,528] | tst acc:42.5, f1:53.7, auc:68.5 | trn acc:41.1, f1:50.2, auc:66.5 | loss:0.012
Epoch 28 finished in 4.15 seconds
Epoch 29 finished in 3.90 seconds
[30,200] | tst acc:45.2, f1:54.6, auc:68.8 | trn acc:40.6, f1:50.3, auc:66.7 | loss:0.011
Epoch 30 finished in 4.16 seconds
[31,548] | tst acc:43.1, f1:54.1, auc:68.9 | trn acc:39.8, f1:49.9, auc:66.6 | loss:0.010
Epoch 31 finished in 4.11 seconds
Epoch 32 finished in 3.94 seconds
[33,220] | tst acc:40.7, f1:52.9, auc:68.8 | trn acc:39.0, f1:49.8, auc:66.6 | loss:0.009
Epoch 33 finished in 4.11 seconds
[34,568] | tst acc:40.9, f1:52.5, auc:65.1 | trn acc:38.4, f1:49.7, auc:66.8 | loss:0.009
Epoch 34 finished in 4.15 seconds
Epoch 35 finished in 3.90 seconds
[36,240] | tst acc:42.5, f1:54.1, auc:67.5 | trn acc:37.4, f1:49.1, auc:66.4 | loss:0.008
Epoch 36 finished in 4.16 seconds
[37,588] | tst acc:38.5, f1:51.9, auc:68.2 | trn acc:36.8, f1:49.0, auc:66.5 | loss:0.007
Epoch 37 finished in 4.11 seconds
Epoch 38 finished in 3.94 seconds
[39,260] | tst acc:39.3, f1:52.2, auc:70.6 | trn acc:36.4, f1:49.1, auc:66.7 | loss:0.007
Epoch 39 finished in 4.11 seconds
[40,608] | tst acc:39.1, f1:52.5, auc:63.1 | trn acc:35.9, f1:49.1, auc:66.3 | loss:0.007
Epoch 40 finished in 4.15 seconds
Epoch 41 finished in 3.90 seconds
[42,280] | tst acc:38.1, f1:52.1, auc:66.7 | trn acc:34.9, f1:48.3, auc:66.5 | loss:0.006
Epoch 42 finished in 4.15 seconds
[43,628] | tst acc:38.1, f1:52.1, auc:67.7 | trn acc:34.9, f1:48.7, auc:66.1 | loss:0.006
Epoch 43 finished in 4.10 seconds
Epoch 44 finished in 3.94 seconds
[45,300] | tst acc:37.3, f1:51.8, auc:66.3 | trn acc:34.0, f1:48.0, auc:66.1 | loss:0.006
Epoch 45 finished in 4.11 seconds
[46,648] | tst acc:37.3, f1:51.7, auc:67.8 | trn acc:34.5, f1:48.9, auc:66.3 | loss:0.005
Epoch 46 finished in 4.15 seconds
Epoch 47 finished in 3.90 seconds
[48,320] | tst acc:36.5, f1:51.7, auc:67.5 | trn acc:33.6, f1:48.2, auc:66.2 | loss:0.005
Epoch 48 finished in 4.15 seconds
[49,668] | tst acc:37.1, f1:51.9, auc:68.5 | trn acc:33.4, f1:48.1, auc:66.2 | loss:0.005
Epoch 49 finished in 4.11 seconds
Epoch 50 finished in 3.94 seconds
[51,340] | tst acc:36.7, f1:51.7, auc:66.7 | trn acc:33.4, f1:48.4, auc:66.4 | loss:0.005
Epoch 51 finished in 4.12 seconds
Epoch 52 finished in 3.94 seconds
[53,12] | tst acc:34.1, f1:50.6, auc:67.0 | trn acc:32.6, f1:47.6, auc:66.6 | loss:0.005
Epoch 53 finished in 4.11 seconds
[54,360] | tst acc:34.7, f1:51.0, auc:65.5 | trn acc:32.9, f1:48.2, auc:66.6 | loss:0.005
Epoch 54 finished in 4.15 seconds
Epoch 55 finished in 3.90 seconds
[56,32] | tst acc:34.9, f1:51.0, auc:67.3 | trn acc:32.4, f1:47.7, auc:67.1 | loss:0.005
Epoch 56 finished in 4.15 seconds
[57,380] | tst acc:35.3, f1:51.2, auc:66.9 | trn acc:32.1, f1:47.5, auc:67.2 | loss:0.004
Epoch 57 finished in 4.11 seconds
Epoch 58 finished in 3.94 seconds
[59,52] | tst acc:34.7, f1:51.0, auc:73.0 | trn acc:32.5, f1:48.0, auc:67.4 | loss:0.005
Epoch 59 finished in 4.10 seconds
[60,400] | tst acc:34.9, f1:51.0, auc:72.1 | trn acc:32.2, f1:47.7, auc:67.9 | loss:0.004
Epoch 60 finished in 4.15 seconds
Epoch 61 finished in 3.90 seconds
[62,72] | tst acc:35.3, f1:51.2, auc:67.1 | trn acc:32.2, f1:47.8, auc:67.9 | loss:0.004
Epoch 62 finished in 4.15 seconds
[63,420] | tst acc:34.1, f1:50.7, auc:66.9 | trn acc:31.9, f1:47.6, auc:68.2 | loss:0.004
Epoch 63 finished in 4.11 seconds
Epoch 64 finished in 3.94 seconds
[65,92] | tst acc:34.7, f1:51.0, auc:70.8 | trn acc:31.8, f1:47.5, auc:68.5 | loss:0.004
Epoch 65 finished in 4.11 seconds
[66,440] | tst acc:34.5, f1:50.9, auc:66.8 | trn acc:31.7, f1:47.4, auc:68.4 | loss:0.004
Epoch 66 finished in 4.16 seconds
Epoch 67 finished in 3.90 seconds
[68,112] | tst acc:34.3, f1:50.7, auc:67.0 | trn acc:32.1, f1:47.9, auc:68.4 | loss:0.004
Epoch 68 finished in 4.15 seconds
[69,460] | tst acc:34.9, f1:50.9, auc:69.2 | trn acc:31.6, f1:47.4, auc:68.6 | loss:0.004
Epoch 69 finished in 4.11 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.94 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:34.7, f1:51.0, auc:69.2 | trn acc:32.2, f1:48.0, auc:68.6 | loss:0.004
Average epoch runtime: 4.00 seconds
Total training time: 288.27 GPU seconds
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, use_oc=True, shuffle=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=100, use_hid_lyr=True, max_iter=48000, max_fscore=-1, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', focal=True, alpha=-1.0, gamma=2.0, adam=False, exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
USING FOCAL LOSS
GAMMA: 2.0
AUTOMATIC ALPHA
Training...
INITIALIZING ONE CYCLE

[0,0] | tst acc:52.3, f1:41.1, auc:52.4 | trn acc:48.7, f1:34.1, auc:50.1 | loss:1.016
Epoch 0 finished in 4.87 seconds
[1,348] | tst acc:48.1, f1:42.8, auc:52.9 | trn acc:49.9, f1:41.8, auc:52.5 | loss:0.955
Epoch 1 finished in 4.12 seconds
Epoch 2 finished in 3.95 seconds
[3,20] | tst acc:49.3, f1:46.7, auc:60.0 | trn acc:50.3, f1:47.5, auc:58.0 | loss:0.423
Epoch 3 finished in 4.11 seconds
[4,368] | tst acc:46.7, f1:47.4, auc:59.6 | trn acc:49.6, f1:50.1, auc:61.1 | loss:0.236
Epoch 4 finished in 4.16 seconds
Epoch 5 finished in 3.90 seconds
[6,40] | tst acc:48.5, f1:50.2, auc:64.9 | trn acc:48.4, f1:50.8, auc:62.9 | loss:0.145
Epoch 6 finished in 4.16 seconds
[7,388] | tst acc:45.9, f1:49.7, auc:59.0 | trn acc:47.9, f1:51.6, auc:61.5 | loss:0.063
Epoch 7 finished in 4.11 seconds
Epoch 8 finished in 3.94 seconds
[9,60] | tst acc:43.2, f1:46.9, auc:56.9 | trn acc:47.0, f1:51.1, auc:62.5 | loss:0.028
Epoch 9 finished in 4.11 seconds
[10,408] | tst acc:46.7, f1:49.3, auc:60.1 | trn acc:47.2, f1:51.5, auc:63.4 | loss:0.027
Epoch 10 finished in 4.15 seconds
Epoch 11 finished in 3.90 seconds
[12,80] | tst acc:46.5, f1:49.4, auc:62.6 | trn acc:46.9, f1:51.6, auc:63.9 | loss:0.025
Epoch 12 finished in 4.16 seconds
[13,428] | tst acc:44.8, f1:49.5, auc:59.1 | trn acc:46.8, f1:51.6, auc:64.5 | loss:0.024
Epoch 13 finished in 4.11 seconds
Epoch 14 finished in 3.94 seconds
[15,100] | tst acc:43.4, f1:47.4, auc:58.6 | trn acc:46.5, f1:51.7, auc:64.9 | loss:0.023
Epoch 15 finished in 4.11 seconds
[16,448] | tst acc:43.4, f1:48.2, auc:58.2 | trn acc:46.3, f1:51.9, auc:65.4 | loss:0.021
Epoch 16 finished in 4.15 seconds
Epoch 17 finished in 3.89 seconds
[18,120] | tst acc:43.0, f1:48.6, auc:64.0 | trn acc:45.7, f1:51.5, auc:65.7 | loss:0.020
Epoch 18 finished in 4.16 seconds
[19,468] | tst acc:41.8, f1:48.6, auc:64.5 | trn acc:45.2, f1:51.4, auc:66.1 | loss:0.019
Epoch 19 finished in 4.10 seconds
Epoch 20 finished in 3.95 seconds
[21,140] | tst acc:43.8, f1:48.9, auc:63.8 | trn acc:45.0, f1:51.8, auc:66.3 | loss:0.018
Epoch 21 finished in 4.11 seconds
[22,488] | tst acc:41.0, f1:48.3, auc:58.4 | trn acc:44.5, f1:51.7, auc:66.5 | loss:0.016
Epoch 22 finished in 4.16 seconds
Epoch 23 finished in 3.89 seconds
[24,160] | tst acc:40.4, f1:47.3, auc:62.4 | trn acc:43.8, f1:51.3, auc:67.0 | loss:0.015
Epoch 24 finished in 4.15 seconds
[25,508] | tst acc:42.8, f1:50.3, auc:64.1 | trn acc:43.4, f1:51.6, auc:67.1 | loss:0.014
Epoch 25 finished in 4.11 seconds
Epoch 26 finished in 3.94 seconds
[27,180] | tst acc:40.6, f1:47.6, auc:56.9 | trn acc:42.4, f1:51.1, auc:66.8 | loss:0.013
Epoch 27 finished in 4.11 seconds
[28,528] | tst acc:39.4, f1:48.3, auc:61.1 | trn acc:41.3, f1:50.5, auc:67.1 | loss:0.012
Epoch 28 finished in 4.15 seconds
Epoch 29 finished in 3.90 seconds
[30,200] | tst acc:37.8, f1:47.0, auc:63.4 | trn acc:41.3, f1:51.2, auc:67.2 | loss:0.011
Epoch 30 finished in 4.15 seconds
[31,548] | tst acc:37.0, f1:47.0, auc:61.1 | trn acc:39.8, f1:50.1, auc:67.2 | loss:0.010
Epoch 31 finished in 4.11 seconds
Epoch 32 finished in 3.94 seconds
[33,220] | tst acc:35.8, f1:47.2, auc:59.1 | trn acc:39.6, f1:50.5, auc:67.1 | loss:0.009
Epoch 33 finished in 4.11 seconds
[34,568] | tst acc:37.0, f1:47.9, auc:63.4 | trn acc:38.5, f1:49.8, auc:67.2 | loss:0.008
Epoch 34 finished in 4.15 seconds
Epoch 35 finished in 3.89 seconds
[36,240] | tst acc:36.0, f1:47.3, auc:63.4 | trn acc:37.9, f1:49.8, auc:67.2 | loss:0.008
Epoch 36 finished in 4.15 seconds
[37,588] | tst acc:33.5, f1:46.3, auc:61.0 | trn acc:37.5, f1:50.0, auc:67.0 | loss:0.007
Epoch 37 finished in 4.10 seconds
Epoch 38 finished in 3.94 seconds
[39,260] | tst acc:33.9, f1:46.8, auc:64.3 | trn acc:36.6, f1:49.4, auc:66.8 | loss:0.007
Epoch 39 finished in 4.11 seconds
[40,608] | tst acc:34.7, f1:47.3, auc:61.6 | trn acc:36.0, f1:49.3, auc:66.7 | loss:0.006
Epoch 40 finished in 4.15 seconds
Epoch 41 finished in 3.89 seconds
[42,280] | tst acc:32.3, f1:45.7, auc:65.1 | trn acc:35.7, f1:49.3, auc:66.4 | loss:0.006
Epoch 42 finished in 4.15 seconds
[43,628] | tst acc:34.1, f1:47.2, auc:61.9 | trn acc:34.9, f1:48.9, auc:66.4 | loss:0.006
Epoch 43 finished in 4.11 seconds
Epoch 44 finished in 3.94 seconds
[45,300] | tst acc:31.5, f1:45.6, auc:63.0 | trn acc:34.4, f1:48.5, auc:66.2 | loss:0.006
Epoch 45 finished in 4.10 seconds
[46,648] | tst acc:32.5, f1:46.3, auc:57.8 | trn acc:34.5, f1:49.0, auc:66.5 | loss:0.005
Epoch 46 finished in 4.15 seconds
Epoch 47 finished in 3.90 seconds
[48,320] | tst acc:32.3, f1:46.6, auc:63.2 | trn acc:33.9, f1:48.5, auc:66.6 | loss:0.005
Epoch 48 finished in 4.15 seconds
[49,668] | tst acc:31.7, f1:46.0, auc:66.1 | trn acc:34.0, f1:48.9, auc:66.5 | loss:0.005
Epoch 49 finished in 4.10 seconds
Epoch 50 finished in 3.94 seconds
[51,340] | tst acc:30.9, f1:45.9, auc:61.4 | trn acc:33.0, f1:47.9, auc:66.6 | loss:0.005
Epoch 51 finished in 4.10 seconds
Epoch 52 finished in 3.94 seconds
[53,12] | tst acc:30.3, f1:45.7, auc:61.9 | trn acc:33.7, f1:48.9, auc:66.8 | loss:0.005
Epoch 53 finished in 4.11 seconds
[54,360] | tst acc:30.5, f1:45.9, auc:60.8 | trn acc:33.1, f1:48.4, auc:67.0 | loss:0.005
Epoch 54 finished in 4.15 seconds
Epoch 55 finished in 3.89 seconds
[56,32] | tst acc:29.9, f1:45.4, auc:65.0 | trn acc:33.0, f1:48.4, auc:67.4 | loss:0.005
Epoch 56 finished in 4.15 seconds
[57,380] | tst acc:29.9, f1:45.5, auc:64.4 | trn acc:32.7, f1:48.2, auc:67.3 | loss:0.004
Epoch 57 finished in 4.11 seconds
Epoch 58 finished in 3.94 seconds
[59,52] | tst acc:30.3, f1:45.8, auc:63.4 | trn acc:32.7, f1:48.3, auc:68.0 | loss:0.004
Epoch 59 finished in 4.11 seconds
[60,400] | tst acc:30.3, f1:45.5, auc:66.3 | trn acc:32.6, f1:48.3, auc:68.1 | loss:0.004
Epoch 60 finished in 4.15 seconds
Epoch 61 finished in 3.89 seconds
[62,72] | tst acc:30.5, f1:45.7, auc:58.8 | trn acc:32.6, f1:48.3, auc:68.4 | loss:0.004
Epoch 62 finished in 4.15 seconds
[63,420] | tst acc:29.5, f1:45.6, auc:61.8 | trn acc:32.5, f1:48.2, auc:68.2 | loss:0.004
Epoch 63 finished in 4.11 seconds
Epoch 64 finished in 3.94 seconds
[65,92] | tst acc:30.1, f1:45.8, auc:65.0 | trn acc:32.5, f1:48.3, auc:68.8 | loss:0.004
Epoch 65 finished in 4.10 seconds
[66,440] | tst acc:30.3, f1:45.8, auc:65.1 | trn acc:32.3, f1:48.2, auc:68.8 | loss:0.004
Epoch 66 finished in 4.15 seconds
Epoch 67 finished in 3.89 seconds
[68,112] | tst acc:30.3, f1:45.8, auc:64.0 | trn acc:32.2, f1:48.1, auc:68.9 | loss:0.004
Epoch 68 finished in 4.15 seconds
[69,460] | tst acc:29.7, f1:45.5, auc:67.9 | trn acc:32.3, f1:48.2, auc:69.0 | loss:0.004
Epoch 69 finished in 4.11 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 3.94 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.05 seconds
[71,4] | tst acc:30.3, f1:45.8, auc:67.5 | trn acc:32.1, f1:47.9, auc:68.9 | loss:0.004
Average epoch runtime: 4.01 seconds
Total training time: 288.95 GPU seconds