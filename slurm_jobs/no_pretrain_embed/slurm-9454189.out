job is starting on gpua074.delta.ncsa.illinois.edu
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=200, use_hid_lyr=True, max_iter=48000, max_fscore=0.0, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
Training...
Batch size: 8
Train dataset size (samples): 676
Batches per epoch: 85
[0,0] | tst acc:47.8, f1:41.4, auc:48.7 | trn acc:47.4, f1:40.0, auc:46.9 | loss:1.675
Epoch 0 finished in 6.53 seconds
[1,348] | tst acc:54.0, f1:37.6, auc:52.3 | trn acc:55.1, f1:38.0, auc:53.0 | loss:0.779
Epoch 1 finished in 5.82 seconds
Epoch 2 finished in 5.66 seconds
[3,20] | tst acc:61.7, f1:48.0, auc:63.4 | trn acc:58.9, f1:41.0, auc:58.9 | loss:0.677
Epoch 3 finished in 5.81 seconds
[4,368] | tst acc:67.3, f1:55.3, auc:70.5 | trn acc:61.6, f1:45.9, auc:64.2 | loss:0.650
Epoch 4 finished in 5.88 seconds
Epoch 5 finished in 5.59 seconds
[6,40] | tst acc:66.3, f1:54.1, auc:67.7 | trn acc:65.2, f1:49.9, auc:68.6 | loss:0.621
Epoch 6 finished in 5.88 seconds
[7,388] | tst acc:68.3, f1:55.3, auc:70.0 | trn acc:68.2, f1:52.5, auc:71.6 | loss:0.595
Epoch 7 finished in 5.81 seconds
Epoch 8 finished in 5.66 seconds
[9,60] | tst acc:72.4, f1:60.6, auc:75.3 | trn acc:70.1, f1:54.5, auc:73.4 | loss:0.579
Epoch 9 finished in 5.81 seconds
[10,408] | tst acc:71.2, f1:57.7, auc:74.8 | trn acc:72.4, f1:56.6, auc:75.6 | loss:0.554
Epoch 10 finished in 5.87 seconds
Epoch 11 finished in 5.59 seconds
[12,80] | tst acc:71.6, f1:58.6, auc:75.7 | trn acc:73.8, f1:58.4, auc:77.1 | loss:0.539
Epoch 12 finished in 5.87 seconds
[13,428] | tst acc:73.2, f1:57.7, auc:75.1 | trn acc:75.6, f1:59.8, auc:78.7 | loss:0.517
Epoch 13 finished in 5.81 seconds
Epoch 14 finished in 5.65 seconds
[15,100] | tst acc:74.6, f1:61.4, auc:79.1 | trn acc:76.3, f1:60.9, auc:79.3 | loss:0.510
Epoch 15 finished in 5.80 seconds
[16,448] | tst acc:75.2, f1:62.5, auc:79.5 | trn acc:77.2, f1:62.0, auc:80.3 | loss:0.498
Epoch 16 finished in 5.87 seconds
Epoch 17 finished in 5.59 seconds
[18,120] | tst acc:75.2, f1:62.0, auc:79.3 | trn acc:78.0, f1:62.9, auc:81.0 | loss:0.487
Epoch 18 finished in 5.87 seconds
[19,468] | tst acc:73.8, f1:59.0, auc:77.0 | trn acc:78.6, f1:63.8, auc:81.7 | loss:0.479
Epoch 19 finished in 5.80 seconds
Epoch 20 finished in 5.65 seconds
[21,140] | tst acc:75.0, f1:60.1, auc:78.9 | trn acc:78.7, f1:64.1, auc:81.7 | loss:0.480
Epoch 21 finished in 5.80 seconds
[22,488] | tst acc:75.6, f1:61.4, auc:78.4 | trn acc:79.3, f1:64.8, auc:82.4 | loss:0.470
Epoch 22 finished in 5.87 seconds
Epoch 23 finished in 5.59 seconds
[24,160] | tst acc:74.2, f1:57.8, auc:77.8 | trn acc:79.6, f1:64.9, auc:82.8 | loss:0.464
Epoch 24 finished in 5.87 seconds
[25,508] | tst acc:78.6, f1:66.2, auc:79.7 | trn acc:79.8, f1:65.5, auc:83.0 | loss:0.463
Epoch 25 finished in 5.80 seconds
Epoch 26 finished in 5.65 seconds
[27,180] | tst acc:75.8, f1:61.1, auc:82.4 | trn acc:80.1, f1:65.5, auc:83.1 | loss:0.458
Epoch 27 finished in 5.80 seconds
[28,528] | tst acc:77.6, f1:64.1, auc:82.2 | trn acc:80.2, f1:66.0, auc:83.4 | loss:0.457
Epoch 28 finished in 5.87 seconds
Epoch 29 finished in 5.59 seconds
[30,200] | tst acc:76.0, f1:62.1, auc:80.3 | trn acc:80.4, f1:66.1, auc:83.5 | loss:0.455
Epoch 30 finished in 5.87 seconds
[31,548] | tst acc:77.0, f1:64.2, auc:82.0 | trn acc:80.5, f1:66.4, auc:83.9 | loss:0.451
Epoch 31 finished in 5.80 seconds
Epoch 32 finished in 5.65 seconds
[33,220] | tst acc:76.6, f1:62.7, auc:80.5 | trn acc:80.5, f1:66.2, auc:83.8 | loss:0.450
Epoch 33 finished in 5.80 seconds
[34,568] | tst acc:77.2, f1:63.7, auc:82.4 | trn acc:80.6, f1:66.8, auc:83.9 | loss:0.452
Epoch 34 finished in 5.87 seconds
Epoch 35 finished in 5.59 seconds
[36,240] | tst acc:77.2, f1:63.5, auc:81.6 | trn acc:80.9, f1:66.9, auc:84.3 | loss:0.445
Epoch 36 finished in 5.87 seconds
[37,588] | tst acc:76.6, f1:61.9, auc:80.9 | trn acc:80.9, f1:66.7, auc:84.2 | loss:0.444
Epoch 37 finished in 5.80 seconds
Epoch 38 finished in 5.65 seconds
[39,260] | tst acc:76.4, f1:62.2, auc:81.5 | trn acc:80.9, f1:67.0, auc:84.3 | loss:0.445
Epoch 39 finished in 5.80 seconds
[40,608] | tst acc:75.4, f1:60.5, auc:82.4 | trn acc:81.2, f1:67.2, auc:84.7 | loss:0.438
Epoch 40 finished in 5.87 seconds
Epoch 41 finished in 5.58 seconds
[42,280] | tst acc:76.4, f1:61.7, auc:81.9 | trn acc:81.2, f1:67.2, auc:84.8 | loss:0.437
Epoch 42 finished in 5.87 seconds
[43,628] | tst acc:78.8, f1:66.0, auc:81.2 | trn acc:81.3, f1:67.6, auc:85.1 | loss:0.434
Epoch 43 finished in 5.80 seconds
Epoch 44 finished in 5.65 seconds
[45,300] | tst acc:77.2, f1:63.7, auc:81.9 | trn acc:81.3, f1:67.4, auc:85.1 | loss:0.433
Epoch 45 finished in 5.80 seconds
[46,648] | tst acc:77.4, f1:63.7, auc:82.0 | trn acc:81.4, f1:67.6, auc:85.2 | loss:0.432
Epoch 46 finished in 5.86 seconds
Epoch 47 finished in 5.59 seconds
[48,320] | tst acc:76.6, f1:61.4, auc:82.1 | trn acc:81.5, f1:67.6, auc:85.4 | loss:0.428
Epoch 48 finished in 5.86 seconds
[49,668] | tst acc:77.0, f1:62.6, auc:82.2 | trn acc:81.5, f1:67.9, auc:85.2 | loss:0.432
Epoch 49 finished in 5.80 seconds
Epoch 50 finished in 5.65 seconds
[51,340] | tst acc:77.6, f1:63.7, auc:82.9 | trn acc:81.6, f1:67.9, auc:85.5 | loss:0.427
Epoch 51 finished in 5.80 seconds
Epoch 52 finished in 5.65 seconds
[53,12] | tst acc:76.6, f1:61.9, auc:81.7 | trn acc:81.6, f1:67.9, auc:85.7 | loss:0.425
Epoch 53 finished in 5.80 seconds
[54,360] | tst acc:76.6, f1:62.4, auc:82.2 | trn acc:81.7, f1:68.0, auc:85.7 | loss:0.425
Epoch 54 finished in 5.86 seconds
Epoch 55 finished in 5.58 seconds
[56,32] | tst acc:77.2, f1:63.5, auc:81.9 | trn acc:81.5, f1:68.0, auc:85.6 | loss:0.427
Epoch 56 finished in 5.87 seconds
[57,380] | tst acc:77.4, f1:63.7, auc:83.0 | trn acc:81.9, f1:68.3, auc:85.9 | loss:0.422
Epoch 57 finished in 5.79 seconds
Epoch 58 finished in 5.65 seconds
[59,52] | tst acc:76.8, f1:62.1, auc:82.6 | trn acc:81.5, f1:67.7, auc:85.7 | loss:0.425
Epoch 59 finished in 5.80 seconds
[60,400] | tst acc:77.4, f1:63.7, auc:82.7 | trn acc:81.7, f1:68.4, auc:86.1 | loss:0.421
Epoch 60 finished in 5.86 seconds
Epoch 61 finished in 5.58 seconds
[62,72] | tst acc:77.2, f1:63.3, auc:82.9 | trn acc:81.8, f1:68.2, auc:85.9 | loss:0.421
Epoch 62 finished in 5.86 seconds
[63,420] | tst acc:77.0, f1:62.6, auc:82.2 | trn acc:81.7, f1:68.2, auc:86.0 | loss:0.421
Epoch 63 finished in 5.80 seconds
Epoch 64 finished in 5.65 seconds
[65,92] | tst acc:76.4, f1:62.0, auc:82.9 | trn acc:81.7, f1:68.2, auc:86.1 | loss:0.420
Epoch 65 finished in 5.80 seconds
[66,440] | tst acc:78.2, f1:65.0, auc:83.5 | trn acc:81.7, f1:68.1, auc:86.1 | loss:0.421
Epoch 66 finished in 5.86 seconds
Epoch 67 finished in 5.59 seconds
[68,112] | tst acc:76.8, f1:62.4, auc:82.8 | trn acc:81.9, f1:68.3, auc:86.1 | loss:0.418
Epoch 68 finished in 5.87 seconds
[69,460] | tst acc:77.0, f1:63.1, auc:82.5 | trn acc:81.7, f1:68.3, auc:86.2 | loss:0.421
Epoch 69 finished in 5.80 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 5.65 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.07 seconds
Average epoch runtime: 5.69 seconds
Total training time: 409.86 GPU seconds
2
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=False, omic='exp', use_attention=True, use_cntx_attn=True, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=200, use_hid_lyr=True, max_iter=48000, max_fscore=0.0, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
Training...
Batch size: 8
Train dataset size (samples): 676
Batches per epoch: 85
[0,0] | tst acc:47.4, f1:27.6, auc:47.8 | trn acc:49.5, f1:41.8, auc:50.3 | loss:1.508
Epoch 0 finished in 5.85 seconds
[1,348] | tst acc:58.1, f1:31.8, auc:59.1 | trn acc:55.2, f1:37.7, auc:52.5 | loss:0.780
Epoch 1 finished in 5.84 seconds
Epoch 2 finished in 5.68 seconds
[3,20] | tst acc:56.8, f1:32.6, auc:62.2 | trn acc:58.4, f1:42.3, auc:58.5 | loss:0.680
Epoch 3 finished in 5.83 seconds
[4,368] | tst acc:70.9, f1:47.1, auc:73.2 | trn acc:62.5, f1:48.6, auc:65.9 | loss:0.646
Epoch 4 finished in 5.90 seconds
Epoch 5 finished in 5.61 seconds
[6,40] | tst acc:67.9, f1:43.0, auc:72.7 | trn acc:66.5, f1:52.0, auc:70.1 | loss:0.615
Epoch 6 finished in 5.90 seconds
[7,388] | tst acc:71.3, f1:46.6, auc:75.0 | trn acc:69.2, f1:54.4, auc:72.7 | loss:0.589
Epoch 7 finished in 5.83 seconds
Epoch 8 finished in 5.68 seconds
[9,60] | tst acc:74.5, f1:52.0, auc:81.1 | trn acc:71.4, f1:56.7, auc:74.9 | loss:0.566
Epoch 9 finished in 5.82 seconds
[10,408] | tst acc:73.0, f1:49.0, auc:79.6 | trn acc:72.9, f1:58.2, auc:76.4 | loss:0.549
Epoch 10 finished in 5.89 seconds
Epoch 11 finished in 5.59 seconds
[12,80] | tst acc:75.1, f1:49.4, auc:79.4 | trn acc:74.5, f1:59.6, auc:77.8 | loss:0.532
Epoch 12 finished in 5.87 seconds
[13,428] | tst acc:76.6, f1:54.5, auc:79.4 | trn acc:75.6, f1:61.1, auc:78.9 | loss:0.520
Epoch 13 finished in 5.81 seconds
Epoch 14 finished in 5.65 seconds
[15,100] | tst acc:76.4, f1:51.5, auc:80.1 | trn acc:76.3, f1:61.7, auc:79.5 | loss:0.511
Epoch 15 finished in 5.80 seconds
[16,448] | tst acc:76.8, f1:53.6, auc:81.6 | trn acc:77.2, f1:62.9, auc:80.5 | loss:0.499
Epoch 16 finished in 5.87 seconds
Epoch 17 finished in 5.58 seconds
[18,120] | tst acc:79.8, f1:57.8, auc:83.1 | trn acc:77.7, f1:63.4, auc:81.0 | loss:0.492
Epoch 18 finished in 5.87 seconds
[19,468] | tst acc:79.1, f1:56.2, auc:83.9 | trn acc:78.3, f1:63.9, auc:81.5 | loss:0.484
Epoch 19 finished in 5.80 seconds
Epoch 20 finished in 5.65 seconds
[21,140] | tst acc:79.6, f1:57.9, auc:83.5 | trn acc:78.6, f1:64.7, auc:82.0 | loss:0.480
Epoch 21 finished in 5.80 seconds
[22,488] | tst acc:83.2, f1:63.6, auc:85.0 | trn acc:79.0, f1:64.9, auc:82.3 | loss:0.474
Epoch 22 finished in 5.87 seconds
Epoch 23 finished in 5.59 seconds
[24,160] | tst acc:79.6, f1:57.9, auc:84.9 | trn acc:79.2, f1:65.5, auc:82.7 | loss:0.471
Epoch 24 finished in 5.87 seconds
[25,508] | tst acc:80.2, f1:58.7, auc:84.5 | trn acc:79.8, f1:66.0, auc:83.1 | loss:0.464
Epoch 25 finished in 5.80 seconds
Epoch 26 finished in 5.65 seconds
[27,180] | tst acc:80.9, f1:57.1, auc:86.7 | trn acc:79.5, f1:65.7, auc:82.9 | loss:0.466
Epoch 27 finished in 5.80 seconds
[28,528] | tst acc:80.4, f1:58.2, auc:83.8 | trn acc:80.0, f1:66.4, auc:83.6 | loss:0.459
Epoch 28 finished in 5.87 seconds
Epoch 29 finished in 5.59 seconds
[30,200] | tst acc:79.8, f1:57.8, auc:83.4 | trn acc:80.1, f1:66.4, auc:83.5 | loss:0.459
Epoch 30 finished in 5.87 seconds
[31,548] | tst acc:82.6, f1:63.1, auc:85.5 | trn acc:80.3, f1:66.8, auc:83.7 | loss:0.456
Epoch 31 finished in 5.80 seconds
Epoch 32 finished in 5.66 seconds
[33,220] | tst acc:81.3, f1:61.4, auc:86.8 | trn acc:80.4, f1:66.7, auc:83.9 | loss:0.452
Epoch 33 finished in 5.80 seconds
[34,568] | tst acc:81.3, f1:59.6, auc:85.9 | trn acc:80.5, f1:66.9, auc:83.9 | loss:0.452
Epoch 34 finished in 5.87 seconds
Epoch 35 finished in 5.58 seconds
[36,240] | tst acc:82.8, f1:62.0, auc:86.9 | trn acc:80.5, f1:67.3, auc:84.2 | loss:0.451
Epoch 36 finished in 5.86 seconds
[37,588] | tst acc:81.9, f1:61.2, auc:85.7 | trn acc:80.6, f1:67.0, auc:84.2 | loss:0.449
Epoch 37 finished in 5.80 seconds
Epoch 38 finished in 5.66 seconds
[39,260] | tst acc:82.3, f1:61.8, auc:87.0 | trn acc:80.9, f1:67.5, auc:84.6 | loss:0.443
Epoch 39 finished in 5.80 seconds
[40,608] | tst acc:82.6, f1:62.4, auc:87.2 | trn acc:80.8, f1:67.5, auc:84.6 | loss:0.444
Epoch 40 finished in 5.87 seconds
Epoch 41 finished in 5.59 seconds
[42,280] | tst acc:83.2, f1:64.6, auc:87.4 | trn acc:81.0, f1:67.8, auc:84.9 | loss:0.440
Epoch 42 finished in 5.86 seconds
[43,628] | tst acc:82.1, f1:61.5, auc:86.8 | trn acc:80.9, f1:67.6, auc:84.7 | loss:0.442
Epoch 43 finished in 5.80 seconds
Epoch 44 finished in 5.65 seconds
[45,300] | tst acc:83.6, f1:64.2, auc:86.8 | trn acc:81.1, f1:67.9, auc:85.1 | loss:0.437
Epoch 45 finished in 5.80 seconds
[46,648] | tst acc:82.6, f1:61.7, auc:87.7 | trn acc:81.1, f1:67.8, auc:85.1 | loss:0.436
Epoch 46 finished in 5.86 seconds
Epoch 47 finished in 5.59 seconds
[48,320] | tst acc:83.2, f1:62.6, auc:87.5 | trn acc:81.2, f1:67.9, auc:85.3 | loss:0.434
Epoch 48 finished in 5.87 seconds
[49,668] | tst acc:83.6, f1:63.8, auc:87.9 | trn acc:81.3, f1:68.2, auc:85.4 | loss:0.432
Epoch 49 finished in 5.80 seconds
Epoch 50 finished in 5.65 seconds
[51,340] | tst acc:82.6, f1:62.0, auc:87.2 | trn acc:81.2, f1:68.0, auc:85.3 | loss:0.434
Epoch 51 finished in 5.80 seconds
Epoch 52 finished in 5.65 seconds
[53,12] | tst acc:83.8, f1:64.5, auc:88.4 | trn acc:81.4, f1:68.3, auc:85.6 | loss:0.430
Epoch 53 finished in 5.80 seconds
[54,360] | tst acc:83.0, f1:63.0, auc:86.4 | trn acc:81.4, f1:68.5, auc:85.7 | loss:0.429
Epoch 54 finished in 5.87 seconds
Epoch 55 finished in 5.59 seconds
[56,32] | tst acc:83.2, f1:64.3, auc:87.5 | trn acc:81.4, f1:68.3, auc:85.6 | loss:0.430
Epoch 56 finished in 5.87 seconds
[57,380] | tst acc:83.0, f1:63.3, auc:87.8 | trn acc:81.5, f1:68.4, auc:85.7 | loss:0.427
Epoch 57 finished in 5.80 seconds
Epoch 58 finished in 5.65 seconds
[59,52] | tst acc:82.6, f1:62.4, auc:86.7 | trn acc:81.4, f1:68.3, auc:85.7 | loss:0.429
Epoch 59 finished in 5.80 seconds
[60,400] | tst acc:83.2, f1:63.3, auc:87.6 | trn acc:81.6, f1:68.5, auc:86.0 | loss:0.423
Epoch 60 finished in 5.86 seconds
Epoch 61 finished in 5.59 seconds
[62,72] | tst acc:83.2, f1:63.6, auc:87.7 | trn acc:81.2, f1:68.2, auc:85.6 | loss:0.432
Epoch 62 finished in 5.87 seconds
[63,420] | tst acc:82.6, f1:61.3, auc:87.9 | trn acc:81.7, f1:68.5, auc:86.1 | loss:0.422
Epoch 63 finished in 5.80 seconds
Epoch 64 finished in 5.65 seconds
[65,92] | tst acc:83.2, f1:63.3, auc:87.4 | trn acc:81.3, f1:68.3, auc:85.8 | loss:0.429
Epoch 65 finished in 5.80 seconds
[66,440] | tst acc:82.6, f1:62.7, auc:86.3 | trn acc:81.5, f1:68.5, auc:86.1 | loss:0.425
Epoch 66 finished in 5.86 seconds
Epoch 67 finished in 5.59 seconds
[68,112] | tst acc:83.8, f1:64.8, auc:87.9 | trn acc:81.5, f1:68.4, auc:86.0 | loss:0.425
Epoch 68 finished in 5.86 seconds
[69,460] | tst acc:82.3, f1:61.8, auc:87.7 | trn acc:81.5, f1:68.2, auc:86.0 | loss:0.424
Epoch 69 finished in 5.80 seconds
Reached final batch of training at iter = 47992
Epoch 70 finished in 5.65 seconds
Reached final batch of training at iter = 48000
Epoch 71 finished in 0.07 seconds
Average epoch runtime: 5.69 seconds
Total training time: 409.41 GPU seconds
4
