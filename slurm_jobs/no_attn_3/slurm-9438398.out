job is starting on gpua056.delta.ncsa.illinois.edu
Loading drug dataset...
Hyperparameters:
Namespace(is_train=True, input_dir='data/input', output_dir='data/output', repository='gdsc', drug_id=-1, use_cuda=True, use_relu=True, init_gene_emb=True, omic='exp', use_attention=False, use_cntx_attn=False, embedding_dim=200, attention_size=128, attention_head=8, hidden_dim_enc=200, use_hid_lyr=True, max_iter=48000, max_fscore=0.6452, dropout_rate=0.6, learning_rate=0.3, weight_decay=0.0003, batch_size=8, test_batch_size=8, test_inc_size=1024, model_label='cntx-attn-gdsc', exp_size=3000, mut_size=1000, cnv_size=1000, omc_size=3000, drg_size=260, train_size=676, test_size=170)
Training...
Batch size: 8
Train dataset size (samples): 676
Batches per epoch: 85
[0,0] | tst acc:47.7, f1:47.0, auc:48.1 | trn acc:47.9, f1:26.0, auc:47.9 | loss:0.888
Epoch 0 finished in 0.78 seconds
[1,348] | tst acc:52.5, f1:51.7, auc:51.0 | trn acc:49.3, f1:37.5, auc:49.3 | loss:0.861
Epoch 1 finished in 0.34 seconds
Epoch 2 finished in 0.13 seconds
[3,20] | tst acc:51.1, f1:50.6, auc:52.2 | trn acc:51.5, f1:39.1, auc:51.7 | loss:0.818
Epoch 3 finished in 0.32 seconds
[4,368] | tst acc:49.8, f1:48.2, auc:51.0 | trn acc:53.8, f1:40.3, auc:54.3 | loss:0.773
Epoch 4 finished in 0.33 seconds
Epoch 5 finished in 0.13 seconds
[6,40] | tst acc:55.0, f1:50.8, auc:55.4 | trn acc:56.3, f1:42.1, auc:57.2 | loss:0.731
Epoch 6 finished in 0.33 seconds
[7,388] | tst acc:53.2, f1:49.3, auc:53.4 | trn acc:59.5, f1:44.9, auc:60.8 | loss:0.690
Epoch 7 finished in 0.33 seconds
Epoch 8 finished in 0.13 seconds
[9,60] | tst acc:51.4, f1:44.8, auc:53.5 | trn acc:62.4, f1:46.8, auc:64.0 | loss:0.655
Epoch 9 finished in 0.33 seconds
[10,408] | tst acc:58.3, f1:51.9, auc:59.8 | trn acc:65.5, f1:49.5, auc:67.3 | loss:0.624
Epoch 10 finished in 0.33 seconds
Epoch 11 finished in 0.12 seconds
[12,80] | tst acc:56.0, f1:48.7, auc:60.5 | trn acc:68.3, f1:52.0, auc:70.3 | loss:0.598
Epoch 12 finished in 0.33 seconds
[13,428] | tst acc:57.8, f1:50.0, auc:60.7 | trn acc:70.7, f1:54.5, auc:72.7 | loss:0.578
Epoch 13 finished in 0.33 seconds
Epoch 14 finished in 0.12 seconds
[15,100] | tst acc:58.5, f1:48.4, auc:60.9 | trn acc:73.1, f1:57.0, auc:75.1 | loss:0.559
Epoch 15 finished in 0.33 seconds
[16,448] | tst acc:58.3, f1:47.7, auc:62.8 | trn acc:74.6, f1:58.7, auc:76.7 | loss:0.546
Epoch 16 finished in 0.33 seconds
Epoch 17 finished in 0.12 seconds
[18,120] | tst acc:60.6, f1:52.2, auc:62.8 | trn acc:76.4, f1:61.0, auc:78.4 | loss:0.533
Epoch 18 finished in 0.34 seconds
[19,468] | tst acc:61.5, f1:51.2, auc:62.5 | trn acc:77.3, f1:61.9, auc:79.4 | loss:0.523
Epoch 19 finished in 0.33 seconds
Epoch 20 finished in 0.12 seconds
[21,140] | tst acc:62.2, f1:51.9, auc:62.3 | trn acc:78.3, f1:63.4, auc:80.2 | loss:0.517
Epoch 21 finished in 0.32 seconds
[22,488] | tst acc:59.9, f1:47.8, auc:63.3 | trn acc:79.1, f1:64.3, auc:81.1 | loss:0.509
Epoch 22 finished in 0.33 seconds
Epoch 23 finished in 0.12 seconds
[24,160] | tst acc:59.6, f1:48.5, auc:64.8 | trn acc:79.9, f1:65.4, auc:82.1 | loss:0.501
Epoch 24 finished in 0.33 seconds
[25,508] | tst acc:59.9, f1:49.3, auc:64.5 | trn acc:80.2, f1:66.0, auc:82.5 | loss:0.497
Epoch 25 finished in 0.33 seconds
Epoch 26 finished in 0.13 seconds
[27,180] | tst acc:59.4, f1:47.8, auc:65.8 | trn acc:80.4, f1:66.0, auc:82.7 | loss:0.495
Epoch 27 finished in 0.33 seconds
[28,528] | tst acc:61.2, f1:49.9, auc:64.0 | trn acc:80.5, f1:66.4, auc:83.0 | loss:0.492
Epoch 28 finished in 0.33 seconds
Epoch 29 finished in 0.12 seconds
[30,200] | tst acc:62.2, f1:51.0, auc:67.4 | trn acc:80.7, f1:66.8, auc:83.2 | loss:0.492
Epoch 30 finished in 0.33 seconds
[31,548] | tst acc:59.4, f1:47.5, auc:64.3 | trn acc:81.1, f1:67.3, auc:83.7 | loss:0.486
Epoch 31 finished in 0.33 seconds
Epoch 32 finished in 0.12 seconds
[33,220] | tst acc:60.3, f1:49.3, auc:67.5 | trn acc:81.3, f1:67.6, auc:84.1 | loss:0.484
Epoch 33 finished in 0.33 seconds
[34,568] | tst acc:62.2, f1:50.7, auc:66.6 | trn acc:81.2, f1:67.6, auc:84.1 | loss:0.484
Epoch 34 finished in 0.33 seconds
Epoch 35 finished in 0.12 seconds
[36,240] | tst acc:61.2, f1:49.6, auc:68.8 | trn acc:81.3, f1:67.7, auc:84.2 | loss:0.483
Epoch 36 finished in 0.33 seconds
[37,588] | tst acc:62.2, f1:51.0, auc:67.6 | trn acc:81.4, f1:67.9, auc:84.4 | loss:0.482
Epoch 37 finished in 0.33 seconds
Epoch 38 finished in 0.13 seconds
[39,260] | tst acc:61.5, f1:50.0, auc:66.7 | trn acc:81.5, f1:67.9, auc:84.5 | loss:0.480
Epoch 39 finished in 0.32 seconds
[40,608] | tst acc:61.9, f1:50.6, auc:65.1 | trn acc:81.6, f1:68.1, auc:84.6 | loss:0.480
Epoch 40 finished in 0.33 seconds
Epoch 41 finished in 0.12 seconds
[42,280] | tst acc:61.7, f1:50.4, auc:67.5 | trn acc:81.4, f1:67.9, auc:84.6 | loss:0.481
Epoch 42 finished in 0.33 seconds
[43,628] | tst acc:62.4, f1:51.2, auc:65.3 | trn acc:81.6, f1:68.3, auc:84.8 | loss:0.479
Epoch 43 finished in 0.33 seconds
Epoch 44 finished in 0.12 seconds
[45,300] | tst acc:61.9, f1:50.9, auc:67.1 | trn acc:81.5, f1:68.1, auc:84.7 | loss:0.480
Epoch 45 finished in 0.32 seconds
[46,648] | tst acc:61.7, f1:50.7, auc:68.4 | trn acc:81.6, f1:68.3, auc:84.8 | loss:0.479
Epoch 46 finished in 0.33 seconds
Epoch 47 finished in 0.12 seconds
[48,320] | tst acc:61.7, f1:50.4, auc:66.8 | trn acc:81.7, f1:68.3, auc:84.8 | loss:0.479
Epoch 48 finished in 0.33 seconds
[49,668] | tst acc:61.7, f1:50.7, auc:69.6 | trn acc:81.7, f1:68.4, auc:84.9 | loss:0.479
Epoch 49 finished in 0.32 seconds
Epoch 50 finished in 0.13 seconds
[51,340] | tst acc:62.2, f1:51.0, auc:67.0 | trn acc:81.7, f1:68.4, auc:84.9 | loss:0.478
Epoch 51 finished in 0.34 seconds
Epoch 52 finished in 0.13 seconds
[53,12] | tst acc:61.9, f1:51.2, auc:65.5 | trn acc:81.7, f1:68.4, auc:85.0 | loss:0.478
Epoch 53 finished in 0.33 seconds
[54,360] | tst acc:61.7, f1:50.7, auc:66.2 | trn acc:81.6, f1:68.4, auc:84.9 | loss:0.479
Epoch 54 finished in 0.33 seconds
Epoch 55 finished in 0.12 seconds
[56,32] | tst acc:61.7, f1:50.4, auc:67.7 | trn acc:81.8, f1:68.5, auc:85.1 | loss:0.477
Epoch 56 finished in 0.33 seconds
[57,380] | tst acc:61.2, f1:49.9, auc:68.2 | trn acc:81.6, f1:68.5, auc:85.1 | loss:0.478
Epoch 57 finished in 0.33 seconds
Epoch 58 finished in 0.13 seconds
[59,52] | tst acc:61.7, f1:50.7, auc:66.8 | trn acc:81.6, f1:68.3, auc:84.9 | loss:0.478
Epoch 59 finished in 0.33 seconds
[60,400] | tst acc:61.5, f1:50.3, auc:66.9 | trn acc:81.7, f1:68.5, auc:85.1 | loss:0.477
Epoch 60 finished in 0.33 seconds
Epoch 61 finished in 0.12 seconds
[62,72] | tst acc:61.9, f1:50.9, auc:66.8 | trn acc:81.6, f1:68.4, auc:85.0 | loss:0.478
Epoch 62 finished in 0.33 seconds
[63,420] | tst acc:61.7, f1:50.7, auc:68.7 | trn acc:81.8, f1:68.6, auc:85.3 | loss:0.476
Epoch 63 finished in 0.33 seconds
Epoch 64 finished in 0.13 seconds
[65,92] | tst acc:61.7, f1:50.7, auc:66.5 | trn acc:81.6, f1:68.4, auc:85.0 | loss:0.478
Epoch 65 finished in 0.33 seconds
[66,440] | tst acc:61.7, f1:50.7, auc:68.4 | trn acc:81.9, f1:68.9, auc:85.3 | loss:0.476
Epoch 66 finished in 0.33 seconds
Epoch 67 finished in 0.13 seconds
[68,112] | tst acc:61.7, f1:50.7, auc:67.4 | trn acc:81.5, f1:68.2, auc:84.9 | loss:0.479
Epoch 68 finished in 0.33 seconds
[69,460] | tst acc:61.7, f1:50.7, auc:67.4 | trn acc:81.7, f1:68.5, auc:85.2 | loss:0.477
Epoch 69 finished in 0.33 seconds
Epoch 70 finished in 0.12 seconds
Epoch 71 finished in 0.00 seconds
Average epoch runtime: 0.26 seconds
Total training time: 18.85 GPU seconds
0
